(function() {
  var root = this;
  var g,aa=[];function l(a){this.N="";this.kc=this.gb=this.Wa=null;this.hb=!0;this.zd=this.bd=!1;this.kf=null;this.Ua=a||"BaseObject"}l.prototype.constructor=l;function ba(a){if("string"!==typeof a.N||""===a.N)a.N=p.eg();p.register(a);null!==a.Wa&&("string"===typeof a.Wa&&(a.Wa=[a.Wa]),!0===Array.isArray(a.Wa)&&ca.register(a))}function da(a){""!==a.N&&!0===p.Sa(a.N)&&p.unregister(a)}
function ea(a,b,d){d=d||"log";console[d].apply(console,["%c[ForgeJS]%c FORGE."+a.Ua+" : "+b+" %c(@"+window.performance.now().toFixed(2)+"ms)","background: #e2edff; color: #4286f4; font-weight: 700","font-weight: 400","color: #AAA"]);if("object"===typeof b&&null!==b)console[d](b)}l.prototype.log=function(a){if(!0===window.FORGE[this.Ua].DEBUG||!0===this.bd)ea(this,a,"log"),null===this.kf&&(this.kf=[]),this.kf.push(a)};
l.prototype.warn=function(a){!0!==window.FORGE[this.Ua].WARNING&&!0!==this.zd||ea(this,a,"warn")};l.prototype.destroy=function(){!1!==this.hb&&(da(this),null!==this.kc&&(this.kc.D(),this.kc.destroy(),this.kc=null),this.gb=null,this.hb=!1)};Object.defineProperty(l.prototype,"className",{get:function(){return this.Ua}});Object.defineProperty(l.prototype,"uid",{get:function(){return this.N}});Object.defineProperty(l.prototype,"tags",{get:function(){return this.Wa}});
Object.defineProperty(l.prototype,"alive",{get:function(){return this.hb}});Object.defineProperty(l.prototype,"data",{get:function(){return this.gb},set:function(a){this.gb=a}});Object.defineProperty(l.prototype,"debug",{get:function(){return this.bd},set:function(a){this.bd=!!a;!0===this.bd&&(console.log("Enabling debug for a FORGE."+this.Ua+" instance :"),console.log(this))}});
Object.defineProperty(l.prototype,"warning",{get:function(){return this.zd},set:function(a){this.zd=!!a;!0===this.zd&&(console.log("Enabling warning for a FORGE."+this.Ua+" instance :"),console.log(this))}});Object.defineProperty(l.prototype,"onDestroy",{get:function(){null===this.kc&&(this.kc=new q(this));return this.kc}});
function r(a,b,d){l.call(this,"Viewer");this.j=a;this.R=b||{viewer:fa};this.m=this.P=this.S=this.G=this.J=this.C=this.W=this.ia=this.Z=this.wa=this.M=this.aa=this.U=this.ka=this.ha=this.ba=this.H=this.V=this.F=this.O=this.L=this.I=this.B=this.c=this.pa=null;this.ga=this.ea=!1;this.A=this.o=this.u=null;this.f=d||null;window.setTimeout(this.El.bind(this),0)}r.prototype=Object.create(l.prototype);r.prototype.constructor=r;var fa={background:"#000"};g=r.prototype;
g.El=function(a){this.N="FORGE-instance-"+String(aa.length);aa.push(this.N);ba(this);this.log("$_Viewer.boot();");this.pa=new ga(this);"string"===typeof this.j&&""!==this.j&&(this.j=document.getElementById(this.j));if("undefined"===typeof this.j||null===this.j||!1===ha.ng(this.j))throw"$_Viewer.boot : Viewer parent is invalid";this.c=new t(this,null,null,this.j);this.c.id="FORGE-main-container-"+this.N;this.B=new t(this);this.B.id="FORGE-canvas-container-"+this.N;this.c.index=0;this.B.Db(!0);this.c.Yb(this.B);
this.I=new t(this);this.I.id="FORGE-dom-hotspot-container-"+this.N;this.c.index=0;this.I.Db(!0);this.c.Yb(this.I);this.L=new t(this);this.L.id="FORGE-plugin-container-"+this.N;this.c.index=0;this.L.Db(!0);this.c.Yb(this.L);this.O=new ia(this);this.O.Db(!0);this.B.Yb(this.O);this.ha=new ja(this);this.G=new ka(this);this.F=new u(this);this.J=new la(this);this.P=new ma(this);this.M=new w(this);this.wa=new na(this);this.m=new x(this);this.U=new oa(this);this.V=new z(this);this.C=new pa(this);this.H=new qa(this);
this.ba=new ra(this);this.ka=new sa(this);this.aa=new ta(this);this.W=new ua(this);this.ia=new va(this);this.Z=new wa(this);this.S=new xa(this);this.F.boot();this.J.boot();this.M.boot();this.V.boot();this.C.boot();this.H.boot();this.log("ForgeJS 0.9.1");"function"===typeof a&&a.call();null!==this.f&&"function"===typeof this.f.boot&&this.f.boot.call();this.J.start();this.ga=!0;null!==this.u&&this.u.D();a=this.R;"string"===typeof a?this.Z.json(this.N+"-configuration",a,this.Fl,this):null!==a&&"object"===
typeof a&&ya(this,a)};g.Fl=function(a){this.log("$_Viewer._configLoadComplete();");a=this.ia.get(A.JSON,a.key).data;ya(this,a)};
function ya(a,b){a.R=b;var d=b.viewer;a.R.background="undefined"!==typeof d&&"string"===typeof d.background?d.background:fa.background;a.c.background=a.R.background;"undefined"!==typeof b.i18n&&a.P.ja(b.i18n);a.wa.ja(b.history);"undefined"!==typeof b.audio&&a.F.ja(b.audio);"undefined"!==typeof b.playlists&&a.V.ja(b.playlists);"undefined"!==typeof b.actions&&a.ba.ja(b.actions);"undefined"!==typeof b.director&&a.ka.load(b.director);"undefined"!==typeof b.hotspots&&a.H.ij(b.hotspots);"undefined"!==typeof b.postProcessing&&
a.aa.ja(b.postProcessing);"undefined"!==typeof b.plugins&&a.C.ja(b.plugins);a.U.ja(b.controllers);"undefined"!==typeof b.story&&a.M.load(b.story)}
g.update=function(a){!0!==this.ea&&(this.G.update(a),this.pa.update(),this.W.update(),this.F.update(),this.C.update(),this.S.update(),this.H.update(),this.U.update(),this.m.update(),null!==this.f&&"function"===typeof this.f.update&&this.f.update.call(),null!==this.f&&"function"===typeof this.f.tn&&this.f.tn.call(),null!==this.m&&this.m.render(),null!==this.f&&"function"===typeof this.f.sn&&this.f.sn.call())};g.pause=function(){this.ea=!0;null!==this.o&&this.o.D()};
g.resume=function(){this.ea=!1;null!==this.A&&this.A.D()};
g.destroy=function(){this.J.stop();this.j=this.R=null;this.C.destroy();this.C=null;this.J.destroy();this.J=null;this.Z.destroy();this.Z=null;this.wa.destroy();this.wa=null;this.G.destroy();this.G=null;this.W.destroy();this.W=null;this.H.destroy();this.H=null;this.ka.destroy();this.ka=null;this.m.destroy();this.m=null;this.O.destroy();this.O=null;this.B.destroy();this.B=null;this.I.destroy();this.I=null;this.aa.destroy();this.aa=null;this.L.destroy();this.L=null;this.ba.destroy();this.ba=null;this.c.destroy();
this.c=null;this.pa.destroy();this.pa=null;this.V.destroy();this.V=null;this.F.destroy();this.F=null;this.M.destroy();this.M=null;this.ia.destroy();this.ia=null;this.S.destroy();this.S=null;this.P.destroy();this.P=null;this.U.destroy();this.f=this.U=null;null!==this.u&&(this.u.destroy(),this.u=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.A&&(this.A.destroy(),this.A=null);aa.splice(this.N,1);l.prototype.destroy.call(this)};Object.defineProperty(r.prototype,"ready",{get:function(){return this.ga}});
Object.defineProperty(r.prototype,"config",{get:function(){return this.R}});Object.defineProperty(r.prototype,"parent",{get:function(){return this.j}});Object.defineProperty(r.prototype,"display",{get:function(){return this.pa}});Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this.c.od()},set:function(a){"boolean"===typeof a&&this.c.od()!==a&&(this.c.fullscreen=a)}});Object.defineProperty(r.prototype,"container",{get:function(){return this.c}});
Object.defineProperty(r.prototype,"canvasContainer",{get:function(){return this.B}});Object.defineProperty(r.prototype,"canvas",{get:function(){return this.O}});Object.defineProperty(r.prototype,"domHotspotContainer",{get:function(){return this.I}});Object.defineProperty(r.prototype,"pluginContainer",{get:function(){return this.L}});Object.defineProperty(r.prototype,"raf",{get:function(){return this.J}});Object.defineProperty(r.prototype,"audio",{get:function(){return this.F}});
Object.defineProperty(r.prototype,"playlists",{get:function(){return this.V}});Object.defineProperty(r.prototype,"hotspots",{get:function(){return this.H}});Object.defineProperty(r.prototype,"actions",{get:function(){return this.ba}});Object.defineProperty(r.prototype,"dependencies",{get:function(){return this.ha}});Object.defineProperty(r.prototype,"director",{get:function(){return this.ka}});Object.defineProperty(r.prototype,"story",{get:function(){return this.M}});
Object.defineProperty(r.prototype,"history",{get:function(){return this.wa}});Object.defineProperty(r.prototype,"load",{get:function(){return this.Z}});Object.defineProperty(r.prototype,"cache",{get:function(){return this.ia}});Object.defineProperty(r.prototype,"plugins",{get:function(){return this.C}});Object.defineProperty(r.prototype,"clock",{get:function(){return this.G}});Object.defineProperty(r.prototype,"tween",{get:function(){return this.S}});Object.defineProperty(r.prototype,"i18n",{get:function(){return this.P}});
Object.defineProperty(r.prototype,"renderer",{get:function(){return this.m}});Object.defineProperty(r.prototype,"view",{get:function(){return this.m.view}});Object.defineProperty(r.prototype,"camera",{get:function(){return this.m.camera}});Object.defineProperty(r.prototype,"controllers",{get:function(){return this.U}});Object.defineProperty(r.prototype,"postProcessing",{get:function(){return this.aa}});Object.defineProperty(r.prototype,"keyboard",{get:function(){return this.W}});
Object.defineProperty(r.prototype,"width",{get:function(){return this.c.width},set:function(a){this.c.width=a}});Object.defineProperty(r.prototype,"height",{get:function(){return this.c.height},set:function(a){this.c.height=a}});Object.defineProperty(r.prototype,"onReady",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(r.prototype,"onPause",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});
Object.defineProperty(r.prototype,"onResume",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
var ca=function(a){a=a();a.prototype=Object.create(l.prototype);a.prototype.constructor=a;a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid&&Array.isArray(a.tags)){var b=a.uid,e=a.tags;if(!0===p.Sa(b))for(var h=0,k=e.length;h<k;h++)a=e[h],"string"!==typeof a?this.warn("Tags: An object has a tag that isn't a string!"):("undefined"===typeof this.ib[a]&&(this.ib[a]=[],null!==this.hd&&this.hd.D({tag:a})),-1===this.ib[a].indexOf(b)&&this.ib[a].push(b));else this.warn("Tags: The object you want to register in tags is not known by UID!"),
this.warn(a)}else this.warn("Tags: No uid or no tags on the object you try to register!"),this.warn(a)};a.prototype.gg=function(a,d){var b=[];if("string"===typeof a)b=this.ib[a];else if(Array.isArray(a)){var h=0;for(a=a.length;h<a;h++);}"string"===typeof d&&(b=p.ee(b,d));return b};a.prototype.get=function(a,d){if("string"===typeof a)return p.get(this.ib[a],d);if(Array.isArray(a)){var b=0;for(a=a.length;b<a;b++);return p.get([],d)}};a.prototype.Mn=function(a,d){if(!0===this.Sa(a)){a=this.ib[a];for(var b=
0,h=this.ib.length;b<h;b++)if(!0===p.T(a[b],d))return!0}return!1};a.prototype.Sa=function(a){return"undefined"!==typeof this.ib[a]&&null!==this.ib[a]};Object.defineProperty(a.prototype,"list",{get:function(){return Object.keys(this.ib)}});Object.defineProperty(a.prototype,"onRegister",{get:function(){null===this.hd&&(this.hd=new q(this));return this.hd}});return new a}(function(){return function(){this.ib={};this.hd=null;l.call(this,"Tags")}}),p=function(a){a=a();a.prototype=Object.create(l.prototype);
a.prototype.constructor=a;a.prototype.eg=function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});return!1===p.Sa(a)?a:p.eg()};a.prototype.Hk=function(a){function b(a){var d,h;for(h in a)if("uid"===h)if(d=a[h],"string"===typeof d){if(p.Sa(d))throw"UID configuration not valid, uid "+d+" already have an object binded to!";if(-1!==e.indexOf(d))throw"UID configuration not valid, uid "+d+" is in double in config file!";
e.push(a[h])}else throw"Found a uid in configuration that is not a string!";else"object"===typeof a[h]&&b(a[h]);return!0}var e=[];return b(a)};a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid){var b=a.uid;if(!1===p.Sa(b))return this.$[b]=a,!0;this.warn("The uid you want to register already exists!");this.warn(a)}else this.warn("No uid on the object you try to register!"),this.warn(a);return!1};a.prototype.unregister=function(a){"object"===typeof a&&"string"===typeof a.uid?
(a=a.uid,this.$[a]=null,delete this.$[a]):this.warn("No uid on the object you try to unregister!")};a.prototype.gg=function(a){return"undefined"===typeof a||null===a?Object.keys(this.$):p.ee(Object.keys(this.$),a)};a.prototype.ee=function(a,d){return a.filter(function(a){return p.T(a,d)?!0:!1})};a.prototype.get=function(a,d){if("undefined"===typeof a||null===a){if("string"!==typeof d)return this.$;a=Object.keys(this.$)}if("string"===typeof a)return this.$[a];if(Array.isArray(a)){"string"===typeof d&&
(a=p.ee(a,d));d=[];for(var b,h=0,k=a.length;h<k;h++)b=a[h],!0===p.Sa(b)&&d.push(this.$[b]);return d}};a.prototype.T=function(a,d){a=p.get(a);return B.T(a,d)};a.prototype.Sa=function(a){return"undefined"!==typeof this.$[a]&&null!==this.$[a]};return new a}(function(){return function(){this.$={};l.call(this,"UID")}});
function w(a){this.i=a;this.L=this.O=this.J=this.f=null;this.I="";this.c=null;this.o="";this.j=null;this.u="";this.m=this.F=this.H=this.G=this.C=this.B=this.A=null;l.call(this,"Story")}w.prototype=Object.create(l.prototype);g=w.prototype;g.constructor=w;g.boot=function(){this.log("$_Story.boot();");this.c=[];this.j=[];this.J=new za(this.i);this.O=new za(this.i);this.L=new za(this.i)};
g.load=function(a){this.log("$_Story.load();");"string"===typeof a?this.i.load.json("forge.story.config",a,this.rl,this):"object"===typeof a&&Aa(this,a)};g.sl=function(){return!!this.c.length};g.oc=function(){return!!this.j.length};g.tl=function(){var a=this.c.indexOf(this.o);this.Kc(a+1<this.c.length?this.c[a+1]:this.c[0])};g.ul=function(){var a=this.c.indexOf(this.o);this.Kc(0<=a-1?this.c[a-1]:this.c[this.c.length-1])};
g.rl=function(a){this.log("$_Story.loadComplete();");a=this.i.cache.get(A.JSON,a.key).data;Aa(this,a)};
function Aa(a,b){if(!0!==p.Hk(b))throw"Story configuration is not valid!";a.f=b;a.N=a.f.uid;ba(a);a.I=a.f["default"];a.J.key=a.f.name;a.O.key=a.f.slug;a.L.key=a.f.description;if("undefined"!==typeof a.f.scenes&&0<a.f.scenes.length){b=a.f.scenes;for(var d,e=0,h=b.length;e<h;e++)d=new C(a.i),d.ja(b[e]),!0===d.booted&&Ba(a,d)}if("undefined"!==typeof a.f.groups&&0<a.f.groups.length)for(b=a.f.groups,e=0,h=b.length;e<h;e++)d=new E(a.i,b[e]),a.j.push(d.uid);Ca(a)}
function Ca(a){if("undefined"===typeof a.f.scenes||a.c.length===a.f.scenes.length){null!==a.A&&a.A.D();var b=Da().hashParameters;null!==b&&"string"===typeof b.uid?Ea(b.uid):""!==a.I&&null!==a.I&&p.Sa(a.I)?Ea(a.I):a.Kc(0)}}function Ea(a){!0!==p.T(a,"Scene")&&!0!==p.T(a,"Group")||p.get(a).load()}g.mk=function(a){Ba(this,a);Ca(this)};function Ba(a,b){b.onLoadStart.add(a.gn,a);b.onLoadComplete.add(a.fn,a);a.c.push(b.uid)}
g.Kc=function(a){var b;"number"===typeof a?0<=a&&a<this.c.length?b=this.c[a]:this.warn("Load scene, index "+a+" is out of bounds"):"string"===typeof a&&p.T(a,"Scene")?b=a:"object"===typeof a&&B.T(a,"Scene")&&(b=a.uid);"undefined"!==typeof b&&b!==this.o&&Ea(b)};g.gn=function(a){""!==this.o&&null!==this.o&&this.scene.Ge();a=a.emitter;this.o=a.uid;!1===a.oc()?(this.u=null,null!==this.m&&this.m.D()):!0===a.oc()&&!1===a.nd(this.u)&&Fa(this,a.groups[0].uid);null!==this.B&&this.B.D({uid:a.uid})};
g.fn=function(){null!==this.G&&this.G.D()};function Fa(a,b){!0===p.T(b,"Group")&&b!==a.u&&(a.u=b,null!==a.m&&a.m.D())}g.tg=function(a){var b;"number"===typeof a?0<=a&&a<this.j.length?b=this.j[a]:this.warn("Load group, index "+a+" is out of bounds"):"string"===typeof a&&p.T(a,"Group")?b=a:"object"===typeof a&&B.T(a,"Group")&&(b=a.uid);"undefined"!==typeof b&&b!==this.u&&(Fa(this,b),Ea(b))};
g.destroy=function(){this.f=this.i=null;this.J.destroy();this.J=null;this.O.destroy();this.O=null;this.L.destroy();this.L=null;for(var a=0,b=this.c.length;a<b;a++)p.get(this.c[a]).destroy();this.c=null;a=0;for(b=this.j.length;a<b;a++)p.get(this.j[a]).destroy();this.j=null;null!==this.A&&(this.A.destroy(),this.A=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.H&&(this.H.destroy(),this.H=null);
null!==this.F&&(this.F.destroy(),this.F=null);null!==this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};Object.defineProperty(w.prototype,"config",{get:function(){return this.f}});Object.defineProperty(w.prototype,"name",{get:function(){return this.J.value}});Object.defineProperty(w.prototype,"slug",{get:function(){return this.O.value}});Object.defineProperty(w.prototype,"description",{get:function(){return this.L.value}});Object.defineProperty(w.prototype,"scenes",{get:function(){return p.get(this.c)}});
Object.defineProperty(w.prototype,"scene",{get:function(){return null===this.o||""===this.o?null:p.get(this.o)},set:function(a){this.Kc(a)}});Object.defineProperty(w.prototype,"sceneUids",{get:function(){return this.c}});Object.defineProperty(w.prototype,"sceneUid",{get:function(){return this.o},set:function(a){this.Kc(a)}});Object.defineProperty(w.prototype,"groups",{get:function(){return p.get(this.j)}});
Object.defineProperty(w.prototype,"group",{get:function(){return null===this.u||""===this.u?null:p.get(this.u)},set:function(a){this.tg(a)}});Object.defineProperty(w.prototype,"groupUids",{get:function(){return this.j}});Object.defineProperty(w.prototype,"groupUid",{get:function(){return this.u},set:function(a){this.tg(a)}});Object.defineProperty(w.prototype,"onReady",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
Object.defineProperty(w.prototype,"onSceneLoadStart",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(w.prototype,"onSceneLoadProgress",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(w.prototype,"onSceneLoadComplete",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(w.prototype,"onSceneLoadError",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});
Object.defineProperty(w.prototype,"onScenePreview",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});Object.defineProperty(w.prototype,"onGroupChange",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
function E(a,b){this.i=a;this.f=b;this.o=null;this.B="#ffffff";this.A=1;this.c=this.m=this.u=null;this.j="";l.call(this,"Group");this.log("$_Group._boot();");this.N=this.f.uid;this.Wa=this.f.tags;ba(this);this.c=[];this.o=new za(this.i,this.f.name);this.u=new za(this.i,this.f.slug);this.m=new za(this.i,this.f.description);"string"===typeof this.f.color&&(this.B=this.f.color);"number"===typeof this.f.alpha&&(this.A=this.f.alpha);a=this.f;"undefined"!==typeof a.children&&!0===B.Fa(a.children,"string")?
this.c=a.children:this.warn("A group has no children in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&(-1!==this.c.indexOf(a["default"])?this.j=a["default"]:this.warn("A group has a default child that is not in its children array!"))}E.prototype=Object.create(l.prototype);g=E.prototype;g.constructor=E;
g.load=function(a){this.log("$_Group.load();");if(null===this.c||!this.c.length)throw"Group.load() : can't load a group that have no children";var b="";"undefined"===typeof a||null===a?b="string"===typeof this.j&&""!==this.j?this.j:this.c[0]:"number"===typeof a&&0<=a&&a<this.c.length?b=this.c[a]:"string"===typeof a?b=a:"object"===typeof a&&!0===this.Oe(a)&&(b=a.uid);if(-1===this.c.indexOf(b))throw'Group.load() : uid "'+b+'" is not in children of the group!';if(!0===p.T(b,"Scene")||!0===p.T(b,"Group"))p.get(b).load();
else throw"Impossible to load group child with uid "+b+", it seems to be neither a scene or a group!";};g.Oe=function(a){return"string"===typeof a?-1!==this.c.indexOf(a):!0===B.T(a,"Scene")||!0===B.T(a,"Group")?this.Oe(a.uid):!1};g.Ic=function(a){return"string"===typeof a&&p.T(a,"Scene")?-1!==this.c.indexOf(a):!0===B.T(a,"Scene")?this.Ic(a.uid):!1};g.nd=function(a){return"string"===typeof a&&p.T(a,"Group")?-1!==this.c.indexOf(a):!0===B.T(a,"Group")?this.nd(a.uid):!1};g.Jn=function(){return!!this.c.length};
g.jg=function(a){for(var b,d=0,e=this.c.length;d<e;d++)if(b=this.c[d],p.T(b,a))return!0;return!1};g.Pe=function(){return this.jg("Scene")};g.oc=function(){return this.jg("Group")};g.ld=function(a){if("string"!==typeof a)return this.c;for(var b=[],d=0,e=this.c.length;d<e;d++)p.T(this.c[d],a)&&b.push(this.c[d]);return b};g.he=function(a){a=this.ld(a);return p.get(a)};
g.Qk=function(){if(!1===this.Pe())this.warn("Can't do Group.nextScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(p.T(this.j,"Scene")?d=this.j:d=a[0]);b+1<a.length?d=a[b+1]:-1!==b&&(d=a[0]);this.load(d)}};
g.Rk=function(){if(!1===this.Pe())this.warn("Can't do Group.previousScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(p.T(this.j,"Scene")?d=this.j:d=a[0]);0<=b-1?d=a[b-1]:-1!==b&&(d=a[a.length-1]);this.load(d)}};g.destroy=function(){this.c=this.i=null;this.o.destroy();this.o=null;this.u.destroy();this.u=null;this.m.destroy();this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(E.prototype,"config",{get:function(){return this.f}});
Object.defineProperty(E.prototype,"name",{get:function(){return this.o.value}});Object.defineProperty(E.prototype,"color",{get:function(){return this.B}});Object.defineProperty(E.prototype,"alpha",{get:function(){return this.A}});Object.defineProperty(E.prototype,"slug",{get:function(){return this.u.value}});Object.defineProperty(E.prototype,"description",{get:function(){return this.m.value}});Object.defineProperty(E.prototype,"childrenUids",{get:function(){return this.ld()}});
Object.defineProperty(E.prototype,"children",{get:function(){return this.he()}});Object.defineProperty(E.prototype,"scenesUids",{get:function(){return this.ld("Scene")}});Object.defineProperty(E.prototype,"scenes",{get:function(){return this.he("Scene")}});Object.defineProperty(E.prototype,"groupsUids",{get:function(){return this.ld("Group")}});Object.defineProperty(E.prototype,"groups",{get:function(){return this.he("Group")}});
function C(a){this.i=a;this.c=null;this.B=0;this.A=!1;this.u=this.m=this.o=this.f=this.j=null;l.call(this,"Scene")}C.prototype=Object.create(l.prototype);g=C.prototype;g.constructor=C;g.ql=function(a){this.A=!0;"string"===typeof a.data&&(a.data=JSON.parse(a.data));this.c.zj(a.data);this.i.story.mk(this);null!==this.u&&this.u.D()};
g.ja=function(a){this.c=new F(this.i,a);this.N=this.c.uid;this.Wa=this.c.tags;ba(this);!1===this.A&&"string"===typeof a.url&&""!==a.url?this.i.load.json(this.N,a.url,this.ql,this):this.A=!0};g.load=function(){this.log("$_Scene.load();");this.i.story.scene!==this&&(null!==this.j&&this.j.D(),this.B++,null!==this.f&&this.f.D())};g.Ge=function(){null!==this.o&&this.o.D();null!==this.m&&this.m.D()};
g.nd=function(a){return"string"===typeof a&&!0===p.T(a,"Group")?p.get(a).Ic(this):!0===B.T(a,"Group")?a.Ic(this):!1};g.oc=function(){for(var a=this.i.story.groups,b,d=0,e=a.length;d<e;d++)if(b=a[d],!0===b.Ic(this))return!0;return!1};g.destroy=function(){this.i=null;null!==this.c&&(this.c.destroy(),this.c=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};
Object.defineProperty(C.prototype,"booted",{get:function(){return this.A}});Object.defineProperty(C.prototype,"config",{get:function(){return this.c}});Object.defineProperty(C.prototype,"viewCount",{get:function(){return this.B}});Object.defineProperty(C.prototype,"viewed",{get:function(){return!!this.B}});Object.defineProperty(C.prototype,"name",{get:function(){return this.c.name}});Object.defineProperty(C.prototype,"slug",{get:function(){return this.c.slug}});
Object.defineProperty(C.prototype,"description",{get:function(){return this.c.description}});Object.defineProperty(C.prototype,"groupsUid",{get:function(){for(var a=this.i.story.groups,b,d=[],e=0,h=a.length;e<h;e++)b=a[e],!0===b.Ic(this)&&d.push(b.uid);return d}});Object.defineProperty(C.prototype,"groups",{get:function(){return p.get(this.groupsUid)}});Object.defineProperty(C.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});
Object.defineProperty(C.prototype,"onLoadStart",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(C.prototype,"onLoadComplete",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});Object.defineProperty(C.prototype,"onUnloadStart",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(C.prototype,"onUnloadComplete",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
Object.defineProperty(C.prototype,"onConfigLoadComplete",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});function F(a,b){this.i=a;this.c=b;this.f=this.m=this.j=null;l.call(this,"SceneParser");this.N=this.c.uid;this.Wa=this.c.tags;this.j=new za(this.i,this.c.name);this.m=new za(this.i,this.c.slug);this.f=new za(this.i,this.c.description)}F.prototype=Object.create(l.prototype);g=F.prototype;g.constructor=F;g.zj=function(a){this.c=B.mb(this.c,a)};
g.Xj=function(){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&("undefined"!==typeof this.c.sound.source.url&&""!==this.c.sound.source.url||"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target)?!0:!1};g.Yj=function(a){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target&&this.c.sound.source.target===a?!0:!1};
g.dk=function(){return!0===this.Xj()&&this.c.sound.type===Ga.cf?!0:!1};g.destroy=function(){this.i=null;this.j.destroy();this.j=null;this.m.destroy();this.m=null;this.f.destroy();this.f=null;l.prototype.destroy.call(this)};Object.defineProperty(F.prototype,"uid",{get:function(){return this.N}});Object.defineProperty(F.prototype,"name",{get:function(){return this.j.value}});Object.defineProperty(F.prototype,"slug",{get:function(){return this.m.value}});
Object.defineProperty(F.prototype,"description",{get:function(){return this.f.value}});Object.defineProperty(F.prototype,"tags",{get:function(){return this.Wa}});Object.defineProperty(F.prototype,"background",{get:function(){return"undefined"!==typeof this.c.background?this.c.background:this.i.config.background}});Object.defineProperty(F.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});Object.defineProperty(F.prototype,"media",{get:function(){return this.c.media}});
Object.defineProperty(F.prototype,"sound",{get:function(){return this.c.sound}});Object.defineProperty(F.prototype,"fx",{get:function(){return this.c.fx}});Object.defineProperty(F.prototype,"playlists",{get:function(){return this.c.playlists}});Object.defineProperty(F.prototype,"view",{get:function(){return this.c.view}});Object.defineProperty(F.prototype,"camera",{get:function(){return this.c.camera}});Object.defineProperty(F.prototype,"hotspots",{get:function(){return this.c.hotspots}});
Object.defineProperty(F.prototype,"director",{get:function(){return this.c.director}});Object.defineProperty(F.prototype,"plugins",{get:function(){return this.c.plugins}});Object.defineProperty(F.prototype,"audio",{get:function(){return this.c.audio}});var G={La:"degrees",ob:"radians"};G.di=Math.PI/180;G.oi=180/Math.PI;G.ui=2*Math.PI;G.da=function(a){return a*G.di};G.dc=function(a){return a*G.oi};G.sd=function(a){return Math.round(10*a)/10};
G.X=function(a,b,d){b="number"===typeof b&&!1===isNaN(b)?b:-Infinity;d="number"===typeof d&&!1===isNaN(d)?d:Infinity;return Math.min(Math.max(a,b),d)};G.Ta=function(a,b,d){d-=b;return((a-b)%d+d)%d+b};G.Xn=function(a,b,d){return a*d+b*(1-d)};G.fo=function(a,b,d){a=G.X((a-b)/(d-b),0,1);return a*a*(3-2*a)};G.Dg=function(a){return{yaw:Math.atan2(-a.elements[2],a.elements[10]),pitch:Math.asin(-a.elements[6]),roll:Math.atan2(-a.elements[4],a.elements[5])}};
G.de=function(a,b,d,e){var h=Math.cos(a);a=Math.sin(a);var k=Math.cos(-b);b=Math.sin(-b);var n=Math.cos(d);d=Math.sin(d);"undefined"===typeof e&&(e=!1);return e?(new THREE.Matrix4).set(h*n+a*b*d,-h*d+a*b*n,a*k,0,k*d,k*n,-b,0,-a*n+h*b*d,a*d+h*b*n,h*k,0,0,0,0,1):(new THREE.Matrix4).set(n*h-d*b*a,-d*k,n*a+d*b*h,0,d*h+n*b*a,n*k,d*a-n*b*h,0,-a*k,b,k*h,0,0,0,0,1)};
var H={Ee:function(a){a=(new THREE.Euler).setFromQuaternion(a,"XYZ");return{yaw:a.x,pitch:-a.y,roll:a.z}},nc:function(a,b,d){"object"===typeof a&&(b=a.pitch,d=a.roll,a=a.yaw);return(new THREE.Quaternion).setFromEuler(new THREE.Euler(a,-b,d,"ZXY"))},Bk:function(a){a=H.Ee(a);return G.de(a.yaw,a.pitch,a.roll)},Cn:function(a){return H.nc(G.Dg(a))},cancelRoll:function(a){a=H.Ee(a);return H.nc(a.yaw,a.pitch,0)},xn:function(a,b){return(new THREE.Quaternion).copy(a).inverse().multiply(b)},lj:function(a,b){a=
Math.abs(a.dot(b));return 1<=a?0:2*Math.acos(a)},multiplyScalar:function(a,b){return new THREE.Quaternion(a*b.x,a*b.y,a*b.z,a*b.w)},add:function(a,b){return new THREE.Quaternion(a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w)},log:function(a){var b=new THREE.Quaternion(0,0,0,0);if(1>Math.abs(a.w)){var d=Math.acos(a.w),e=Math.sin(d);0<e&&(b.x=d*a.x/e,b.y=d*a.y/e,b.z=d*a.z/e);return b}b.x=a.x;b.y=a.y;b.z=a.z;return b},exp:function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z),d=Math.sin(b),e=(new THREE.Quaternion).copy(a);
e.w=Math.cos(b);Math.abs(d)>Number.EPSILON&&(e.x=d*a.x/b,e.y=d*a.y/b,e.z=d*a.z/b);return e},slerp:function(a,b,d){var e=new THREE.Quaternion;THREE.Quaternion.slerp(a,b,e,d);return e},io:function(a,b,d,e,h,k){a=H.slerp(a,e,k);b=H.slerp(b,d,k);return H.slerp(a,b,2*k*(1-k))},lk:function(a,b,d){return H.add(H.multiplyScalar(1-d,a),H.multiplyScalar(d,b)).normalize()},Ce:function(a,b,d){var e=a.dot(b);if(.95<=Math.abs(e))return H.lk(a,b,d);e=Math.acos(e);return H.multiplyScalar(1/Math.sin(e),H.add(H.multiplyScalar(Math.sin(e*
(1-d)),a),H.multiplyScalar(Math.sin(e*d),b)))},zk:function(a,b,d,e,h){a=H.Ce(a,e,h);b=H.Ce(b,d,h);return H.Ce(a,b,2*h*(1-h))},Kg:function(a,b,d){var e=(new THREE.Quaternion).copy(b).conjugate();a=(new THREE.Quaternion).copy(e).multiply(a);d=(new THREE.Quaternion).copy(e).multiply(d);e=H.log(a);d=H.log(d);d=H.add(e,d);d=H.multiplyScalar(-.25,d);d=H.exp(d);return(new THREE.Quaternion).copy(b).multiply(d).normalize()}};
function Ha(a,b,d,e){this.N="number"===typeof a?a:0;this.j="number"===typeof b?b:0;this.f="number"===typeof d?d:0;this.c="number"===typeof e?e:0}Ha.prototype.constructor=Ha;Object.defineProperty(Ha.prototype,"x",{get:function(){return this.N},set:function(a){"number"===typeof a&&(this.N=a)}});Object.defineProperty(Ha.prototype,"y",{get:function(){return this.j},set:function(a){"number"===typeof a&&(this.j=a)}});
Object.defineProperty(Ha.prototype,"width",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(Ha.prototype,"w",{get:function(){return this.width},set:function(a){this.width=a}});Object.defineProperty(Ha.prototype,"height",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(Ha.prototype,"h",{get:function(){return this.height},set:function(a){this.height=a}});
Object.defineProperty(Ha.prototype,"center",{get:function(){return new THREE.Vector2(this.N+.5*this.f,this.j+.5*this.c)}});Object.defineProperty(Ha.prototype,"origin",{get:function(){return new THREE.Vector2(this.N,this.j)}});Object.defineProperty(Ha.prototype,"size",{get:function(){return new Ia(this.f,this.c)}});function Ia(a,b){this.f=a||0;this.c=b||0}Ia.prototype.constructor=Ia;Object.defineProperty(Ia.prototype,"width",{get:function(){return this.f}});
Object.defineProperty(Ia.prototype,"height",{get:function(){return this.c}});Object.defineProperty(Ia.prototype,"ratio",{get:function(){return this.f/this.c}});var Ja={IMAGE:"image",VIDEO:"video",jc:"grid"},Ka={Vc:"equi",Ad:"cube",fi:"flat",Jl:"hotspot"};
function La(a,b){this.i=a;this.j=b;this.K=this.f=null;this.m=!1;this.c=null;l.call(this,"Media");a=this.j;this.warn("$_Media config validator not implemented");b=a.media;if("undefined"!==typeof b&&null!==b)if(this.N=b.uid,this.f="undefined"!==typeof b.options?b.options:null,a=b.source,b.type===Ja.jc)this.m=!0;else if("undefined"!==typeof b.source&&null!==b.source)if(b.type===Ja.IMAGE){if(!a.url)throw"Multi resolution not implemented yet !";if(a.format===Ka.Vc)a={key:this.N,url:a.url},this.K=new Ma(this.i,
a);else if(a.format===Ka.Ad)a={key:this.N,url:a.url},this.K=new Ma(this.i,a);else if(a.format===Ka.fi)throw"Flat media not supported yet !";this.K.onLoadComplete.fa(this.u,this)}else if(b.type===Ja.VIDEO){if(Array.isArray(a.levels)){a.url=[];b=0;for(var d=a.levels.length;b<d;b++)!1!==I.check(a.levels[b].device)&&a.url.push(a.levels[b].url)}if("string"===typeof a.url||0!==a.url.length)"undefined"!==typeof a.streaming&&a.streaming.toLowerCase()===Na.df?this.K=new J(this.i,this.N):this.K=new K(this.i,
this.N,null,null,!0===this.j.Yj(this.N)&&!0===this.j.dk()?!0:!1),this.K.load(a.url),this.K.onLoadedMetaData.fa(this.o,this)}}La.prototype=Object.create(l.prototype);La.prototype.constructor=La;La.prototype.u=function(){this.m=!0;null!==this.c&&this.c.D()};
La.prototype.o=function(){this.m=!0;null!==this.f&&(this.K.volume="number"===typeof this.f.volume?this.f.volume:1,this.K.loop="boolean"===typeof this.f.loop?this.f.loop:!0,this.K.currentTime="number"===typeof this.f.startTime?this.f.startTime:0,!0===this.f.autoPlay&&this.K.play());null!==this.c&&this.c.D()};La.prototype.destroy=function(){null!==this.K&&(this.K.destroy(),this.K=null);null!==this.c&&(this.c.destroy(),this.c=null);this.j=this.i=null};
Object.defineProperty(La.prototype,"displayObject",{get:function(){return this.K}});Object.defineProperty(La.prototype,"ready",{get:function(){return this.m}});Object.defineProperty(La.prototype,"onLoadComplete",{get:function(){null===this.c&&(this.c=new q(this));return this.c}});
function x(a){this.i=a;this.u=this.j=this.o=this.H=null;this.ka=Oa.Yc;this.f=this.B=this.A=this.m=null;this.V=Pa.Yc;this.c=this.F=this.L=this.S=this.C=null;this.ia=this.P=this.M=this.ba=!1;this.U=this.R=this.J=this.I=null;l.call(this,"RenderManager");this.G=new THREE.Clock;this.i.onReady.add(this.Mh,this,1E3)}x.prototype=Object.create(l.prototype);g=x.prototype;g.constructor=x;
g.Mh=function(){var a={antialias:!0,alpha:!0,premultipliedAlpha:!1,stencil:!1,canvas:this.i.canvas.dom};try{this.H=new THREE.WebGLRenderer(a)}catch(b){this.destroy();return}this.H.autoClear=!1;this.H.autoClearDepth=!0;this.H.autoClearColor=!0;this.B=new Qa(this.i);this.j=new Ra(this.i);this.F=new Sa(this.i);this.o=new Ta(this.i);this.j.onDisplayChange.add(this.Si,this);Ua(this,this.j.rendererSize);this.C=new L(this.i);this.i.canvas.onResize.add(this.vi,this);this.i.story.onSceneLoadStart.add(this.Lh,
this)};
g.Lh=function(){this.i.story.scene.onUnloadStart.fa(this.Um,this);this.c=this.i.story.scene.config;this.i.container.background=this.c.background;this.F.qj();this.o.hj(this.F.renderScenes);var a=B.Za(this.i.config.view,this.c.view),a="string"===typeof a.type?a.type.toLowerCase():Oa.pb;if(null!==this.u&&this.u.type===a)this.log("Render manager won't set view if it's already set");else switch(a){case Oa.ic:this.qc(Oa.ic);break;default:this.qc(Oa.pb)}a=B.Za(this.i.config.camera,this.c.camera);this.C.load(a);
a=this.c;"undefined"!==typeof a.media&&null!==a.media?(this.V=a.media.type===Ja.jc||"undefined"!==typeof a.media.source&&null!==a.media.source&&a.media.source.format===Ka.Ad||!0===this.j.presentingVR?Pa.Gd:Pa.Kd,this.m=new La(this.i,a),!0===this.m.ready?this.Hi():this.m.onLoadComplete.fa(this.Hi,this),B.T(this.m.displayObject,["VideoHTML5","VideoDash"])&&this.m.displayObject.onQualityChange.add(this.Ye,this),null!==this.R&&this.R.D()):Va(this);a=this.c;if("undefined"!==typeof a.sound&&"undefined"!==
typeof a.sound.source){var b,d,e,h;"undefined"!==typeof a.sound.options&&(b="number"===typeof a.sound.options.volume?G.X(a.sound.options.volume,0,1):1,d="boolean"===typeof a.sound.options.loop?a.sound.options.loop:!1,e="number"===typeof a.sound.options.startTime?a.sound.options.startTime:0,h="boolean"===typeof a.sound.options.autoPlay?a.sound.options.autoPlay:!1);"undefined"!==typeof a.sound.source.url&&""!==a.sound.source.url&&(this.A=new M(this.i,a.sound.uid,a.sound.source.url,a.sound.type===Ga.cf?
!0:!1),"undefined"!==typeof a.sound.options&&null!==a.sound.options&&(this.A.volume=b,this.A.loop=d,this.A.startTime=e,!0===h&&this.A.play(this.A.startTime,this.A.loop,!0)))}};
g.Um=function(){this.P=this.ia=!1;Va(this);null!==this.F&&this.F.We();null!==this.B&&this.B.th();null!==this.o&&this.o.Ze();null!==this.A&&(this.A.destroy(),this.A=null);null!==this.m&&(!0===B.T(this.m.displayObject,["VideoHTML5","VideoDash"])&&void 0!==this.m.displayObject.onQualityChange&&this.m.displayObject.onQualityChange.has(this.Ye,this)&&this.m.displayObject.onQualityChange.remove(this.Ye,this),null!==this.U&&this.U.D(),this.m.destroy(),this.m=null)};
g.Hi=function(a){this.log("Media load is complete");Wa(this,this.V);"undefined"!==typeof a&&null!==a&&(this.f.displayObject=a.emitter.displayObject);a=null;"undefined"!==typeof this.c.media&&null!==this.c.media&&"undefined"!==typeof this.c.media.fx&&null!==this.c.media.fx&&(a=this.i.postProcessing.je(this.c.media.fx));this.o.Rf(this.f.renderTarget.texture,a,1);"undefined"!==typeof this.c.fx&&null!==this.c.fx&&this.o.gj(this.i.postProcessing.je(this.c.fx));this.P=!0};
g.Ye=function(a){this.log("Media quality has changed");this.f.displayObject=a.emitter};function Ua(a,b){a.log("Renderer size: "+b.width+"x"+b.height);var d=a.j.presentingVR,e=!0;!0===d&&(e=!1);!1===d&&a.j.setSize(b);a.H.setSize(b.width,b.height,e);a.S=b;a.L=new Ia(b.width*(d?.5:1),b.height);null!==a.f&&a.f.setSize(a.L);a.B.setSize(a.L);a.o.setSize(a.L);a.log("Render size change in "+(d?"VR":"screen")+" mode, resolution: "+a.L.width+"x"+a.L.height)}
g.vi=function(){this.log("_canvasResizeHandler");var a=this.i.canvas.dom;Ua(this,new Ia(a.width,a.height))};g.Si=function(){Ua(this,this.j.rendererSize);this.B.mode=!0===this.j.presentingVR?Xa.yc:Xa.Xa};
function Wa(a,b){var d=null,e=null;null!==a.f&&(null!==a.f.displayObject&&(d=a.f.displayObject),null!==a.f.renderTarget&&(e=a.f.renderTarget));Va(a);b===Pa.Kd?(a.log("Create background shader renderer"),a.f=new Ya(a.i,e),e=a.H.getSize(),Ua(a,new Ia(e.width,e.height))):b===Pa.Gd&&(a.log("Create background mesh renderer"),b={order:"RLUDFB"},"undefined"!==typeof a.c.media&&null!==a.c.media&&(b.type=a.c.media.type,"undefined"!==typeof a.c.media.options&&null!==a.c.media.options&&"undefined"!==typeof a.c.media.options.color&&
(b.color=a.c.media.options.color),"undefined"!==typeof a.c.media.source&&null!==a.c.media.source&&(b.order=a.c.media.source.order||"RLUDFB","number"===typeof a.c.media.source.tile?b.tile=a.c.media.source.tile:Array.isArray(a.c.media.source.levels)&&"number"===typeof a.c.media.source.levels[0].tile&&(b.tile=a.c.media.source.levels[0].tile),b.Vn=a.c.media.source.format)),a.f=new Za(a.i,e,b));null!==d&&(a.f.displayObject=d);a.ba=!0;null!==a.I&&a.I.D()}
function Va(a){null!==a.f&&(a.f.destroy(),a.f=null);a.ba=!1}g.update=function(){this.C.update()};
g.render=function(){if(!1!==this.M&&!1!==this.P&&null!==this.o){null!==this.f&&this.f.update();for(var a=this.j.presentingVR,b=this.j.Nj(),d=0,e=b.length;d<e;d++){var h=b[d],k=h.rectangle,h=h.camera;this.H.setViewport(k.origin.x,k.origin.y,k.size.width,k.size.height);null!==this.f&&this.f.render((a?h:null)||null);this.o.render(h);this.H.clearDepth();!0===a&&(k=new THREE.Scene,k.add(h),this.H.render(k,h))}!0===this.j.presentingVR&&this.j.Kh()}};g.screenToWorld=function(a){return this.u.screenToWorld(a)};
g.worldToScreen=function(a,b){return this.u.worldToScreen(a,b||0)};g.Nh=function(a){this.j.presentingVR!==a&&!0===I.He&&(this.j.Jh(a),a?(this.ka=this.u.type,this.qc(Oa.pb)):(this.qc(this.ka),this.C.roll=0),"undefined"!==typeof this.c.media&&null!==this.c.media&&"undefined"!==typeof this.c.media.source&&null!==this.c.media.source&&this.c.media.source.format===Ka.Vc&&(this.V=!0===a?Pa.Gd:Pa.Kd,Wa(this,this.V)))};g.lo=function(){this.Nh(!this.j.presentingVR)};
g.qc=function(a){this.log("setView");if(null!==this.u){if(this.u.type===a)return;this.log("Destroy previous view");this.u.destroy();this.u=null}this.M=!1;if(a===Oa.pb)this.u=new $a(this.i,this.C);else if(a===Oa.ic)this.u=new ab(this.i,this.C);else throw"View type not supported "+a;null!==this.f&&this.f.Nc();this.M=!0;this.B.Gk(a);a===Oa.pb?this.o.cg(!1):this.o.cg(!0,this.B.material,this.B.renderTarget);this.onViewReady.D()};
g.destroy=function(){this.i.canvas.onResize.remove(this.vi,this);this.i.story.onSceneLoadStart.remove(this.Lh,this);this.i.onReady.remove(this.Mh,this);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.I&&(this.I.destroy(),this.I=null);null!==this.J&&(this.J.destroy(),this.J=null);null!==this.O&&(this.O.destroy(),this.O=null);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.F&&(this.F.destroy(),this.F=null);null!==this.u&&(this.u.destroy(),
this.u=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.j&&(this.j.onDisplayChange.remove(this.Si,this),this.j.destroy(),this.j=null);null!==this.o&&(this.o.destroy(),this.o=null);this.H=this.c=this.G=null;l.prototype.destroy.call(this)};Object.defineProperty(x.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(x.prototype,"media",{get:function(){return this.m}});Object.defineProperty(x.prototype,"mediaSound",{get:function(){return this.A}});
Object.defineProperty(x.prototype,"webGLRenderer",{get:function(){return this.H}});Object.defineProperty(x.prototype,"renderPipeline",{get:function(){return this.o}});Object.defineProperty(x.prototype,"backgroundRenderer",{get:function(){return this.f}});Object.defineProperty(x.prototype,"pickingManager",{get:function(){return this.B}});
Object.defineProperty(x.prototype,"view",{get:function(){return this.u},set:function(a){if("string"===typeof a&&""!==a)switch(a){case Oa.ic:this.qc(Oa.ic);break;case Oa.pb:this.qc(Oa.pb);break;default:throw"View type not supported: "+a;}}});Object.defineProperty(x.prototype,"camera",{get:function(){return this.C}});Object.defineProperty(x.prototype,"canvasResolution",{get:function(){return this.S}});Object.defineProperty(x.prototype,"displayResolution",{get:function(){return this.L}});
Object.defineProperty(x.prototype,"presentingVR",{get:function(){return this.j.presentingVR}});Object.defineProperty(x.prototype,"display",{get:function(){return this.j}});Object.defineProperty(x.prototype,"backgroundReady",{get:function(){return this.ba}});Object.defineProperty(x.prototype,"onBackgroundReady",{get:function(){null===this.I&&(this.I=new q(this,!0));return this.I}});Object.defineProperty(x.prototype,"viewReady",{get:function(){return this.M}});
Object.defineProperty(x.prototype,"onViewReady",{get:function(){null===this.J&&(this.J=new q(this,!0));return this.J}});Object.defineProperty(x.prototype,"objects",{get:function(){return this.F}});Object.defineProperty(x.prototype,"hotspotsReady",{get:function(){return this.ia}});Object.defineProperty(x.prototype,"onHotspotsReady",{get:function(){null===this.O&&(this.O=new q(this,!0));return this.O}});
Object.defineProperty(x.prototype,"onMediaReady",{get:function(){null===this.R&&(this.R=new q(this));return this.R}});Object.defineProperty(x.prototype,"onMediaRelease",{get:function(){null===this.U&&(this.U=new q(this));return this.U}});
function bb(a,b,d,e){this.i=a;this.m=b;this.j=d;this.o=e;this.f=this.c=null;l.call(this,"RenderScene");this.c=new cb(eb.Tb,this.i.renderer.webGLRenderer);a=new fb(this.m,this.j);a.position=gb.Tb;this.c.addPass(a);a=this.i.postProcessing.ze(this.o);b=0;for(d=a.length;b<d;b++)e=a[b],e.renderToScreen=!1,e.position=gb.Tb,this.c.addPass(e);this.f=new cb(eb.tf,this.i.renderer.webGLRenderer);a=new fb(this.m,this.j);a.position=gb.Tb;this.f.addPass(a)}bb.prototype=Object.create(l.prototype);
bb.prototype.constructor=bb;bb.prototype.setSize=function(a,b){this.c.setSize(a,b);this.f.setSize(a,b)};bb.prototype.destroy=function(){this.c.readBuffer.dispose();for(this.c.writeBuffer.dispose();0<this.c.passes.length;){var a=this.c.passes.pop();a instanceof hb&&a.hasOwnProperty("tDiffuse")&&(a.uniforms.tDiffuse.value.texture.dispose(),a.uniforms.tDiffuse.value=null)}this.c=null;this.f.passes.length=0;this.o=this.j=this.m=this.i=this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(bb.prototype,"scene",{get:function(){return this.m}});Object.defineProperty(bb.prototype,"camera",{get:function(){return this.j}});Object.defineProperty(bb.prototype,"sceneComposer",{get:function(){return this.c}});Object.defineProperty(bb.prototype,"pickingComposer",{get:function(){return this.f}});function Ta(a){this.i=a;this.G=this.f=this.c=null;this.j=!0;l.call(this,"RenderPipeline");this.G=new THREE.Clock;this.f=[];this.c=new cb(eb.ii,this.i.renderer.webGLRenderer)}
Ta.prototype=Object.create(l.prototype);g=Ta.prototype;g.constructor=Ta;
function ib(a,b){a.log("COMPOSER: "+b.name);if(b.passes.length){for(var d=[],e=0,h=b.passes.length;e<h;e++){var k;k=b.passes[e];k=k instanceof hb?k.hasOwnProperty("map")?"Texture("+k.map.uuid.split("-")[0].slice(0,4)+")":"Texture":k instanceof fb?"Render":k instanceof THREE.ClearMaskPass?"ClearMask":k instanceof THREE.MaskPass?"Mask":k instanceof jb?"Shader("+k.type.replace("Shader","")+")":"Pass";d.push(k)}e="";h=0;for(k=d.length;h<k;h++){for(var n=d[h],e=e+"| ",v=0;v<n.length;v++)e+="-";e+=" |";
if(h<k-1)for(n=0;5>n;n++)e+=" "}a.log(e);h="";k=0;for(n=d.length;k<n;k++)h+="| "+d[k]+" |",k<n-1&&(h+=" --- ");!1===b.passes[b.passes.length-1].renderToScreen&&(h+=" --- tex",null!==b.readBuffer&&"undefined"!==typeof b.readBuffer.name&&(h+="("+b.readBuffer.name+")"));a.log(h);a.log(e)}}function kb(a){for(var b=0,d=a.f.length;b<d;b++)ib(a,a.f[b]);ib(a,a.c)}function lb(a,b,d){a.f.push(b);!1===d&&(b=new mb(b),a.c.addPass(b));nb(a)}
function ob(a,b,d){d="undefined"!==typeof d?d:a.passes.length;if(Array.isArray(b))for(var e=b.length-1;0<=e;e--)a.insertPass(b[e],d);else b instanceof THREE.Pass&&a.insertPass(b,d)}
function nb(a){var b=a.c.passes,d=[];b.filter(function(a,b){a.position===gb.xd&&d.push(b)});if(0<d.length&&0<d[0]){for(var e=[],h=d.length-1;0<=h;h--){var k=b.splice(d[h],1)[0];e.push(k)}h=0;for(k=e.length;h<k;h++)a.c.insertPass(e[h],0)}var n=[];b.filter(function(a,b){a.position===gb.gf&&n.push(b)});if(0<n.length&&n[n.length-1]<b.length-1){e=[];h=0;for(k=n.length;h<k;h++){var v=b.splice(n[h],1)[0];e.push(v)}h=0;for(k=e.length;h<k;h++)a.c.addPass(e[h])}e=0;for(h=a.f.length;e<h;e++){var k=a.f[e],v=
!1,y,D=a.f.length;for(y=0;y<D;y++)if(y!==e&&k.readBuffer===a.f[y].readBuffer){v=!0;break}v=v&&e>y;y=0;for(D=k.passes.length;y<D;y++)k.passes[y].clear=!0===v?!1:!y}e=!1;for(h=b.length-1;0<=h;h--)k=b[h],!0===e?k.renderToScreen=!1:!0===k.enabled&&(e=k.renderToScreen=!0);kb(a)}g.cg=function(a,b,d){for(var e=0,h=this.f.length;e<h;e++){var k=this.f[e];k.type===eb.tf&&(k.enabled=a,"undefined"!==typeof b&&(k.passes[0].overrideMaterial=b),"undefined"!==typeof d&&(k.renderTarget=d))}};
g.Rf=function(a,b,d){if("undefined"!==typeof b&&null!==b&&0<b.length){b=this.i.postProcessing.ze(b);for(var e=0,h=b.length;e<h;e++)b[e].position=gb.xd;ob(this.c,b,0)}a=new hb(a,d);a.position=gb.xd;this.c.insertPass(a,0);nb(this)};g.hj=function(a){for(var b=0,d=a.length;b<d;b++)lb(this,a[b].sceneComposer,!1),lb(this,a[b].pickingComposer,!0);nb(this)};g.gj=function(a){a=this.i.postProcessing.ze(a);for(var b=0,d=a.length;b<d;b++)a[b].position=gb.gf;ob(this.c,a);nb(this)};
g.Hn=function(a){if(null!==this.c)for(var b=0,d=this.c.passes.length;b<d;b++){var e=this.c.passes[b];if(e.uid===a)return e}if(null!==this.f)for(b=0,d=this.f.length;b<d;b++)for(var e=this.f[b],h=0,k=e.passes.length;h<k;h++){var n=e.passes[h];if(n.uid===a)return n}return null};
g.setSize=function(a){for(var b=0,d=this.f.length;b<d;b++){var e=this.f[b];e.setSize(a.width,a.height);for(var h=0,k=e.passes.length;h<k;h++){var n=e.passes[h];n instanceof THREE.ShaderPass&&"undefined"!==typeof n.uniforms.resolution&&(n.uniforms.resolution.value=new THREE.Vector2(1/a.width,1/a.height))}}this.c.setSize(a.width,a.height);h=0;for(k=this.c.passes.length;h<k;h++)n=this.c.passes[h],n instanceof THREE.ShaderPass&&"undefined"!==typeof n.uniforms.resolution&&(n.uniforms.resolution.value=
new THREE.Vector2(1/a.width,1/a.height))};
g.render=function(a){if(null!==this.c){if(!(this.c.passes[0]instanceof hb)){var b=document.createElement("canvas");b.width=b.height=1;var d=b.getContext("2d");d.fillStyle="rgb(0, 0, 0)";d.fillRect(0,0,b.width,b.height);b=(new THREE.TextureLoader).load(b.toDataURL());b.name="forge-default-texture";this.Rf(b,null,0)}b=0;for(d=this.c.passes.length;b<d;b++){var e=this.c.passes[b];if(e instanceof mb){var h=e.composer,k=h.readBuffer.texture;!0===h.passes[h.passes.length-1].needsSwap&&(k=h.writeBuffer.texture);
e.uniforms.tAdd.value=k}}b=this.G.getDelta();d=this.f.concat(this.c);e=0;for(h=d.length;e<h;e++)for(var k=d[e],n=0,v=k.passes.length;n<v;n++){var y=k.passes[n];y instanceof fb&&(y.camera=a)}a=0;for(d=this.f.length;a<d;a++)this.f[a].enabled&&this.f[a].render(b);this.c.render(b)}};
g.Ze=function(){if(null!==this.c){this.c.readBuffer.dispose();this.c.writeBuffer.dispose();for(var a=0,b=this.c.passes.length;a<b;a++){var d=this.c.passes[a];d instanceof jb&&d.uniforms.hasOwnProperty("tAdd")&&(d.uniforms.tAdd.value=null)}this.c.passes=[]}this.f=[]};
g.destroy=function(){this.Ze();this.G=null;for(var a=this.f.length-1;0<a;a--){for(var b=this.f[a],d=0,e=b.passes.length;d<e;d++){var h=b.passes[d];"function"===typeof h.destroy&&h.destroy()}b.passes.length=0}this.f=null;d=0;for(e=this.c.passes.length;d<e;d++)h=this.c.passes[d],"function"===typeof h.destroy&&h.destroy();this.c.passes.length=0;this.i=this.c=null};
Object.defineProperty(Ta.prototype,"enabled",{get:function(){return this.j},set:function(a){for(var b=this.f.concat(this.c),d=0,e=b.length;d<e;d++){var h=b[d],k=a;!1===k&&(this.j=!1);for(var n=h.passes.length-1;0<=n;n--){var v=h.passes[n];v instanceof THREE.ShaderPass&&!(v instanceof mb)&&(v.enabled=k)}h.hasOwnProperty("enabled")&&(h.enabled=k);nb(this)}this.j=a}});
function Ra(a){this.i=a;this.u=this.G=!1;this.A=this.f=this.m=this.j=this.c=null;this.H=1;this.B=this.o=null;l.call(this,"RenderDisplay");pb(this)}Ra.prototype=Object.create(l.prototype);g=Ra.prototype;g.constructor=Ra;
function pb(a){var b=a.i.renderer.webGLRenderer;a.H=b.getPixelRatio();b=b.getSize();a.A=new Ia(b.width,b.height);a.f=a.A;a.j=[0,0,.5,1];a.m=[.5,0,.5,1];"VRFrameData"in window&&(a.o=new VRFrameData);!0===I.He?(navigator.getVRDisplays().then(function(b){a.G=0<b.length;for(var d=0,h=b.length;d<h;d++)if("VRDisplay"in window&&b[d]instanceof VRDisplay){a.c=b[d];a.c.depthNear=.01;a.c.depthFar=2E4;break}}),qb(a)):a.warn("missing api navigator.getVRDisplays")}
function qb(a){a.i.container.onFullscreenEnter.add(a.Gc,a);a.i.container.onFullscreenExit.add(a.Gc,a);window.addEventListener("vrdisplaypresentchange",a.Gc.bind(a),!1)}
g.Gc=function(){var a=this.u,b=this.i.renderer.webGLRenderer;this.u="undefined"!==typeof this.c&&(!0===this.c.isPresenting||!1===this.G&&document[I.fullscreenElement]instanceof window.HTMLElement);if(!0===this.u){var d=this.c.getEyeParameters("left");!0===this.G&&(this.F=d.renderWidth,this.C=d.renderHeight,this.log("Window size: "+window.innerWidth+"x"+window.innerHeight),this.log("Render size: "+this.F+"x"+this.C),this.j=[0,0,.5,1],this.m=[.5,0,.5,1],this.c.getLayers&&(d=this.c.getLayers(),0<d.length&&
null!==d[0].leftBounds&&4===d[0].leftBounds.length&&(this.j=d[0].leftBounds,this.m=d[0].rightBounds)),this.log("Bounds L:["+this.j[0]+", "+this.j[1]+", "+this.j[2]+", "+this.j[3]+"], R:["+this.m[0]+", "+this.m[1]+", "+this.m[2]+", "+this.m[3]+"]"));!1===a&&(this.H=b.getPixelRatio(),d=b.getSize(),this.A.width=d.width,this.A.height=d.height,this.f=new Ia(2*this.F,this.C),b.setPixelRatio(1))}else!0===a&&(this.f=this.A,b.setPixelRatio(this.H));this.u!==a&&null!==this.B&&this.B.D()};
function rb(a,b){var d=a.i.renderer.webGLRenderer.domElement;new Promise(function(a,h){"undefined"===typeof this.c?h(Error("No VR hardware found.")):this.u===b?a():!0===this.G&&(b?a(this.c.requestPresent([{source:d}])):a(this.c.exitPresent()))}.bind(a))}g.Jh=function(a){!0===a?(this.i.raf.stop(),this.i.raf.start(this.c),rb(this,!0)):(this.i.raf.stop(),this.i.raf.start(window),rb(this,!1))};
g.Lj=function(){if(null===this.c)return null;var a=null;null!==this.o&&"undefined"!==typeof this.o.c?a=this.o.c:a=this.c.getPose();if(null===a||null===a.orientation)return new THREE.Quaternion;a=a.orientation;return new THREE.Quaternion(-a[1],-a[0],-a[2],a[3])};
g.Nj=function(){var a=this.i.renderer.camera,b=[];if("undefined"!==typeof this.c&&null!==this.c&&!0===this.u){var d=this.f.width*this.j[0],e=this.f.height*this.j[1],h=this.f.width*this.j[2],k=this.f.height*this.j[3],n=new Ha(d,e,h,k),d=this.f.width*this.m[0],e=this.f.height*this.m[1],h=this.f.width*this.m[2],k=this.f.height*this.m[3],d=new Ha(d,e,h,k);b.push(new sb(n,a.left));b.push(new sb(d,a.right))}else b.push(new sb(new Ha(0,0,this.A.width,this.A.height),a.main));return b};
g.setSize=function(a){this.A=a;this.i.renderer.webGLRenderer.setPixelRatio(1)};g.Kh=function(){!0===this.G&&"undefined"!==typeof this.c&&!0===this.u&&!0===this.c.capabilities.hasExternalDisplay&&this.c.submitFrame()};g.destroy=function(){this.i.container.onFullscreenEnter.remove(this.Gc,this);this.i.container.onFullscreenExit.remove(this.Gc,this);window.removeEventListener("vrdisplaypresentchange",this.Gc.bind(this));this.i=this.f=this.m=this.j=this.o=this.c=null};
Object.defineProperty(Ra.prototype,"presentingVR",{get:function(){return this.u}});Object.defineProperty(Ra.prototype,"vrDisplay",{get:function(){return this.c}});Object.defineProperty(Ra.prototype,"vrFrameData",{get:function(){return null!==this.c&&"function"===typeof this.c.getFrameData&&null!==this.o?(this.c.getFrameData(this.o),this.o):null}});Object.defineProperty(Ra.prototype,"rendererSize",{get:function(){return this.f}});
Object.defineProperty(Ra.prototype,"onDisplayChange",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});function sb(a,b){this.f=a||null;this.c=b||null}sb.prototype.constructor=sb;Object.defineProperty(sb.prototype,"rectangle",{get:function(){return this.f}});Object.defineProperty(sb.prototype,"camera",{get:function(){return this.c}});function tb(a,b,d){this.i=a;this.C=this.m=this.f=null;this.A=b||null;l.call(this,d||"BackgroundRenderer");this.Pc()}tb.prototype=Object.create(l.prototype);
g=tb.prototype;g.constructor=tb;g.Pc=function(){this.m=new THREE.Scene;null===this.A&&(this.A=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width,this.i.renderer.canvasResolution.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,xo:!1}))};g.Nc=function(){throw Error(this.Ua+"::updateAfterViewChange not implemented");};g.setSize=function(a){null!==this.renderTarget&&this.renderTarget.setSize(a.width,a.height)};
g.render=function(a){if(null!==this.i.renderer&&null!==this.A){if(null!==this.c&&null!==this.u&&null!==this.B&&null!==this.K&&null!==this.K.element&&(!0!==B.T(this.K,["VideoHTML5","VideoDash"])||!1!==this.K.playing)){var b=this.K.element;b instanceof HTMLVideoElement&&b.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA&&this.B&&(this.B.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,this.u.width,this.u.height),this.c.needsUpdate=!0,this.log("texture update done"))}null!==a?this.i.renderer.webGLRenderer.render(this.m,
a,this.A,!0):this.i.renderer.webGLRenderer.render(this.m,this.C,this.A,!0)}};
g.update=function(){if(this.f.material instanceof THREE.ShaderMaterial){var a=this.i.renderer.displayResolution;this.f.material.uniforms.hasOwnProperty("tViewportResolution")&&(this.f.material.uniforms.tViewportResolution.value=new THREE.Vector2(a.width,a.height));this.f.material.uniforms.hasOwnProperty("tViewportResolutionRatio")&&(this.f.material.uniforms.tViewportResolutionRatio.value=a.ratio);this.f.material.uniforms.hasOwnProperty("tModelViewMatrixInverse")&&(this.f.material.uniforms.tModelViewMatrixInverse.value=
this.i.renderer.camera.modelViewInverse);this.i.renderer.view.tc(this.f.material.uniforms)}};g.destroy=function(){this.C=null;null!==this.A&&(this.A.dispose(),this.A=null);for(;0<this.m.children.length;){var a=this.m.children.pop();null!==a.geometry&&(a.geometry.dispose(),a.geometry=null);this.m.remove(a)}this.i=this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(tb.prototype,"renderTarget",{get:function(){return this.A}});
Object.defineProperty(tb.prototype,"displayObject",{get:function(){return this.K},set:function(a){null===a?this.Sd():this.Yi(a)}});var Pa={Yc:"undefined",Kd:"shader",Gd:"mesh"};function Za(a,b,d){this.B=this.u=this.c=this.K=null;this.G=d.type||Ja.jc;this.J=d.color||"#ffffff";this.O=d.order||"RLUDFB";this.o=new THREE.Vector2(0,0);this.L=d.tile||512;this.I=d.Vn||Ka.Ad;this.j=this.H=0;this.F=1;tb.call(this,a,b,"BackgroundMeshRenderer")}Za.prototype=Object.create(tb.prototype);g=Za.prototype;
g.constructor=Za;g.Pc=function(){tb.prototype.Pc.call(this);this.C=this.i.renderer.camera.main;this.i.renderer.camera.fovMin=this.i.renderer.view.fovMin;this.i.renderer.camera.fovMax=this.i.renderer.view.fovMax;this.H=2E4;this.j=32;ub(this)};
g.Yi=function(a){this.K=a;if(B.T(a,"Image"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,["VideoHTML5","VideoDash"]))"safari"===I.lb.toLowerCase()&&1440<a.originalHeight&&(this.F=2),this.u=document.createElement("canvas"),this.u.width=a.originalWidth/this.F,this.u.height=a.originalHeight/this.F,this.B=this.u.getContext("2d"),this.c=new THREE.Texture(this.u);else throw"Wrong type of display object "+a.type;this.c.format=
THREE.RGBAFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.f.material.Xg=!1;null!==this.c.image&&(this.o.x=this.c.image.width/this.L,this.o.y=this.c.image.height/this.L);this.f.onBeforeRender=this.Kk.bind(this);if(this.f.geometry instanceof THREE.BoxBufferGeometry)a=vb(this);else if(this.f.geometry instanceof
THREE.SphereBufferGeometry){a=new Float32Array(this.f.geometry.attributes.uv.array.byteLength/4);var b=a.keys(),d=this.j,e=1/d,h,k;for(k=0;k<=d;k++){var n=k*e;for(h=0;h<=d;h++){var v=h*e;a[b.next().value]=1-v;a[b.next().value]=1-n}}}else a=null;null!==a&&this.f.geometry.attributes.uv.set(a)};
g.Kk=function(){"undefined"!==typeof this.f.material.uniforms&&(this.f.material.uniforms.hasOwnProperty("tTexture")&&(this.f.material.uniforms.tTexture.value=this.c),this.f.material.uniforms.hasOwnProperty("tOpacity")&&(this.f.material.uniforms.tOpacity.value=1))};
function vb(a){function b(a,b,h,cc,Tb){if(-1===a)throw"Unknown face for cube mapping.";var D,db=a%b/b;a=1-(1+parseInt(a/b,10))/h;if(Tb)for(Tb=0,h=cc;Tb<=h;Tb++)for(b=0,D=cc;b<=D;b++)d[e.next().value]=v+k*b+db,d[e.next().value]=y+n*Tb+a;else for(Tb=0,h=cc;Tb<=h;h--)for(b=0,D=cc;b<=D;D--)d[e.next().value]=v+k*D+db,d[e.next().value]=y+n*h+a}var d=new Float32Array((a.j+1)*(a.j+1)*12),e=B.Tf(d),h=a.O.split(""),k=1/1.01*(1/a.o.x/a.j),n=1/1.01*(1/a.o.y/a.j),v=1/a.o.x*.005,y=1/a.o.y*.005;b(h.indexOf("R"),
a.o.x,a.o.y,a.j);b(h.indexOf("L"),a.o.x,a.o.y,a.j);b(h.indexOf("U"),a.o.x,a.o.y,a.j,!0);b(h.indexOf("D"),a.o.x,a.o.y,a.j,!0);b(h.indexOf("B"),a.o.x,a.o.y,a.j);b(h.indexOf("F"),a.o.x,a.o.y,a.j);return d}g.Sd=function(){this.i.renderer.webGLRenderer.clearColor()};
function ub(a){if(null===a.i.renderer.view)a.log("Background renderer cannot update internals without a defined view");else{var b;a.G===Ja.jc?(b=B.clone(a.i.renderer.view.Gb).Xg,a.log("Media "+a.G+", use wireframe shader"),a.j=8):(b=B.clone(a.i.renderer.view.Gb).mapping,a.log("Media "+a.G+", use mapping shader"));var d=wb.bb(b.vertexShader),e=wb.bb(b.fragmentShader);b=new THREE.RawShaderMaterial({fragmentShader:e,vertexShader:d,uniforms:b.uniforms,name:"BackgroundMeshMaterial",transparent:!0,side:THREE.BackSide});
null!==a.c&&(b.uniforms.tTexture.value=a.c);a.G===Ja.jc&&(b.uniforms.tColor.value=new THREE.Color(a.J),b.j=THREE.CustomBlending,b.f=THREE.AddEquation,b.N=THREE.SrcAlphaFactor,b.c=THREE.OneMinusSrcAlphaFactor);if(0===a.m.children.length){a.I===Ka.Vc?(a.j=64,d=new THREE.SphereBufferGeometry(a.H,a.j,a.j),a.log("Create sphere geometry")):(d=new THREE.BoxBufferGeometry(a.H,a.H,a.H,a.j,a.j,a.j),a.log("Create box geometry"));a.f=new THREE.Mesh(d,b);if(a.G===Ja.jc&&null!==a.f&&"undefined"!==typeof a.f.geometry){for(var d=
new Int8Array(2*a.f.geometry.attributes.position.array.length/3),e=B.Tf(d),h=new THREE.Vector2(1,1),k=new THREE.Vector2(1,-1),n=new THREE.Vector2(-1,1),v=new THREE.Vector2(-1,-1),y=a.j+1,D=0;6>D;D++)for(var db=0;db<y;db++){var Fc,cc;db&1?(Fc=h,cc=k):(Fc=n,cc=v);for(var Tb=0;Tb<y;Tb++)Tb&1?(d[e.next().value]=cc.x,d[e.next().value]=cc.y):(d[e.next().value]=Fc.x,d[e.next().value]=Fc.y)}a.f.geometry.addAttribute("quadrilateralCoords",new THREE.BufferAttribute(d,2))}a.I===Ka.Vc&&a.f.rotation.set(0,Math.PI/
2,0,"YXZ");a.m.add(a.f)}else a.f=a.m.children[0],a.f.material.dispose();a.f.material=b;b.needsUpdate=!0}}g.Nc=function(){ub(this)};g.render=function(a){null!==this.i.renderer&&tb.prototype.render.call(this,a)};
g.destroy=function(){this.Sd();this.B=this.u=this.K=null;null!==this.f&&(this.log("Destroy mesh (dispose geometry and material)"),null!==this.f.geometry&&(this.f.geometry.dispose(),this.f.geometry=null),null!==this.f.material&&(this.f.material.dispose(),this.f.material=null),this.f=null);null!==this.c&&(this.c.dispose(),this.c=null);tb.prototype.destroy.call(this)};Object.defineProperty(Za.prototype,"texture",{get:function(){return this.c}});
function Ya(a,b){this.B=this.u=this.c=this.K=null;this.j=1;tb.call(this,a,b,"BackgroundShaderRenderer")}Ya.prototype=Object.create(tb.prototype);g=Ya.prototype;g.constructor=Ya;g.Pc=function(){tb.prototype.Pc.call(this);xb(this);this.C=new THREE.OrthographicCamera(-1,1,1,-1,-1,1)};
g.Yi=function(a){this.K=a;if(B.T(a,"Image")||B.T(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,["VideoHTML5","VideoDash"]))"safari"===I.lb.toLowerCase()&&1440<a.originalHeight&&(this.j=2),this.K.onQualityChange.has(this.Qc,this)&&this.K.onQualityChange.remove(this.Qc,this),this.K.onQualityChange.add(this.Qc,this),this.u=document.createElement("canvas"),this.u.width=a.originalWidth/this.j,this.u.height=a.originalHeight/this.j,this.B=this.u.getContext("2d"),this.c=new THREE.Texture(this.u);
else throw"Wrong type of display object "+a.className;this.c.format=THREE.RGBFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.f.material.uniforms.tTexture.value=this.c};
g.Qc=function(a){this.log("Media quality has changed");a=a.emitter;this.u.width=a.originalWidth/this.j;this.u.height=a.originalHeight/this.j};
function xb(a){var b=a.i.renderer.view.Lc,d=wb.bb(b.vertexShader),e=wb.bb(b.fragmentShader),b=new THREE.ShaderMaterial({uniforms:b.uniforms,vertexShader:d,fragmentShader:e,side:THREE.FrontSide});null!==a.c&&(b.uniforms.tTexture.value=a.c);0===a.m.children.length?(d=new THREE.PlaneBufferGeometry(2,2),a.f=new THREE.Mesh(d,b),a.m.add(a.f)):(a.f=a.m.children[0],a.f.material=null);a.f.material=b;b.needsUpdate=!0}g.Sd=function(){this.i.renderer.webGLRenderer.clearColor()};
g.render=function(){null!==this.i.renderer&&tb.prototype.render.call(this,null)};g.Nc=function(){xb(this)};g.destroy=function(){this.Sd();"undefined"!==typeof this.K.onQualityChange&&this.K.onQualityChange.has(this.Qc,this)&&this.K.onQualityChange.remove(this.Qc,this);this.B=this.u=this.K=null;null!==this.c&&(this.c.dispose(),this.c=null);tb.prototype.destroy.call(this)};Object.defineProperty(Ya.prototype,"texture",{get:function(){return this.c}});
function ta(a){this.i=a;this.c=this.f=null;l.call(this,"PostProcessing");this.c={}}ta.prototype=Object.create(l.prototype);g=ta.prototype;g.constructor=ta;
g.ze=function(a){if("undefined"===typeof a||null===a||!a.length)return[];for(var b=[],d=0,e=a.length;d<e;d++){var h=a[d],k;if(THREE.hasOwnProperty(h.type)){k=new jb(h.uid,h.type,THREE[h.type]);if("undefined"!==typeof k.uniforms)for(var n in h.params){var v=h.params[n],y=v;if("object"===typeof v&&v.hasOwnProperty("type")&&v.hasOwnProperty("args")){var D=v.args;switch(v.type){case "THREE.Color":if(3===D.length)y=new THREE.Color(D[0],D[1],D[2]);else if("string"===typeof D||"number"===typeof D)y=new THREE.Color(D);
else throw Error("Cannot create THREE.Color with "+typeof D+" (length "+D.length+")");break;case "THREE.Vector2":y=new THREE.Vector2(D[0],D[1]);break;case "THREE.Vector3":y=new THREE.Vector3(D[0],D[1],D[2])}}k.uniforms[n].value=y}b.push(k)}else this.warn("Unknown image effect ("+h.type+")")}return b};g.je=function(a){return this.c[a]};
g.ja=function(a){a=this.f=a;this.N=a.uid;if("undefined"!==typeof a.fxSets&&0<a.fxSets.length)for(var b=0,d=a.fxSets.length;b<d;b++){var e=a.fxSets[b];this.c[e.uid]=e.set}};g.destroy=function(){this.c=this.i=null};var eb={ii:"main",Tb:"render",tf:"picking"};function cb(a,b,d){this.N=a||eb.Tb;this.f="";this.c=!0;THREE.EffectComposer.call(this,b,d);this.f=yb(this.N)}cb.prototype=Object.create(THREE.EffectComposer.prototype);cb.prototype.constructor=cb;
cb.prototype.destroy=function(){this.writeBuffer.dispose();this.writeBuffer=null;this.readBuffer.dispose();this.readBuffer=null};cb.uid=0;function yb(a){return"$_EffectComposer."+a+"."+cb.uid++}Object.defineProperty(cb.prototype,"type",{get:function(){return this.N}});Object.defineProperty(cb.prototype,"renderTarget",{get:function(){return this.readBuffer},set:function(a){null!==this.readBuffer&&this.readBuffer.dispose();this.readBuffer=a}});
Object.defineProperty(cb.prototype,"enabled",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(cb.prototype,"name",{get:function(){return this.f}});var gb={Od:"",xd:"background",Tb:"render",gf:"global"};function hb(a,b){this.c="";THREE.TexturePass.call(this,a,b)}hb.prototype=Object.create(THREE.TexturePass.prototype);hb.prototype.constructor=hb;Object.defineProperty(hb.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
function jb(a,b,d,e){this.o=a;this.m=b||"shader";this.N=gb.Od;this.f=0;THREE.ShaderPass.call(this,d,e||"tDiffuse")}jb.prototype=Object.create(THREE.ShaderPass.prototype);jb.prototype.constructor=jb;jb.prototype.render=function(a,b,d,e,h){this.f+=e;this.uniforms.hasOwnProperty("time")&&(this.uniforms.time.value=this.f);THREE.ShaderPass.prototype.render.call(this,a,b,d,e,h)};Object.defineProperty(jb.prototype,"uid",{get:function(){return this.o}});Object.defineProperty(jb.prototype,"type",{get:function(){return this.m}});
Object.defineProperty(jb.prototype,"position",{get:function(){return this.N},set:function(a){this.N=a}});function mb(a){this.j=a;this.c=null;a=wb.bb(zb.wts_vert_rectilinear);var b=wb.bb(zb.wts_frag_addition);this.c=new THREE.RawShaderMaterial({fragmentShader:b,vertexShader:a,uniforms:{tTexture:{type:"t",value:null},tAdd:{type:"t",value:null}},side:THREE.FrontSide,name:"$_AdditionPassMaterial"});jb.call(this,"","Addition",this.c,"tTexture")}mb.prototype=Object.create(jb.prototype);
mb.prototype.constructor=mb;mb.prototype.destroy=function(){null===this.c&&(this.c.dispose(),this.c=null);this.j=null};Object.defineProperty(mb.prototype,"composer",{get:function(){return this.j}});function fb(a,b,d,e,h){this.c="";THREE.RenderPass.call(this,a,b,d,e,h)}fb.prototype=Object.create(THREE.RenderPass.prototype);fb.prototype.constructor=fb;Object.defineProperty(fb.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
var zb={coordinates:"\nvec3 toCartesian(in vec3 rtp) {\n    float r = rtp.x;\n    float theta = rtp.y;\n    float phi = rtp.z;\n    float x = r * cos(phi) * sin(theta);\n    float y = r * sin(phi);\n    float z = r * cos(phi) * cos(theta);\n    return vec3(x,y,z);\n}\nvec3 toSpherical(in vec3 pt) {\n    float r = length(pt);\n    float theta = -atan(pt.x, pt.z);\n    float phi = asin(pt.y / r);\n    return vec3(r,theta,phi);\n}\n",defines:"precision highp float;\nprecision highp int;\n#define PI  3.141592653589793\n#define PI2 6.28318530717959\n#define RECIPROCAL_PI2 0.1591549430919\n",
helpers:"\nfloat wrap(in float x, in float min, in float max) {\n    return x - ((max - min) * (1.0 - step(x, min) - step(x, max)));\n}\nvec2 getFragment() {\n    return (2.0 * gl_FragCoord.xy / tViewportResolution - 1.0) * vec2(tViewportResolutionRatio, 1.0);\n}\n",texcoords:"\nvec2 toEquirectangularTexCoords(in vec2 thetaphi) {\n    thetaphi.x = wrap(thetaphi.x + PI, -PI, PI);\n    vec2 coords = 0.5 + thetaphi / vec2(PI2, PI);\n    return coords;\n}\n",uniforms:"uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\n",
vert_attributes:"attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n",vert_attributes_wireframe:"attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 quadrilateralCoords;\n",stw_frag_proj_gopro:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = getFragment();\n    vec2 c = tProjectionScale * frag;\n    float zs = tProjectionDistance;\n    float xy2 = dot(c,c);\n    float zs12 = (zs + 1.0) * (zs + 1.0);\n    float delta = 4.0 * (zs * zs * xy2 * xy2 - (xy2 + zs12) * (xy2 * zs * zs - zs12));\n    if (delta < 0.0) { return vec2(-1.); }\n    float z = (2.0 * zs * xy2 - sqrt(delta)) / (2.0 * (zs12 + xy2));\n    float x = c.x * ((zs - z) / (zs + 1.0));\n    float y = c.y * ((zs - z) / (zs + 1.0));\n    vec3 vx = vec3(tModelViewMatrixInverse * vec4(x, y, z, 1.0));\n    return toSpherical(vx).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n",
stw_frag_proj_rectilinear:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = tProjectionScale * getFragment();\n    vec4 screenPT = vec4(frag, -1.0, 1.0);\n    vec4 worldPT = tModelViewMatrixInverse * screenPT;\n    return toSpherical(worldPT.xyz).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n",
stw_vert_proj:"\n#include <defines>\nvoid main() {\n   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",wts_frag:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform float tOpacity;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tTexture, vUv );\n    gl_FragColor = vec4(texel.rgb, texel.a * tOpacity);\n}\n",wts_frag_addition:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform sampler2D tAdd;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tTexture, vUv );\n    vec4 texelAdd = texture2D( tAdd, vUv );\n    float alpha = max(texel.a, texelAdd.a);\n    gl_FragColor = vec4(vec3(texelAdd.a * texelAdd.rgb + (1.0 - texelAdd.a) * texel.rgb), alpha);\n}\n",
wts_frag_color:"\n#include <defines>\nuniform vec3 tColor;\nuniform float tOpacity;\nvarying vec2 vUv;\nvoid main() {\n    vec2 texCoords = vUv;\n    gl_FragColor = vec4(tColor, tOpacity);\n}\n",wts_frag_depth_drawing:"\n#include <defines>\nvarying float vDepth;\nvoid main() {\n    gl_FragColor = vec4(vDepth, vDepth, vDepth, 1.0);\n}\n",wts_frag_equirectangular:"\n#include <defines>\nuniform sampler2D tTexture;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec3 direction = normalize( vWorldPosition );\n    vec2 sampleUV;\n    sampleUV.y = clamp( direction.y * 0.5 + 0.5, 0.0, 1.0 );\n    sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 - 0.25;\n    sampleUV.x += (1.0 - step(0.0, sampleUV.x));\n    gl_FragColor = texture2D( tTexture, sampleUV );\n}\n",
wts_frag_wireframe:"\n#extension GL_OES_standard_derivatives : enable \n#include <defines>\n#define WIRE_THICKNESS 1.50\nuniform vec3 tColor;\nvarying vec2 vUv;\nvarying vec2 vQuadrilateralCoords;\nvoid main() {\n    vec2 dfdx = dFdx(vQuadrilateralCoords);\n    vec2 dfdy = dFdy(vQuadrilateralCoords);\n    vec2 threshold = vec2(WIRE_THICKNESS * sqrt(dfdx * dfdx + dfdy * dfdy));\n    vec2 amount = smoothstep(vec2(0.0), WIRE_THICKNESS * threshold, vec2(1.0) - abs(vQuadrilateralCoords));\n    float alpha = 1.0 - amount.x * amount.y;\n    gl_FragColor = vec4(tColor.rgb, alpha);\n}\n",
wts_vert_gopro:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 spherePt = normalize(modelViewMatrix * vec4( position, 1.0 ));\n    float radius = 1.0 - 0.5 * tProjectionDistance;\n    float offset = radius - 1.0;\n    spherePt.xyz *= radius;\n    spherePt.z += offset;\n    gl_Position = projectionMatrix * spherePt;\n    vUv = uv;\n}\n",
wts_vert_gopro_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    vec4 origin = vec4(vec3(0.0), 1.0);\n    camPt.z -= tProjectionDistance * distance(camPt, origin);\n    camPt.xyz /= max(1.0, tProjectionScale);\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n",
wts_vert_gopro_wireframe:"\n#include <defines>\n#include <vert_attributes_wireframe>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvarying vec2 vQuadrilateralCoords;\nvoid main() {\n    vec4 spherePt = normalize(modelViewMatrix * vec4( position, 1.0 ));\n    float radius = 1.0 - 0.5 * tProjectionDistance;\n    float offset = radius - 1.0;\n    spherePt.xyz *= radius;\n    spherePt.z += offset;\n    gl_Position = projectionMatrix * spherePt;\n    vUv = uv;\n    vQuadrilateralCoords = quadrilateralCoords;\n}\n",
wts_vert_littleplanet:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",wts_vert_littleplanet_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n",
wts_vert_rectilinear:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",wts_vert_rectilinear_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3( position );\n}\n",
wts_vert_rectilinear_wireframe:"\n#include <defines>\n#include <vert_attributes_wireframe>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvarying vec2 vQuadrilateralCoords;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n    vQuadrilateralCoords = quadrilateralCoords;\n}\n"},wb={screenToWorld:{rectilinear:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",
value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionScale:{type:"f",value:1}},vertexShader:zb.stw_vert_proj,fragmentShader:zb.stw_frag_proj_rectilinear},gopro:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionDistance:{type:"f",
value:0},tProjectionScale:{type:"f",value:1}},vertexShader:zb.stw_vert_proj,fragmentShader:zb.stw_frag_proj_gopro}},worldToScreen:{rectilinear:{mapping:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_rectilinear,fragmentShader:zb.wts_frag},Xg:{uniforms:{tColor:{type:"c",value:null},tProjectionScale:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_rectilinear_wireframe,
fragmentShader:zb.wts_frag_wireframe},equirectangular:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_rectilinear_equirectangular,fragmentShader:zb.wts_frag_equirectangular}},littlePlanet:{equirectangular:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",
value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_littleplanet_equirectangular,fragmentShader:zb.wts_frag_equirectangular}},gopro:{mapping:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_gopro,fragmentShader:zb.wts_frag},Xg:{uniforms:{tColor:{type:"c",value:null},tProjectionScale:{type:"f",value:1},
tProjectionDistance:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_gopro_wireframe,fragmentShader:zb.wts_frag_wireframe},equirectangular:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:zb.wts_vert_gopro_equirectangular,fragmentShader:zb.wts_frag_equirectangular}}},
bb:function(a){return a.replace(/#include +<([\w\d.]+)>/g,function(a,d){a=zb[d];if("undefined"===typeof a&&(a=THREE.ShaderChunk[d],"undefined"===typeof a))throw Error("Can not resolve #include <"+d+">");return wb.bb(a)})}},Oa={Yc:"undefined",pb:"rectilinear",ic:"gopro"};function Ab(a,b,d,e){this.i=a;this.c=b;this.f=1;this.m=e;l.call(this,d||"ViewBase")}Ab.prototype=Object.create(l.prototype);g=Ab.prototype;g.constructor=Ab;g.Lc=wb.screenToWorld.rectilinear;g.Gb=wb.worldToScreen.rectilinear;g.xc=function(){};
g.tc=function(a){this.log(a);throw"Please implement "+this.Ua+"::updateUniforms";};g.worldToScreen=function(a,b){this.log(a);this.log(b);throw"Please implement "+this.Ua+"::worldToScreen";};g.screenToWorld=function(a){this.log(a);throw"Please implement "+this.Ua+"::screenToWorld";};g.me=function(){return G.da(this.i.renderer.camera.fov)};g.destroy=function(){this.c=this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Ab.prototype,"type",{get:function(){return this.m}});
Object.defineProperty(Ab.prototype,"fovMin",{get:function(){return this.c.fovMin}});Object.defineProperty(Ab.prototype,"fovMax",{get:function(){return this.c.fovMax}});function ab(a,b){this.j=0;Ab.call(this,a,b,"ViewGoPro",Oa.ic);this.xc()}ab.prototype=Object.create(Ab.prototype);g=ab.prototype;g.constructor=ab;g.Lc=wb.screenToWorld.gopro;g.Gb=wb.worldToScreen.gopro;g.xc=function(){Ab.prototype.xc.call(this);this.c.fovMin=30;this.c.fovMax=330};
function Bb(a){var b,d=G.X(a.c.fov,a.c.fovMin,a.c.fovMax);b=90>d?0:180<d?1:.5*(1+Math.sin(Math.PI/2*((d-90)/90*2-1)));a.j=b;d=.5*G.da(d);a.f=(b+1)*Math.sin(d)/(b+Math.cos(d))}g.tc=function(a){Bb(this);a.tProjectionDistance.value=this.j;a.tProjectionScale.value=this.f};g.me=function(){Bb(this);var a=.5*G.da(this.c.fov),b=1-this.j/2;return 2*Math.atan2(b*Math.sin(a),Math.abs(b-1)+b*Math.cos(a))};function $a(a,b){Ab.call(this,a,b,"ViewRectilinear",Oa.pb);this.xc()}$a.prototype=Object.create(Ab.prototype);
g=$a.prototype;g.constructor=$a;g.Lc=wb.screenToWorld.rectilinear;g.Gb=wb.worldToScreen.rectilinear;g.xc=function(){Ab.prototype.xc.call(this);this.c.fovMin=40;this.c.fovMax=140};g.tc=function(a){this.f=Math.tan(G.da(G.X(this.c.fov,this.c.fovMin,this.c.fovMax)/2));a.tProjectionScale.value=this.f};
g.worldToScreen=function(a,b){b=b||0;a=new THREE.Vector4(a.x,a.y,a.z,1);var d=G.Dg(this.c.modelView),d=G.de(d.yaw,d.pitch,d.roll,!0),d=d.transpose();a.applyMatrix4(d);if(0>a.z)return new THREE.Vector2(Infinity,Infinity);d=Math.max(Number.EPSILON,a.z);a=(new THREE.Vector2(a.x,a.y)).divideScalar(d);a.x/=(1+b)*this.f;a.y/=this.f;b=this.i.renderer.displayResolution;a.x=b.width/2*(a.x/b.ratio+1);a.y=b.height/2*(a.y/b.ratio+1);return new THREE.Vector2(Math.round(a.x),b.height-Math.round(a.y))};
g.screenToWorld=function(a){var b=this.i.renderer.displayResolution;a=new THREE.Vector2(2*(a.x/b.width-1)*b.ratio,2*(a.y/b.height-1)*b.ratio);a.multiplyScalar(this.f);a=(new THREE.Vector4(a.x,a.y,-1,0)).applyMatrix4(this.c.modelViewInverse).normalize();return new THREE.Vector3(a.x,a.y,a.z)};function Cb(a){this.c=a||[];l.call(this,"Timeline");B.Fa(this.c,"Keyframe")?this.c=B.ud(this.c,"time"):this.c=[]}Cb.prototype=Object.create(l.prototype);g=Cb.prototype;g.constructor=Cb;
g.Kn=function(){return null!==this.c&&0<this.c.length};g.kb=function(a){B.T(a,"Keyframe")&&(this.c.push(a),this.c=B.ud(this.c,"time"))};g.Fn=function(a){a=this.ke(a);return{previous:this.c[a.previous],next:this.c[a.next]||null}};g.ke=function(a){for(var b=-1,d=-1,e=this.c.length-1;0<=e;e--)if(a>=this.c[e].time){b=e;break}b!==this.c.length-1&&(d=b+1);return{previous:b,next:d}};g.Oj=function(a){a=this.Pj(a);return{previous:this.c[a.previous]||null,next:this.c[a.next]||null}};
g.Pj=function(a){a=this.ke(a);var b=0,d=a.next;0<a.previous&&(b=a.previous-1);a.next<this.c.length-2&&(d=a.next+1);return{previous:b,next:d}};g.zn=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=[]};g.destroy=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(Cb.prototype,"keyframes",{get:function(){return this.c},set:function(a){B.Fa(a,"Keyframe")&&(this.c=B.ud(a,"time"))}});
function Db(a,b){l.call(this,"Keyframe");this.c=a;this.gb=b}Db.prototype=Object.create(l.prototype);Db.prototype.constructor=Db;Object.defineProperty(Db.prototype,"time",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(Db.prototype,"data",{get:function(){return this.gb},set:function(a){this.gb=a}});
function Eb(a,b){this.i=a;this.la=b||null;this.u=this.C=this.m=this.Ha=null;this.L=this.F=0;this.R=!1;this.f=null;this.O=0;this.U=!1;this.A=this.G=this.H=this.B=this.P=this.S=null;l.call(this,"Animation");this.Le()}Eb.prototype=Object.create(l.prototype);g=Eb.prototype;g.constructor=Eb;g.Le=function(){this.f=new Fb(this.i,this);this.f.onStart.add(this.an,this);this.f.onStop.add(this.bn,this);this.f.onProgress.add(this.Jk,this);this.f.onComplete.add(this.$m,this);this.i.tween.add(this.f);this.m=new Cb};
function Gb(a,b){a=a.split(".");for(var d=0,e=a.length;d<e-1;d++)b=b[a[d]];return[b,a[d]]}
function Hb(a,b){b=b||a.F;var d=a.m.ke(b||a.F);a.u=a.m.keyframes[d.next];a.C=a.m.keyframes[d.previous];if(null===a.u||-1===d.next)return!1;if(a.U){var e=a.m.Oj(b);if(null!==e.previous&&null!==e.next){b=(new THREE.Quaternion).copy(a.C.data.quaternion).normalize();var d=(new THREE.Quaternion).copy(a.u.data.quaternion).normalize(),h=(new THREE.Quaternion).copy(e.previous.data.quaternion).normalize(),e=(new THREE.Quaternion).copy(e.next.data.quaternion).normalize();a.S=H.Kg(h,b,d);a.P=H.Kg(b,d,e)}}a.L=
a.u.time-a.C.time;a.f.bf({tweenTime:1},a.L);a.O=0;a.f.start();return!0}g.an=function(){!0!==this.R&&(null!==this.B&&this.B.D(),this.R=!0)};g.bn=function(){this.R=!1;null!==this.H&&this.H.D()};
g.Jk=function(){var a=this.O;if(null!==this.u){this.F=a*this.L+this.C.time;var b=[],d,e,h;Array.isArray(this.Ha.prop)||(this.Ha.prop=[this.Ha.prop]);h=this.Ha.prop.length;for(e=0;e<h;e++)b.push(Gb(this.Ha.prop[e],this.la));if(!0===this.Ha.smooth&&"quaternion"===this.Ha.prop[0])d=b[0],d[0].quaternion=H.zk(this.C.data.quaternion,this.S,this.P,this.u.data.quaternion,a);else if("quaternion"===this.Ha.prop[0])d=b[0],d[0].quaternion=H.slerp(this.C.data.quaternion,this.u.data.quaternion,a);else{var k=this.f.easing(a),
n,v,y=0;for(e=0;e<h;e++){n=Gb(this.Ha.prop[e],this.C.data);v=Gb(this.Ha.prop[e],this.u.data);d=b[e];n=n[0][n[1]];v=v[0][v[1]];if(this.Ha.Ta&&this.Ha.Ta[e]){var D=this.Ha.Ta[e][0],db=this.Ha.Ta[e][1],y=Math.abs(D-db)/2;Math.abs(n-v)>y?(n=G.Ta(n+y,D,db),v=G.Ta(v+y,D,db)):y=0}d[0][d[1]]=(1-k)*n+k*v-y}}"function"===typeof this.Ha.Gj&&this.Ha.Gj.call(this,a)}null!==this.G&&this.G.D({progress:this.F/this.L})};g.$m=function(){Hb(this)||null!==this.A&&this.A.D()};
g.play=function(){this.F=0;this.C=this.m.keyframes[0];this.u=this.m.keyframes[1];Hb(this,0)};g.stop=function(){this.f.stop()};g.resume=function(){Hb(this)};g.destroy=function(){null!==this.m&&(this.m.destroy(),this.m=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.H&&(this.H.destroy(),this.H=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};
Object.defineProperty(Eb.prototype,"timeline",{get:function(){return this.m}});Object.defineProperty(Eb.prototype,"instruction",{get:function(){return this.Ha},set:function(a){this.Ha=a}});Object.defineProperty(Eb.prototype,"tween",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(Eb.prototype,"tweenTime",{get:function(){return this.O},set:function(a){this.O=a}});Object.defineProperty(Eb.prototype,"smooth",{get:function(){return this.U},set:function(a){this.U=a}});
Object.defineProperty(Eb.prototype,"onPlay",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(Eb.prototype,"onStop",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(Eb.prototype,"onProgress",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(Eb.prototype,"onComplete",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
function Ib(a,b,d){this.i=a;this.la=b||null;this.c=null;this.B=0;this.o=this.j=null;l.call(this,d)}Ib.prototype=Object.create(l.prototype);Ib.prototype.constructor=Ib;Ib.prototype.stop=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].stop()};Ib.prototype.resume=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].resume()};Ib.prototype.Vb=function(){this.B++;this.B===this.c.length&&null!==this.o&&this.o.D()};
function Jb(a,b,d,e,h,k){var n=null,v=null;d=B.ud(d,"time");for(var y=0;y<d.length;y++){var D="string"===typeof k?d[y].data[k][e]:d[y].data[e];if("undefined"!==typeof D&&null!==D&&(d[y].time<b&&(n=d[y]),d[y].time>b)){v=d[y];break}}null===n&&(n={time:0,data:{}},"string"===typeof k?n.data[k]=a.la[k]:n.data[e]=a.la[e]);if(null===v)return"string"===typeof k?n.data[k][e]:n.data[e];a=h((b-n.time)/(v.time-n.time));return(1-a)*("string"===typeof k?n.data[k][e]:n.data[e])+a*("string"===typeof k?v.data[k][e]:
v.data[e])}function Kb(a){for(var b;a.c&&0<a.c.length;)b=a.c.pop(),b.onComplete.remove(a.Vb,a),b.destroy();a.c=[];a.B=0}Object.defineProperty(Ib.prototype,"onComplete",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});function Lb(a){this.c=this.A=this.B=null;this.u=0;this.f=null;this.m=0;l.call(this,a)}Lb.prototype=Object.create(l.prototype);Lb.prototype.constructor=Lb;
Lb.prototype.j=function(a){this.N=a.uid;this.B=a.name;this.A=a.description;this.c=a.keyframes;this.f="linear";this.m=0;"object"===typeof a.easing&&null!==a.easing&&(this.f=a.easing["default"]||this.f,this.m=a.easing.offset||this.m);ba(this)};Lb.prototype.destroy=function(){da(this)};Object.defineProperty(Lb.prototype,"name",{get:function(){return this.B}});Object.defineProperty(Lb.prototype,"description",{get:function(){return this.A}});Object.defineProperty(Lb.prototype,"keyframes",{get:function(){return this.c}});
Object.defineProperty(Lb.prototype,"count",{set:function(a){"number"===typeof a&&(this.u=a)},get:function(){return this.u}});Object.defineProperty(Lb.prototype,"easing",{get:function(){return this.f}});Object.defineProperty(Lb.prototype,"offset",{get:function(){return this.m}});Object.defineProperty(Lb.prototype,"duration",{get:function(){for(var a,b=0,d=this.c.length;b<d;b++)this.c[b].time>a&&(a=this.c[b].time);return a}});
function Mb(a,b){this.i=a;this.c=null;this.ba="";this.J=this.L=!0;this.u=null;this.I=this.P=!1;this.H=this.B=this.G=this.C=null;l.call(this,b||"Object3D");this.Ve()}Mb.prototype=Object.create(l.prototype);g=Mb.prototype;g.constructor=Mb;g.Ve=function(){this.u={};this.c=new THREE.Mesh;this.i.renderer.objects.register(this)};g.click=function(){this.log("click "+this.c.id);!0===B.T(this.u.onClick,"ActionEventDispatcher")&&this.u.onClick.D();null!==this.C&&this.C.D()};
g.hc=function(){this.log("over "+this.c.id);!0===B.T(this.u.onOver,"ActionEventDispatcher")&&this.u.onOver.D();null!==this.G&&this.G.D()};g.wc=function(){this.log("out "+this.c.id);!0===B.T(this.u.onOut,"ActionEventDispatcher")&&this.u.onOut.D();null!==this.B&&this.B.D()};
g.destroy=function(){this.i.renderer.objects.unregister(this);null!==this.c&&(this.c.c=null,null!==this.c.geometry&&(this.c.geometry.dispose(),this.c.geometry=null),this.c=this.c.material=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.H&&(this.H.destroy(),this.H=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Mb.prototype,"mesh",{get:function(){return this.c}});
Object.defineProperty(Mb.prototype,"visible",{get:function(){return this.L},set:function(a){this.L=!!a;null!==this.c&&(this.c.visible=this.L)}});Object.defineProperty(Mb.prototype,"hovered",{get:function(){return this.P},set:function(a){this.P=!!a}});Object.defineProperty(Mb.prototype,"interactive",{get:function(){return this.J},set:function(a){this.J=!!a}});Object.defineProperty(Mb.prototype,"fx",{get:function(){return this.ba}});Object.defineProperty(Mb.prototype,"events",{get:function(){return this.u}});
Object.defineProperty(Mb.prototype,"ready",{get:function(){return this.I}});Object.defineProperty(Mb.prototype,"onClick",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(Mb.prototype,"onOver",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(Mb.prototype,"onOut",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});
Object.defineProperty(Mb.prototype,"onReady",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});function Sa(a){this.i=a;this.c=this.$=null;l.call(this,"ObjectRenderer");this.$=[];this.c=[]}Sa.prototype=Object.create(l.prototype);g=Sa.prototype;g.constructor=Sa;function Nb(a,b){var d=[];return d="undefined"===typeof b||""===b||null===b?a.$.filter(function(a){return"undefined"===typeof a.fx||""===a.fx||null===a.fx}):a.$.filter(function(a){return a.fx===b})}
function Ob(a){var b=Nb(a,null);return B.mj(a.$,b)}function Pb(a){return Ob(a).reduce(function(a,d){0>a.indexOf(d.fx)&&a.push(d.fx);return a},[])}g.register=function(a){this.$.push(a)};g.unregister=function(a){this.$.splice(this.$.indexOf(a),1)};
g.qj=function(){var a=this.i.renderer.camera.main,b=Nb(this,null);if(0<b.length){for(var d=new THREE.Scene,e=0,h=b.length;e<h;e++)d.add(b[e].mesh);h=new bb(this.i,d,a,null);this.c.push(h)}b=Pb(this);d=0;for(e=b.length;d<e;d++){for(var h=b[d],k=Nb(this,h),n=new THREE.Scene,v=0,y=k.length;v<y;v++)n.add(k[v].mesh);h=new bb(this.i,n,a,this.i.postProcessing.je(h));this.c.push(h)}};g.Mj=function(){return this.$.filter(function(a){return!0===a.ready&&!0===a.interactive})};
g.Jj=function(a){for(var b=0,d=this.$.length;b<d;b++)if(this.$[b].mesh===a)return this.$[b];return null};g.We=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};g.destroy=function(){this.We();this.i=this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(Sa.prototype,"all",{get:function(){return this.$}});Object.defineProperty(Sa.prototype,"renderScenes",{get:function(){return this.c}});function Qb(a){this.i=a;this.c=this.f=null;l.call(this,"Raycaster")}Qb.prototype=Object.create(l.prototype);
g=Qb.prototype;g.constructor=Qb;
g.start=function(a){this.log("Raycaster start");null===this.f&&(this.f=new THREE.Raycaster);a===Xa.Xa?(this.log("Raycating start pointer"),!1===this.i.canvas.pointer.onClick.has(this.Qd,this)&&this.i.canvas.pointer.onClick.add(this.Qd,this),!1===this.i.canvas.pointer.onMove.has(this.Rd,this)&&this.i.canvas.pointer.onMove.add(this.Rd,this)):a===Xa.yc&&(this.log("Raycating start gaze"),!1===this.i.renderer.camera.onCameraChange.has(this.Pd,this)&&this.i.renderer.camera.onCameraChange.add(this.Pd,this))};
g.stop=function(){this.log("Raycaster stop");this.i.canvas.pointer.onClick.has(this.Qd,this)&&this.i.canvas.pointer.onClick.remove(this.Qd,this);this.i.canvas.pointer.onMove.has(this.Rd,this)&&this.i.canvas.pointer.onMove.remove(this.Rd,this);this.i.renderer.camera.onCameraChange.has(this.Pd,this)&&this.i.renderer.camera.onCameraChange.remove(this.Pd,this);Rb(this);this.f=null};g.Qd=function(a){a.data.center=a.data.center||{x:a.data.clientX,y:a.data.clientY};Sb(this,"click",a.data.center)};
g.Rd=function(a){a.data.center=a.data.center||{x:a.data.clientX,y:a.data.clientY};Sb(this,"move",a.data.center)};g.Pd=function(){Sb(this,"move")};
function Sb(a,b,d){var e=a.i.renderer.canvasResolution;d=d||{x:e.width/2,y:e.height/2};var h=a.i.renderer.camera,k=(new THREE.Vector2(d.x/e.width,1-d.y/e.height)).multiplyScalar(2).addScalar(-1),e=a.i.renderer.objects.Mj();d=0;for(var n=e.length;d<n;d++)e[d].hovered=!1;d=null;a.f.setFromCamera(k,h.main);h=[];k=0;for(n=e.length;k<n;k++)h.push(e[k].mesh);for(e=a.f.intersectObjects(h);null===d&&0<e.length;){var h=e.shift(),k=h.object,v=h.uv,h=a.i.renderer.objects.Jj(k);if(!1===k.material.transparent)d=
h;else{n=h;k=v;v=null;if(null!==n.mesh&&null!==n.mesh.material&&"undefined"!==typeof n.mesh.material.uniforms.tTexture){var y=n.mesh.material.uniforms.tTexture.value,n=null;null!==y&&null!==y.image&&("img"===y.image.nodeName.toLowerCase()?(n=document.createElement("canvas"),n.width=y.image.width,n.height=y.image.height,n.getContext("2d").drawImage(y.image,0,0)):"canvas"===y.image.nodeName.toLowerCase()&&(n=y.image),null!==n&&(v=n.width,y=n.height,k=4*(Math.floor(y-k.y*y)*v+Math.floor(k.x*v)),n=n.getContext("2d").getImageData(0,
0,v,y).data,v=new Ub(0,0,0,n[k+3])))}else"undefined"!==typeof n.mesh.material.color&&(v=n.mesh.material.color);k=v;if(null===k||k&&10<k.alpha)d=h}}null!==d?"click"===b?a.click():"move"===b&&d!==a.c&&(Rb(a),a.c=d,d.hc(),a.i.renderer.pickingManager.mode===Xa.yc&&a.i.renderer.camera.gaze.start()):Rb(a)}function Rb(a){null!==a.c&&(a.c.wc(),a.c=null,a.i.renderer.pickingManager.mode===Xa.yc&&a.i.renderer.camera.gaze.stop())}g.click=function(){null!==this.c&&this.c.click()};g.Ih=function(){this.c=null};
Object.defineProperty(Qb.prototype,"hoveredObject",{get:function(){return this.c}});
function Vb(a){this.i=a;this.c=this.f=this.la=null;l.call(this,"PickingDrawPass");a=B.clone(this.i.renderer.view.Gb.mapping);a.uniforms.tColor={type:"c",value:new THREE.Color(0)};this.f=new THREE.RawShaderMaterial({fragmentShader:wb.bb(zb.wts_frag_color),vertexShader:wb.bb(a.vertexShader),uniforms:a.uniforms,side:THREE.FrontSide,name:"PickingMaterial"});this.la=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width/3,this.i.renderer.canvasResolution.height/3,{format:THREE.RGBAFormat});
this.la.name="Picking RenderTarget"}Vb.prototype=Object.create(l.prototype);g=Vb.prototype;g.constructor=Vb;function Wb(a){return new THREE.Color(a.id)}
function Xb(a,b){b.data.center=b.data.center||{x:b.data.x,y:b.data.y};var d=new Uint8Array(4);a.i.renderer.webGLRenderer.readRenderTargetPixels(a.la,b.data.center.x/b.data.target.width*a.la.width,(1-b.data.center.y/b.data.target.height)*a.la.height,1,1,d);b=new THREE.Color(d[0],d[1],d[2]);a:{a=a.i.renderer.objects.all;for(var d=0,e=a.length;d<e;d++)if(a[d].mesh.id===((b.r&255)<<16|((b.g&255)<<8)+(b.b&255))){b=a[d];break a}b=null}return b}g.gd=function(a){a=Xb(this,a);null!==a&&a.click()};
g.Xd=function(a){a=Xb(this,a);null===a?null!==this.c&&(this.c.wc(),this.c=null):a!==this.c&&(null!==this.c&&this.c.wc(),a.hc(),this.c=a)};g.start=function(){this.i.canvas.pointer.enabled=!0;!1===this.i.canvas.pointer.onClick.has(this.gd,this)&&this.i.canvas.pointer.onClick.add(this.gd,this);!1===this.i.canvas.pointer.onMove.has(this.Xd,this)&&this.i.canvas.pointer.onMove.add(this.Xd,this)};
g.stop=function(){this.i.canvas.pointer.onClick.has(this.gd,this)&&this.i.canvas.pointer.onClick.remove(this.gd,this);this.i.canvas.pointer.onMove.has(this.Xd,this)&&this.i.canvas.pointer.onMove.remove(this.Xd,this)};g.click=function(){null!==this.c&&this.i.canvas.pointer.onClick.has(this.gd,this)&&this.c.click()};g.setSize=function(a){null!==this.la&&this.la.setSize(a.width,a.height)};g.sh=function(){this.c=null};
g.destroy=function(){null!==this.f&&(this.f.dispose(),this.f=null);null!==this.la&&(this.la.dispose(),this.la=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Vb.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Vb.prototype,"renderTarget",{get:function(){return this.la}});function Qa(a){this.i=a;this.f=this.c=null;this.j=Xa.Xa;l.call(this,"PickingManager")}Qa.prototype=Object.create(l.prototype);Qa.prototype.constructor=Qa;var Xa={Xa:"pointer",yc:"gaze"};
g=Qa.prototype;g.Gk=function(a){a===Oa.pb?null===this.f&&(null!==this.c&&(this.c.stop(),this.c.destroy(),this.c=null),this.f=new Qb(this.i),this.f.start(this.j)):null===this.c&&(null!==this.f&&(this.f.stop(),this.f.destroy(),this.f=null),this.c=new Vb(this.i),this.c.start())};g.th=function(){null!==this.f&&this.f.Ih();null!==this.c&&this.c.sh()};g.setSize=function(a){null!==this.c&&this.c.setSize(a)};g.click=function(){null!==this.f&&this.f.click();null!==this.c&&this.c.click()};
g.start=function(){null!==this.f&&this.f.start(this.j);null!==this.c&&this.c.start()};g.stop=function(){null!==this.f&&this.f.stop();null!==this.c&&this.c.stop()};g.destroy=function(){null!==this.f&&(this.f.stop(),this.f.destroy(),this.f=null);null!==this.c&&(this.c.stop(),this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(Qa.prototype,"renderTarget",{get:function(){return null===this.c?null:this.c.renderTarget}});
Object.defineProperty(Qa.prototype,"material",{get:function(){return null===this.c?null:this.c.material}});Object.defineProperty(Qa.prototype,"mode",{get:function(){return this.j},set:function(a){a!==Xa.Xa&&a!==Xa.yc||a===this.j||(this.j=a,this.start())}});function qa(a){this.i=a;this.c=[];l.call(this,"HotspotManager")}qa.prototype=Object.create(l.prototype);g=qa.prototype;g.constructor=qa;
g.Tk=function(){var a=this.i.story.scene;a.onUnloadStart.fa(this.hn,this);"undefined"!==typeof a.config.hotspots&&this.ja(a.config.hotspots)};g.hn=function(){this.Re()};g.boot=function(){this.i.story.onSceneLoadStart.add(this.Tk,this)};g.En=function(a){return this.c.filter(function(b){return b.type===a})};g.ja=function(a){for(var b=0,d=a.length;b<d;b++){var e=a[b],h=null;switch(e.type||Yb.Ff){case Yb.Ff:h=new Zb(this.i,e)}null!==h&&this.c.push(h)}};
g.ij=function(a){if(null!==a.tracks&&"undefined"!==typeof a.tracks){a=a.tracks;for(var b=0,d=a.length;b<d;b++)new $b(a[b])}};g.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};g.Re=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};g.destroy=function(){this.Re();this.c=this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(qa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(qa.prototype,"count",{get:function(){return this.c}});
function Zb(a,b){this.o=b;this.V="";this.m=this.A=this.F=this.S=this.j=this.f=null;this.M=!1;this.U="pointer";this.O=this.R=null;Mb.call(this,a,"Hotspot3D")}Zb.prototype=Object.create(Mb.prototype);g=Zb.prototype;g.constructor=Zb;
g.Ve=function(){Mb.prototype.Ve.call(this);this.f=new ac;this.A=new bc(this.i,this.f);this.j=new dc(this.i);this.R=this.Sk.bind(this);this.O=this.zm.bind(this);if("undefined"!==typeof this.o&&null!==this.o){var a=this.o;this.N=a.uid;this.Wa=a.tags;ba(this);this.c.name="mesh-"+this.N;this.V="string"===typeof a.name?a.name:"";this.L="boolean"===typeof a.visible?a.visible:!0;this.M="boolean"===typeof a.facingCenter?a.facingCenter:!1;this.J="boolean"===typeof a.interactive?a.interactive:!0;this.U="string"===
typeof a.cursor?a.cursor:"pointer";this.m=new ec(this.i,this.N);"object"===typeof a.states&&null!==a.states&&this.m.ja(a.states);"object"===typeof a.transform&&null!==a.transform&&this.f.load(a.transform);"object"===typeof a.animation&&null!==a.animation&&(this.A.load(a.animation),this.A.onProgress.add(this.cj,this));var b;"object"===typeof a.material&&null!==a.material?b=a.material:b=fc.ti;!0===this.bd&&B.Za(b,fc.ci);this.j.onReady.add(this.Gi,this);"object"===typeof a.sound&&null!==a.sound&&(this.F=
new gc(this.i),this.F.load(a.sound,a.transform));"string"===typeof a.fx&&""!==a.fx&&(this.ba=a.fx);if("object"===typeof a.events&&null!==a.events){var a=a.events,d;for(d in a)b=new hc(this.i),b.c(a[d]),this.u[d]=b}this.m.load()}};
g.Sk=function(a,b,d,e,h,k){this.log(k);a=this.i.renderer.webGLRenderer.getContext();this.i.renderer.view.tc(h.uniforms);"HotspotMaterial"===h.name?this.j.type===ic.Fd?h.uniforms.tColor.value=new THREE.Color(this.j.color):h.uniforms.tTexture.value=this.j.c:"PickingMaterial"===h.name&&h.program&&(b=this.S,a.useProgram(h.program.program),h.program.getUniforms().map.tColor.setValue(a,b),h.uniforms.tColor.value=b)};g.zm=function(){};
g.Gi=function(){this.c.material=this.j.material;if("undefined"!==typeof this.o.geometry&&"string"===typeof this.o.geometry.type){var a=this.o.geometry.options;switch(this.o.geometry.type){case jc.ai:var b=this.c,a=a||{},a=new THREE.BoxBufferGeometry(a.width||100,a.height||100,a.depth||100,a.widthSegments||8,a.heightSegments||8,a.depthSegments||8);b.geometry=a;break;case jc.pi:b=this.c;a=a||{};a=new THREE.SphereBufferGeometry(a.radius||10,a.widthSegments||64,a.heightSegments||64,a.phiStart||0,a.phiLength||
2*Math.PI,a.thetaStart||0,a.thetaLength||2*Math.PI);b.geometry=a;break;case jc.bi:b=this.c;a=a||{};a=new THREE.CylinderBufferGeometry(a.radiusTop||10,a.radiusBottom||10,a.height||20,a.radiusSegments||32,a.heightSegments||1,a.openEnded||!1,a.thetaStart||0,a.thetaLength||2*Math.PI);b.geometry=a;break;case jc.mi:this.c.geometry=kc(a);break;default:this.c.geometry=kc()}}else this.c.geometry=kc();this.c.geometry.scale(this.f.scale.x,this.f.scale.y,this.f.scale.z);this.c.material=this.j.material;this.c.c=
this.o;this.c.f=this.i.renderer.view instanceof $a;this.cj();this.I=lc(this);null!==this.H&&this.H.D();this.S=Wb(this.c);this.c.onBeforeRender=this.R;this.c.onAfterRender=this.O;!0===this.A.autoPlay&&this.A.play()};
g.cj=function(){this.c.position.x=this.f.position.x;this.c.position.y=this.f.position.y;this.c.position.z=this.f.position.z;if(!0===this.M){var a=(new THREE.Spherical).setFromVector3(new THREE.Vector3(this.f.position.x,this.f.position.y,this.f.position.z));this.c.rotation.set(-a.phi+Math.PI/2,a.theta+Math.PI,0,"YXZ");this.c.rotation.x+=-G.da(this.f.rotation.x);this.c.rotation.y+=G.da(this.f.rotation.y);this.c.rotation.z+=G.da(this.f.rotation.z)}else this.c.rotation.set(-G.da(this.f.rotation.x),G.da(this.f.rotation.y),
G.da(this.f.rotation.z),"YXZ");this.c.scale.x=G.X(this.f.scale.x,1E-6,1E5);this.c.scale.y=G.X(this.f.scale.y,1E-6,1E5);this.c.scale.z=G.X(this.f.scale.z,1E-6,1E5)};function lc(a){return null!==a.c.geometry.index&&!0===a.j.ready}g.hc=function(){!0===this.m.auto&&this.m.load("over");this.i.canvas.pointer.cursor=this.U;Mb.prototype.hc.call(this)};g.wc=function(){!0===this.m.auto&&this.m.load();this.i.canvas.pointer.cursor="default";Mb.prototype.hc.call(this)};
g.update=function(){null!==this.j&&this.j.update();null!==this.F&&this.F.update()};g.destroy=function(){this.j.onReady.remove(this.Gi,this);this.O=this.R=null;null!==this.f&&(this.f.destroy(),this.f=null);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.F&&(this.F.destroy(),this.F=null);Mb.prototype.destroy.call(this)};Object.defineProperty(Zb.prototype,"config",{get:function(){return this.o}});Object.defineProperty(Zb.prototype,"name",{get:function(){return this.V}});
Object.defineProperty(Zb.prototype,"animation",{get:function(){return this.A}});Object.defineProperty(Zb.prototype,"material",{get:function(){return this.j}});Object.defineProperty(Zb.prototype,"transform",{get:function(){return this.f}});Object.defineProperty(Zb.prototype,"ready",{get:function(){return this.I=lc(this)}});Object.defineProperty(Zb.prototype,"states",{get:function(){return this.m}});Object.defineProperty(Zb.prototype,"state",{get:function(){return this.m.state},set:function(a){this.m.load(a)}});
function gc(a){this.i=a;this.c=this.u=this.f=null;this.B=0;this.A=1;this.G=!1;this.H=0;this.C=!1;this.m={x:0,y:0,z:200};this.o=360;l.call(this,"HotspotSound")}gc.prototype=Object.create(l.prototype);g=gc.prototype;g.constructor=gc;g.Uk=function(){this.log("Sound load complete");null!==this.f&&this.f.D()};
g.load=function(a,b){if("undefined"!==typeof a.source&&"object"===typeof a.source)if(this.N=a.uid,"undefined"!==typeof a.source.url&&"string"===typeof a.source.url&&""!==a.source.url){this.j=a.source.url;if("undefined"!==typeof a.options&&"object"===typeof a.options){if("number"===typeof a.options.volume)this.A=a.options.volume;else if("object"===typeof a.options.volume){var d=a.options.volume;this.B="number"===typeof d.min?G.X(d.min,0,1):0;this.A="number"===typeof d.max?G.X(d.max,0,1):1}this.G="boolean"===
typeof a.options.loop?a.options.loop:!1;this.H="number"===typeof a.options.startTime?a.options.startTime:0;this.C="boolean"===typeof a.options.autoPlay?a.options.autoPlay:!1;this.o="number"===typeof a.options.range?G.X(a.options.range,1,360):360}"undefined"!==typeof b&&"undefined"!==typeof b.position&&(this.m.theta="number"===typeof b.position.theta?G.X(b.position.theta,-180,180):0,this.m.phi="number"===typeof b.position.phi?G.X(b.position.phi,-90,90):0);this.c=new M(this.i,this.N,this.j||"");this.c.onCanPlayThrough.fa(this.Uk,
this);!0===360>this.o&&(a=B.Fe(1,G.da(-this.m.theta),G.da(this.m.phi)),this.u=(new THREE.Vector3).setFromSpherical(a),this.c.spatialized=360>this.o,this.c.x=this.u.x,this.c.y=this.u.y,this.c.z=this.u.z);this.c.volume=this.A;this.c.loop=this.G;this.c.startTime=this.H;!0===this.C&&this.c.play(this.H,this.G,!0)}else"undefined"!==typeof a.source.target&&!0===p.Sa(a.source.target)&&p.get(a.source.target)};
g.update=function(){if(!1===this.i.audio.enabled)null!==this.c&&this.c.stop();else if(!0===360>this.o&&!0===360>this.o&&"number"===typeof this.o){var a=this.i.renderer.camera,a=H.nc(G.da(a.yaw),G.da(a.pitch),0),b=H.nc(G.da(this.m.theta),G.da(this.m.phi),0),a=H.lj(b,a),b=G.da(this.o/2);this.c.volume=a<b?this.B+(this.A-this.B)*(1-a/b):this.B}};g.destroy=function(){null!==this.c&&(this.c.destroy(),this.c=null);this.m=this.u=null;null!==this.f&&this.f.destroy();l.prototype.destroy.call(this)};
Object.defineProperty(gc.prototype,"sound",{get:function(){return this.c}});Object.defineProperty(gc.prototype,"onReady",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});function dc(a){this.i=a;this.u=null;this.m="";this.f=this.B=this.c=null;this.o=1;this.G=!1;this.C=16777215;this.K=null;this.A=this.H=!1;this.j=null;l.call(this,"HotspotMaterial")}dc.prototype=Object.create(l.prototype);dc.prototype.constructor=dc;
var ic={IMAGE:"image",ni:"plugin",Fd:"graphics"},fc={ti:{color:"#ffffff",opacity:0,transparent:!1},ci:{color:"#00ff00",opacity:.8,transparent:!1}};g=dc.prototype;g.nm=function(a){a=a.emitter;this.log("Texture load complete (Image) : "+a.element.src);this.K=a;this.Ig(a.frame);this.c.image.crossOrigin="anonymous";this.log("Map new texture from image");this.Sc()};g.Pi=function(a){a=a.data;a.uid===this.u.plugin&&(this.i.plugins.onInstanceCreate.remove(this.Pi,this),mc(this,a))};
function mc(a,b){!0===b.instanceReady?nc(a,b):b.onInstanceReady.fa(a.dn,a)}g.dn=function(a){a=a.emitter;if(null===a.instance||!1===a.instanceReady)throw Error("Plugin instance not available");nc(this,a)};function nc(a,b){a.K=b.instance.texture;a.c=new THREE.Texture(a.K.dom);a.c.format=THREE.RGBAFormat;a.c.minFilter=THREE.LinearFilter;a.c.generateMipmaps=!1;a.c.needsUpdate=!0;a.log("Map new texture from plugin");a.Sc()}
g.Sc=function(){if(!0===this.i.renderer.viewReady){null!==this.f&&(this.f.dispose(),this.f=null);var a=B.clone(this.i.renderer.view.Gb.mapping);this.m===ic.Fd&&(a.fragmentShader=zb.wts_frag_color,a.uniforms.tColor={type:"c",value:new THREE.Color(2105376)});a.uniforms.tOpacity={type:"f",value:this.o};var b=wb.bb(a.vertexShader),d=wb.bb(a.fragmentShader);this.f=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,side:THREE.DoubleSide,name:"HotspotMaterial"});null!==this.c&&
(this.f.transparent=this.G,this.f.needsUpdate=!0);this.A=!0;null!==this.j&&this.j.D()}this.i.renderer.onViewReady.add(this.Sc,this)};
g.load=function(a){this.u=a;this.A=!1;a=this.u;this.o="number"===typeof a.opacity?G.X(a.opacity,0,1):1;this.G="boolean"===typeof a.transparent?a.transparent:!1;this.C="string"===typeof a.color?a.color:16777215;this.H="boolean"===typeof a.update?a.update:!1;"undefined"!==typeof a.image&&null!==a.image?(a=a.image,this.m=ic.IMAGE,"string"===typeof a&&(a={url:a}),a.tk=oc.Lb,this.K=new Ma(this.i,a),this.K.onLoadComplete.fa(this.nm,this)):"undefined"!==typeof a.plugin&&null!==a.plugin?(a=a.plugin,this.m=
ic.ni,a=this.i.plugins.get(a),"undefined"===typeof a||null===a?this.i.plugins.onInstanceCreate.add(this.Pi,this):mc(this,a)):(this.m=ic.Fd,this.Sc())};g.update=function(){this.f&&this.f.uniforms&&(this.f.uniforms.tTexture.value=this.c,this.f.uniforms.tOpacity.value=this.o);null!==this.c&&!0===this.H&&(this.c.needsUpdate=!0)};g.eo=function(a){null!==this.K&&(this.K.destroy(),this.K=null);this.K=a;this.Ig()};
g.Ig=function(a){null!==this.K&&this.m===ic.IMAGE&&(this.B=a||new Ha(0,0,this.K.element.naturalWidth,this.K.element.naturalHeight),this.K.frame=this.B,this.c=new THREE.CanvasTexture(this.K.canvas),this.c.needsUpdate=this.H,this.update())};
g.destroy=function(){this.i.renderer.onViewReady.remove(this.Sc,this);this.B=null;null!==this.c&&(this.c.dispose(),this.c=null);null!==this.f&&(this.f.dispose(),this.f=null);this.m===ic.IMAGE&&null!==this.K&&this.K.destroy();this.K=null;null!==this.j&&(this.j.destroy(),this.j=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(dc.prototype,"type",{get:function(){return this.m}});Object.defineProperty(dc.prototype,"texture",{get:function(){return this.c}});
Object.defineProperty(dc.prototype,"material",{get:function(){return this.f}});Object.defineProperty(dc.prototype,"opacity",{get:function(){return this.o}});Object.defineProperty(dc.prototype,"transparent",{get:function(){return this.G}});Object.defineProperty(dc.prototype,"color",{get:function(){return this.C}});Object.defineProperty(dc.prototype,"displayObject",{get:function(){return this.K}});Object.defineProperty(dc.prototype,"ready",{get:function(){return this.A}});
Object.defineProperty(dc.prototype,"onReady",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});function kc(a){a=a||{};return new THREE.PlaneBufferGeometry(a.width||100,a.height||100,a.widthSegments||8,a.heightSegments||8)}var jc={mi:"plane",ai:"box",pi:"sphere",bi:"cylinder"};function ac(a,b,d){this.c=a||{x:0,y:0,z:-200};this.f=b||{x:0,y:0,z:0};this.j=d||{x:1,y:1,z:1};l.call(this,"HotspotTransform")}ac.prototype=Object.create(l.prototype);ac.prototype.constructor=ac;
ac.prototype.load=function(a){if("undefined"!==typeof a.position)if("number"===typeof a.position.x||"number"===typeof a.position.y||"number"===typeof a.position.z)this.c.x="number"===typeof a.position.x?a.position.x:0,this.c.y="number"===typeof a.position.y?a.position.y:0,this.c.z="number"===typeof a.position.z?a.position.z:-200;else{var b="number"===typeof a.position.radius?a.position.radius:200,d="number"===typeof a.position.theta?G.da(a.position.theta):0,e="number"===typeof a.position.phi?G.da(a.position.phi):
0,d=G.Ta(Math.PI-d,-Math.PI,Math.PI),b=(new THREE.Vector3).setFromSpherical(B.Fe(b,d,e));this.c.x=b.x;this.c.y=b.y;this.c.z=b.z}"undefined"!==typeof a.rotation?(this.f.x="number"===typeof a.rotation.x?a.rotation.x:0,this.f.y="number"===typeof a.rotation.y?a.rotation.y:0,this.f.z="number"===typeof a.rotation.z?a.rotation.z:0):(b={x:0,y:0,z:0},"undefined"!==typeof this.c&&(d=(new THREE.Spherical).setFromVector3(new THREE.Vector3(this.c.x,this.c.y,this.c.z)),b.y=-d.phi+Math.PI/2,b.x=d.theta+Math.PI),
this.f=b);"undefined"!==typeof a.scale&&(this.j.x="number"===typeof a.scale.x?G.X(a.scale.x,1E-6,1E5):1,this.j.y="number"===typeof a.scale.y?G.X(a.scale.y,1E-6,1E5):1,this.j.z="number"===typeof a.scale.z?G.X(a.scale.z,1E-6,1E5):1)};Object.defineProperty(ac.prototype,"position",{get:function(){return this.c}});Object.defineProperty(ac.prototype,"rotation",{get:function(){return this.f}});Object.defineProperty(ac.prototype,"scale",{get:function(){return this.j}});
function bc(a,b){this.f=this.A=null;this.G=this.u=this.H=!1;this.m=null;Ib.call(this,a,b,"HotspotAnimation");this.j=[{prop:["rotation.x","rotation.y","rotation.z"],Ta:[[-180,180],[-180,180],[-180,180]],smooth:!1},{prop:["position.x","position.y","position.z"],smooth:!1},{prop:["scale.x","scale.y","scale.z"],smooth:!1}]}bc.prototype=Object.create(Ib.prototype);g=bc.prototype;g.constructor=bc;
g.load=function(a){!0===a.enabled&&(this.H="boolean"===typeof a.loop?a.loop:!1,this.u="boolean"===typeof a.random?a.random:!1,this.G="boolean"===typeof a.autoPlay?a.autoPlay:!1,null!==a.tracks&&B.Fa(a.tracks,"string")&&(this.f=!0===this.u?B.rd(a.tracks):a.tracks))};g.Vb=function(){if(1<this.f.length){var a=this.f.indexOf(this.A)+1;if(a<this.f.length){this.play(a);return}}!0===this.H?(!0===this.u&&(this.f=B.rd(this.f)),this.play(0)):Ib.prototype.Vb.call(this)};g.Qe=function(){null!==this.m&&this.m.D()};
g.play=function(a){this.A="number"===typeof a?this.f[a]:"string"===typeof a?a:this.f[0];a=p.get(this.A);Kb(this);var b,d=a.offset,e=new Eb(this.i,this.la);e.tween.easing=a.easing;e.instruction=this.j[0];e.instruction.smooth=a.smooth;e.onComplete.add(this.Vb,this);e.onProgress.add(this.Qe,this);for(var h,k,n,v=0,y=a.keyframes.length;v<y;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.rotation,"undefined"!==typeof h&&null!==h&&(k="undefined"!==typeof h.x&&null!==h.x?h.x:Jb(this,b,a.keyframes,"x",
e.tween.easing,"rotation"),n="undefined"!==typeof h.y&&null!==h.y?h.y:Jb(this,b,a.keyframes,"y",e.tween.easing,"rotation"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Jb(this,b,a.keyframes,"z",e.tween.easing,"rotation"),b=new Db(b+d,{rotation:{x:k,y:n,z:h}}),e.timeline.kb(b));if(0<e.timeline.keyframes.length&&0<e.timeline.keyframes[0].time||0<d)v={rotation:B.clone(this.la.rotation)},b=new Db(0,v),e.timeline.kb(b);this.c.push(e);e=new Eb(this.i,this.la);e.tween.easing=a.easing;e.instruction=this.j[1];
e.instruction.smooth=a.smooth;e.onComplete.add(this.Vb,this);e.onProgress.add(this.Qe,this);v=0;for(y=a.keyframes.length;v<y;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.position,"undefined"!==typeof h&&null!==h&&("number"===typeof h.x||"number"===typeof h.y||"number"===typeof h.z||"number"!==typeof h.radius&&"number"!==typeof h.theta&&"number"!==typeof h.phi?(k="undefined"!==typeof h.x&&null!==h.x?h.x:Jb(this,b,a.keyframes,"x",e.tween.easing,"position"),n="undefined"!==typeof h.y&&null!==h.y?
h.y:Jb(this,b,a.keyframes,"y",e.tween.easing,"position"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Jb(this,b,a.keyframes,"z",e.tween.easing,"position")):(k="number"===typeof h.radius?h.radius:Jb(this,b,a.keyframes,"radius",e.tween.easing,"position"),n="number"===typeof h.theta?G.da(h.theta):G.da(Jb(this,b,a.keyframes,"theta",e.tween.easing,"position")),h="number"===typeof h.phi?G.da(h.phi):G.da(Jb(this,b,a.keyframes,"phi",e.tween.easing,"position")),n=G.Ta(Math.PI-n,-Math.PI,Math.PI),h=(new THREE.Vector3).setFromSpherical(B.Fe(k,
n,h)),k=h.x,n=h.y,h=h.z),b=new Db(b+d,{position:{x:k,y:n,z:h}}),e.timeline.kb(b));if(0<e.timeline.keyframes.length&&0<e.timeline.keyframes[0].time||0<d)v={position:B.clone(this.la.position)},b=new Db(0,v),e.timeline.kb(b);this.c.push(e);e=new Eb(this.i,this.la);e.tween.easing=a.easing;e.instruction=this.j[2];e.instruction.smooth=a.smooth;e.onComplete.add(this.Vb,this);e.onProgress.add(this.Qe,this);v=0;for(y=a.keyframes.length;v<y;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.scale,"undefined"!==
typeof h&&null!==h&&(k="undefined"!==typeof h.x&&null!==h.x?h.x:Jb(this,b,a.keyframes,"x",e.tween.easing,"scale"),n="undefined"!==typeof h.y&&null!==h.y?h.y:Jb(this,b,a.keyframes,"y",e.tween.easing,"scale"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Jb(this,b,a.keyframes,"z",e.tween.easing,"scale"),b=new Db(b+d,{scale:{x:k,y:n,z:h}}),e.timeline.kb(b));if(0<e.timeline.keyframes.length&&0<e.timeline.keyframes[0].time||0<d)v={scale:B.clone(this.la.scale)},b=new Db(0,v),e.timeline.kb(b);this.c.push(e);
this.c[0].play();this.c[1].play();this.c[2].play()};Object.defineProperty(bc.prototype,"autoPlay",{get:function(){return this.G}});Object.defineProperty(bc.prototype,"onProgress",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});function $b(a){Lb.call(this,"HotspotAnimationTrack");this.j(a)}$b.prototype=Object.create(Lb.prototype);$b.prototype.constructor=$b;
function ec(a,b){this.i=a;this.o=b;this.c=null;this.m="";this.f="default";this.u=!0;this.j=null;l.call(this,"HotspotStates");a=p.get(this.o);if("undefined"===typeof a)throw"No hotspot match with uid: "+this.o;this.c={options:{},default:a.config}}ec.prototype=Object.create(l.prototype);ec.prototype.constructor=ec;var pc=["options"];
function qc(a){if(null===a.c)return[];for(var b=Object.keys(a.c),d=0,e=pc.length;d<e;d++){var h=b.indexOf(pc[d]);-1!==h&&b.splice(h,1)}"default"!==a.f&&"undefined"!==typeof a.c[a.f]&&(h=b.indexOf("default"),-1!==h&&b.splice(h,1));return b}ec.prototype.ja=function(a){a=this.c=B.mb(this.c,a);this.f="string"===typeof a.options["default"]?a.options["default"]:"default";this.u="boolean"===typeof a.options.auto?a.options.auto:!0;this.c["default"]=B.mb(this.c["default"],a[this.f])};
ec.prototype.load=function(a){a="string"===typeof a?a:this.f;this.log("Hotspot load state: "+a);var b=p.get(this.o);"undefined"!==typeof b&&"object"===typeof this.c[a]&&a!==this.m&&(this.m=a,"object"===typeof this.c[a].material&&(a=B.mb(b.config.material,this.c[a].material),p.get(this.o).material.load(a)),null!==this.j&&this.j.D())};ec.prototype.A=function(a){if(null===a||"undefined"===typeof a||2>a.length)a=qc(this);var b=a.indexOf(this.m),d=0;b<a.length-1&&(d=b+1);this.load(a[d])};
ec.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(ec.prototype,"state",{get:function(){return this.m},set:function(a){this.load(a)}});Object.defineProperty(ec.prototype,"names",{get:function(){return qc(this)}});Object.defineProperty(ec.prototype,"auto",{get:function(){return this.u}});Object.defineProperty(ec.prototype,"onLoadComplete",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});var Yb={Ff:"3d"};
function L(a){this.i=a;this.U=null;this.ba=this.P=this.F=this.V=this.M=this.C=this.S=this.ia=this.I=0;this.L=Math.PI/2;this.H=this.J=this.O=0;this.f=this.j=this.c=this.o=this.G=this.A=null;this.R=0;this.m=this.u=this.B=null;l.call(this,"Camera");this.A=new THREE.Matrix4;this.G=new THREE.Matrix4;this.o=new THREE.Quaternion;this.u=new rc(this.i,sc.gaze);tc(this);this.j=this.c.clone();this.j.name="CameraLeft";this.j.layers.enable(1);this.j.add(this.u.object);this.f=this.c.clone();this.f.name="CameraRight";
this.f.layers.enable(2)}L.prototype=Object.create(l.prototype);L.prototype.constructor=L;var sc={parallax:0,yaw:{default:0},pitch:{default:0,min:-90,max:90},roll:{default:0},fov:{default:90},gaze:{delay:2E3,cursor:{innerRadius:.02,outerRadius:.04,color:16777215,opacity:.5},progress:{innerRadius:.02,outerRadius:.04,color:16711680,opacity:.5}}};
function tc(a){"undefined"!==typeof a.i.renderer&&(a.c=new THREE.PerspectiveCamera(a.L,a.i.renderer.displayResolution.ratio,.01,2E4),a.c.name="CameraMain",a.c.matrixAutoUpdate=!1)}
function uc(a,b){var d=Math.tan(G.da(a.upDegrees)),e=Math.tan(G.da(a.downDegrees)),h=Math.tan(G.da(a.leftDegrees)),k=Math.tan(G.da(a.rightDegrees));a=2/(h+k);var h=(h-k)*a*.5,k=2/(d+e),d=(d-e)*k*.5,e=new THREE.Matrix4,n=e.elements;n[0]=a;n[1]=0;n[2]=-h;n[3]=0;n[4]=0;n[5]=k;n[6]=d;n[7]=0;n[8]=0;n[9]=0;n[10]=b.far/(b.near-b.far);n[11]=b.far*b.near/(b.near-b.far);n[12]=0;n[13]=0;n[14]=-1;n[15]=0;e.transpose();return e}
function vc(a){a.A=G.de(a.I,a.C,a.F,!1);a.G=a.A.clone().transpose();a.o=H.nc(a.I,a.C,a.F)}function wc(a){a.A=H.Bk(a.o);a.G=a.A.clone().transpose();var b=H.Ee(a.o),d=b.pitch,e=b.roll,h=G.ob;xc(a,b.yaw,h);yc(a,d,h);zc(a,e,h);Ac(a,null,h)}function Bc(a){null!==a.m&&a.m.D(null,!0)}function xc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.La||d===G.ob?d:G.ob;b=d===G.La?G.da(b):b;b=G.Ta(b,-Math.PI,Math.PI);b=G.X(b,a.ia,a.S);d=a.I!==b;a.I=b;return d}
function yc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.La||d===G.ob?d:G.ob;b=d===G.La?G.da(b):b;b=G.Ta(b,-Math.PI,Math.PI);b=G.X(b,a.M,a.V);d=a.C!==b;a.C=b;return d}function zc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.La||d===G.ob?d:G.ob;b=d===G.La?G.da(b):b;b=G.Ta(b,-Math.PI,Math.PI);b=G.X(b,a.P,a.ba);d=a.F!==b;a.F=b;return d}
function Ac(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.La||d===G.ob?d:G.ob;b=d===G.La?G.da(b):b;b=G.X(b,a.O,a.J);d=a.L!==b;a.L=b;return d}
L.prototype.load=function(a){a=this.U=B.Za(sc,a);this.H=a.parallax;this.R=50*this.H;this.ia=G.da(a.yaw.min);this.S=G.da(a.yaw.max);xc(this,a.yaw["default"],G.La);this.M=G.da(a.pitch.min);this.V=G.da(a.pitch.max);yc(this,a.pitch["default"],G.La);this.P=G.da(a.roll.min);this.ba=G.da(a.roll.max);zc(this,a.roll["default"],G.La);"undefined"!==typeof a.fov.min&&(this.O=G.da(a.fov.min));"undefined"!==typeof a.fov.max&&(this.J=G.da(a.fov.max));Ac(this,a.fov["default"],G.La);vc(this);Bc(this);this.u.load(a.gaze)};
L.prototype.ik=function(a,b,d,e,h,k,n){"number"===typeof h&&h?(a=new Cc({easing:{default:n||"LINEAR",start:0},keyframes:[{time:h,data:{yaw:a,pitch:b,roll:d,fov:e}}]}),this.animation.play(a.uid)):(h=G.La,xc(this,a,h),yc(this,b,h),zc(this,d,h),Ac(this,e,h),vc(this),Bc(this))};
L.prototype.update=function(){if(!0===this.i.renderer.display.presentingVR){this.u.update();var a=this.i.renderer.display,b=a.vrFrameData,d=a.Lj();null!==d&&(this.o=d,wc(this));d=a.vrDisplay.getEyeParameters("left");a=a.vrDisplay.getEyeParameters("right");this.c.matrixWorld.decompose(this.j.position,this.j.quaternion,this.j.scale);this.j.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.c.matrixWorld.decompose(this.f.position,this.f.quaternion,this.f.scale);this.f.matrixWorld=
(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.j.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+d.offset[0];this.j.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+d.offset[1];this.j.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+d.offset[2];this.f.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+a.offset[0];this.f.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+a.offset[1];this.f.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+
a.offset[2];null!==b?(this.j.projectionMatrix.elements=b.leftProjectionMatrix,this.f.projectionMatrix.elements=b.rightProjectionMatrix):(this.j.projectionMatrix=uc({upDegrees:d.fieldOfView.upDegrees,downDegrees:d.fieldOfView.downDegrees,leftDegrees:d.fieldOfView.leftDegrees,rightDegrees:d.fieldOfView.rightDegrees},this.c),this.f.projectionMatrix=uc({upDegrees:a.fieldOfView.upDegrees,downDegrees:a.fieldOfView.downDegrees,leftDegrees:a.fieldOfView.leftDegrees,rightDegrees:a.fieldOfView.rightDegrees},
this.c));Bc(this);b=0;for(a=this.f.children.length;b<a;b++)this.f.remove(this.f.children[b]);a=0;for(d=this.j.children.length;a<d;a++)b=this.j.children[a].clone(),this.f.add(b)}null!==this.c&&null!==this.i.renderer.view&&(b=(new THREE.Matrix4).copy(this.G),this.H&&b.multiply((new THREE.Matrix4).makeTranslation(0,0,-this.R)),this.c.quaternion.setFromRotationMatrix(b),this.c.matrixWorld=b,this.c.matrixWorldInverse.getInverse(b),this.c.fov=G.dc(this.i.renderer.view.me()),this.c.aspect=this.i.renderer.displayResolution.ratio,
this.c.updateProjectionMatrix())};L.prototype.destroy=function(){this.c=this.o=this.G=this.A=null;this.u.destroy();this.u=null;null!==this.m&&(this.m.destroy(),this.m=null);null!==this.B&&(this.B.destroy(),this.B=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(L.prototype,"config",{get:function(){return this.U},set:function(a){this.load(a)}});Object.defineProperty(L.prototype,"yaw",{get:function(){return G.dc(this.I)},set:function(a){!0===xc(this,a,G.La)&&(vc(this),Bc(this))}});
Object.defineProperty(L.prototype,"pitch",{get:function(){return G.dc(this.C)},set:function(a){yc(this,a,G.La)&&(vc(this),Bc(this))}});Object.defineProperty(L.prototype,"roll",{get:function(){return G.dc(this.F)},set:function(a){!0===zc(this,a,G.La)&&(vc(this),Bc(this))}});Object.defineProperty(L.prototype,"fov",{get:function(){return G.dc(this.L)},set:function(a){!0===Ac(this,a,G.La)&&Bc(this)}});
Object.defineProperty(L.prototype,"fovMin",{get:function(){return G.dc(this.O)},set:function(a){this.O=G.da(a)}});Object.defineProperty(L.prototype,"fovMax",{get:function(){return G.dc(this.J)},set:function(a){this.J=G.da(a)}});Object.defineProperty(L.prototype,"quaternion",{get:function(){return this.o},set:function(a){this.o=a;wc(this);Bc(this)}});Object.defineProperty(L.prototype,"animation",{get:function(){null===this.B&&(this.B=new Dc(this.i,this));return this.B}});
Object.defineProperty(L.prototype,"parallax",{get:function(){return this.H},set:function(a){this.H=G.X(a,0,1);this.R=50*this.H;Bc(this)}});Object.defineProperty(L.prototype,"modelView",{get:function(){return this.A}});Object.defineProperty(L.prototype,"modelViewInverse",{get:function(){return this.G}});Object.defineProperty(L.prototype,"main",{get:function(){null===this.c&&tc(this);return this.c}});Object.defineProperty(L.prototype,"perspectiveCameraRadius",{get:function(){return this.R}});
Object.defineProperty(L.prototype,"left",{get:function(){return this.j}});Object.defineProperty(L.prototype,"right",{get:function(){return this.f}});Object.defineProperty(L.prototype,"gaze",{get:function(){return this.u}});Object.defineProperty(L.prototype,"onCameraChange",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});function Dc(a,b){Ib.call(this,a,b,"CameraAnimation");Ec(this)}Dc.prototype=Object.create(Ib.prototype);Dc.prototype.constructor=Dc;
function Ec(a){a.j=[{prop:"quaternion",smooth:!0,Gj:function(){!0===this.Ha.cancelRoll&&(this.la.quaternion=H.cancelRoll(this.la.quaternion))},cancelRoll:!0},{prop:"fov",smooth:!1}]}
Dc.prototype.play=function(a){"string"===typeof a&&(a=p.get(a));Kb(this);var b=new Eb(this.i,this.la);b.tween.easing=a.easing;b.instruction=this.j[0];b.instruction.smooth=a.smooth;b.smooth=a.smooth;b.instruction.cancelRoll=a.cancelRoll;b.onComplete.add(this.Vb,this);this.c.push(b);var d=new Eb(this.i,this.la);d.tween.easing=a.easing;d.instruction=this.j[1];d.instruction.smooth=a.smooth;d.onComplete.add(this.Vb,this);this.c.push(d);var e=a.keyframes;a=a.offset;var h=b.tween.easing;a=a||0;for(var k,
n,v,y,D=0,db=e.length;D<db;D++)n=e[D].data,k="undefined"!==typeof n.yaw&&null!==n.yaw?n.yaw:Jb(this,e[D].time+a,e,"yaw",h),v="undefined"!==typeof n.pitch&&null!==n.pitch?n.pitch:Jb(this,e[D].time+a,e,"pitch",h),y="undefined"!==typeof n.roll&&null!==n.roll?n.roll:Jb(this,e[D].time+a,e,"roll",h),k=G.da(k),v=G.da(v),y=G.da(y),"undefined"!==typeof k&&null!==k&&"undefined"!==typeof v&&null!==v&&"undefined"!==typeof y&&null!==y&&(k=H.nc(k,v,y),k=new Db(e[D].time+a,{quaternion:k}),this.c[0].timeline.kb(k)),
"undefined"!==typeof n.fov&&null!==n.fov&&(n=n.fov,k=new Db(e[D].time+a,{fov:n}),this.c[1].timeline.kb(k));if(0<e[0].time||0<a)k=new Db(0,{quaternion:B.clone(this.la.quaternion)}),this.c[0].timeline.kb(k),k=new Db(0,{fov:this.la.fov}),this.c[1].timeline.kb(k);b.play();d.play()};
function rc(a,b){this.i=a;this.f=b;this.c=null;this.A=!1;this.u=this.j=null;this.o=0;l.call(this,"CameraGaze");this.j=this.i.clock.create(!1);this.c=new THREE.Object3D;this.c.name="CameraGaze";this.c.position.z=-2;Gc(this)}rc.prototype=Object.create(l.prototype);g=rc.prototype;g.constructor=rc;function Hc(a,b,d,e,h,k){k=k||2*Math.PI;return new THREE.RingBufferGeometry(a||.02,b||.04,d||32,e||1,h||0,k)}
function Gc(a){var b=new THREE.MeshBasicMaterial({color:a.f.cursor.color,opacity:a.f.cursor.opacity,transparent:!0}),b=new THREE.Mesh(Hc(a.f.cursor.innerRadius,a.f.cursor.outerRadius),b);b.name="cursor";a.c.add(b)}
function Ic(a){var b=new THREE.MeshBasicMaterial({color:a.f.progress.color,opacity:a.f.progress.opacity,transparent:!0,side:THREE.DoubleSide}),b=new THREE.Mesh(Hc(a.f.progress.innerRadius,a.f.progress.outerRadius,32,1,Math.PI/2,a.o/100*G.ui),b);b.name="progress";b.rotateY(Math.PI);a.c.add(b)}function Jc(a,b){for(var d=null,e=0,h=a.c.children.length;e<h;e++)a.c.children[e].name===b&&(d=a.c.children[e]);null!==d&&(a.c.remove(d),d.geometry.dispose(),d.material.dispose())}
g.ln=function(){this.stop();this.i.renderer.pickingManager.click()};g.load=function(a){this.f=a;Jc(this,"progress");Jc(this,"cursor");Gc(this);!0===this.A&&this.o&&Ic(this)};g.start=function(){this.log("startGazeAnimation");this.A=!0;this.o=0;Jc(this,"progress");Ic(this);null!==this.j&&(this.j.stop(),this.u=this.j.add(2E3,this.ln,this),this.j.start())};
g.stop=function(){this.log("stopGazeAnimation");this.A=!1;this.j.stop();this.u=null;this.o=0;var a=this.c.children[1];"undefined"!==typeof a&&null!==a&&(this.c.remove(a),a.geometry.dispose(),a.material.dispose())};g.update=function(){if(!0===this.A&&null!==this.u){var a=100*(this.u.delay-this.j.duration)/this.u.delay;this.log("timer update : "+a+"%");this.o=a;Jc(this,"progress");Ic(this)}};
g.destroy=function(){this.stop();null!==this.c&&("undefined"!==typeof this.c.geometry&&null!==this.c.geometry&&this.c.geometry.dispose(),"undefined"!==typeof this.c.material&&null!==this.c.material&&this.c.material.dispose(),this.c=null);this.m=null};Object.defineProperty(rc.prototype,"visible",{get:function(){return this.c.visible},set:function(a){this.c.visible=a}});Object.defineProperty(rc.prototype,"object",{get:function(){return this.c}});var Kc={Xa:"pointer",mf:"keyboard"};
function oa(a){this.i=a;this.c=[];this.m=!0;this.f=this.j=null;l.call(this,"ControllerManager")}oa.prototype=Object.create(l.prototype);oa.prototype.constructor=oa;var Lc={enabled:!0,instances:[{uid:"controller-pointer-0",type:Kc.Xa,enabled:!0},{uid:"controller-keyboard-0",type:Kc.mf,enabled:!0}]};g=oa.prototype;g.we=function(a){null!==this.j&&this.j.D({controller:a})};g.ve=function(a){null!==this.f&&this.f.D({controller:a})};
g.update=function(){if(null!==this.c)for(var a=0,b=this.c.length;a<b;a++)"function"===typeof this.c[a].update&&this.c[a].update()};g.ja=function(a){a="undefined"!==typeof a?a:Lc;this.m="boolean"===typeof a.enabled?a.enabled:!0;if("undefined"!==typeof a.instances)for(var b,d=0,e=a.instances.length;d<e;d++){b=a.instances[d];switch(b.type){case Kc.Xa:b=new Mc(this.i,b);break;case Kc.mf:b=new Nc(this.i,b);break;default:b=null}null!==b&&this.c.push(b)}};
g.destroy=function(){for(var a=this.c.length-1;a--;)this.c[a].destroy(),this.c[a]=null;this.c=null;null!==this.j&&(this.j.destroy(),this.j=null);null!==this.f&&(this.f.destroy(),this.f=null);l.prototype.destroy.call(this)};Object.defineProperty(oa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(oa.prototype,"enabled",{get:function(){return this.m},set:function(a){this.m=!!a}});
Object.defineProperty(oa.prototype,"active",{get:function(){for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].active)return!0;return!1}});Object.defineProperty(oa.prototype,"onControlStart",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(oa.prototype,"onControlEnd",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});function Oc(a,b){this.i=a;this.c=null;this.B=this.A=!1;this.f=this.j=null;l.call(this,b||"ControllerBase");this.Rc()}
Oc.prototype=Object.create(l.prototype);g=Oc.prototype;g.constructor=Oc;g.Rc=function(){this.i.canvas.pointer.enabled=!0;this.c=this.i.renderer.camera};g.enable=function(){!0!==this.A&&(this.A=!0)};g.Hb=function(){!1!==this.A&&(this.A=!0)};g.destroy=function(){this.i=this.c=null;null!==this.j&&(this.j.destroy(),this.j=null);null!==this.f&&(this.f.destroy(),this.f=null);l.prototype.destroy.call(this)};
Object.defineProperty(Oc.prototype,"enabled",{get:function(){return this.A},set:function(a){!0===!!a?this.enable():this.Hb()}});Object.defineProperty(Oc.prototype,"active",{get:function(){return this.B}});Object.defineProperty(Oc.prototype,"onControlStart",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(Oc.prototype,"onControlEnd",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});
function Mc(a,b){this.F=b;this.H=this.m=this.G=this.o=null;Oc.call(this,a,"ControllerPointer")}Mc.prototype=Object.create(Oc.prototype);Mc.prototype.constructor=Mc;var Pc={hardness:.6,damping:.15,velocityMax:300,invert:!1},Qc={hardness:5,invert:!1};g=Mc.prototype;
g.Rc=function(){Oc.prototype.Rc.call(this);this.H=new THREE.Vector2;this.m=new THREE.Vector2;this.o=new THREE.Vector2;this.G=new THREE.Vector2;var a=this.F;this.N=a.uid;ba(this);var b=a.options||{};this.u=B.Za(Pc,b.orientation);this.C=B.Za(Qc,b.zoom);this.A="boolean"===typeof a.enabled?a.enabled:!0;!0===this.A&&this.enable()};
g.ah=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPanMove.add(this.Me,this),this.log("_panStartHandler ("+a.data.velocityX.toFixed(2)+", "+a.data.velocityY.toFixed(2)+")"),this.B=!0,this.o=new THREE.Vector2(a.data.center.x,a.data.center.y),this.G.copy(this.o),this.m.set(0,0),null!==this.j&&this.j.D(),this.i.controllers.we(this))};g.Me=function(a){!1!==this.i.controllers.enabled&&this.G.set(a.data.center.x,a.data.center.y)};
g.$g=function(){this.i.canvas.pointer.onPanMove.remove(this.Me,this);this.log("_panEndHandler");this.B=!1;this.m.set(0,0);this.o.set(0,0);this.G.copy(this.o);null!==this.f&&this.f.D();this.i.controllers.ve(this)};g.dh=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPinchMove.add(this.bh,this),this.log("_pinchStartHandler "+a))};g.bh=function(a){!1!==this.i.controllers.enabled&&this.log("_pinchMoveHandler "+a.data.pinch)};
g.Ne=function(a){this.i.canvas.pointer.onPinchMove.remove(this.bh,this);this.log("_pinchEndHandler "+a)};g.eh=function(a){if(!1!==this.i.controllers.enabled){a.data.preventDefault();var b=(this.C.invert?1:-1)/this.C.hardness,d=1;if(a.data.deltaMode)switch(a.data.deltaMode){case 1:d=33.3;break;case 2:d=self.innerHeight;break;default:d=1}a.data.deltaY&&(b*=a.data.deltaY*d/5);this.c.fov=this.c.fov-b;this.log("_wheelHandler (fov:"+this.c.fov+")")}};
g.enable=function(){Oc.prototype.enable.call(this);this.i.canvas.pointer.onPanStart.add(this.ah,this);this.i.canvas.pointer.onPanEnd.add(this.$g,this);this.i.canvas.pointer.onPinchStart.add(this.dh,this);this.i.canvas.pointer.onPinchEnd.add(this.Ne,this);this.i.canvas.pointer.onWheel.add(this.eh,this)};
g.Hb=function(){Oc.prototype.Hb.call(this);this.i.canvas.pointer.onPanStart.remove(this.ah,this);this.i.canvas.pointer.onPanMove.remove(this.Me,this);this.i.canvas.pointer.onPanEnd.remove(this.$g,this);this.i.canvas.pointer.onPinchStart.remove(this.dh,this);this.i.canvas.pointer.onPinchMove.remove(this.Ne,this);this.i.canvas.pointer.onPinchEnd.remove(this.Ne,this);this.i.canvas.pointer.onWheel.remove(this.eh,this)};
g.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.u.hardness*Math.min(a.width,a.height));this.m.subVectors(this.G,this.o);this.m.length()>this.u.velocityMax&&this.m.setLength(this.u.velocityMax);this.m.multiplyScalar(a);var a=this.u.invert?-1:1,b=a*(this.m.x+this.H.x);.05<Math.abs(b)&&(this.c.yaw+=b);a*=this.m.y+this.H.y;.05<Math.abs(a)&&(this.c.pitch-=a);this.H.add(this.m).multiplyScalar(G.X(1-this.u.damping,0,1))};
function Nc(a,b){this.I=b;this.m=this.H=this.u=this.o=this.C=null;Oc.call(this,a,"ControllerKeyboard")}Nc.prototype=Object.create(Oc.prototype);Nc.prototype.constructor=Nc;var Rc={hardness:.6,damping:.15,velocityMax:300,invert:!1},Sc={hardness:5,invert:!1};g=Nc.prototype;
g.Rc=function(){Oc.prototype.Rc.call(this);this.m=[];this.H=new THREE.Vector2;this.u=new THREE.Vector2;this.C=new THREE.Vector2;this.o=new THREE.Vector2;var a=this.I;this.N=a.uid;ba(this);var b=a.options||{};this.G=B.Za(Rc,b.orientation);this.F=B.Za(Sc,b.zoom);this.A="boolean"===typeof a.enabled?a.enabled:!0;!1!==b["default"]&&(a=new O(this.i,[81,37],this.Yd,this.$d,this.Zd,[68,39],this,"left"),this.m.push(a),a=new O(this.i,[68,39],this.Yd,this.$d,this.Zd,[81,37],this,"right"),this.m.push(a),a=new O(this.i,
[90,38],this.Yd,this.$d,this.Zd,[83,40],this,"up"),this.m.push(a),a=new O(this.i,[83,40],this.Yd,this.$d,this.Zd,[90,38],this,"down"),this.m.push(a),a=new O(this.i,107,this.dj,this.fj,this.ej,109,this,"plus"),this.m.push(a),a=new O(this.i,109,this.dj,this.fj,this.ej,107,this,"minus"),this.m.push(a));if(!0===Array.isArray(b.bindings))for(var a=0,d=b.bindings.length;a<d;a++){var e=b.bindings[a],h=e.in,k=e.out,n=e.name,e=e.events;!1===B.T(h,"number")&&!1===B.Fa(h,"number")?this.warn("Can't add custom keyboard binding, keys in are invalid!"):
"object"!==typeof e&&null===e?this.warn("Can't add custom keyboard binding, events are invalid!"):(h=new O(this.i,h,e.onDown,e.onUp,e.onHold,k,this,n),this.m.push(h))}!0===this.A&&this.enable()};g.Yd=function(a){if(!1!==this.i.controllers.enabled){this.B=!0;switch(a.name){case "left":case "right":this.u.setX(0);break;case "up":case "down":this.u.setY(0)}null!==this.j&&this.j.D();this.i.controllers.we(this)}};
g.Zd=function(a){if(!1!==this.i.controllers.enabled)switch(a.name){case "left":this.o.setX(this.o.x-5);break;case "right":this.o.setX(this.o.x+5);break;case "up":this.o.setY(this.o.y-5);break;case "down":this.o.setY(this.o.y+5)}};g.$d=function(a){this.B=!1;switch(a.name){case "left":case "right":this.u.setX(0);this.o.setX(0);break;case "up":case "down":this.u.setY(0),this.o.setY(0)}null!==this.f&&this.f.D();this.i.controllers.ve(this)};
g.dj=function(a){!1!==this.i.controllers.enabled&&(this.B=!0,Tc(this,a),null!==this.j&&this.j.D(),this.i.controllers.we(this))};g.ej=function(a){Tc(this,a)};g.fj=function(){this.B=!1;null!==this.f&&this.f.D();this.i.controllers.ve(this)};function Tc(a,b){var d=(a.F.invert?1:-1)/a.F.hardness;switch(b.name){case "minus":d*=10;break;case "plus":d*=-10}a.c.fov=a.c.fov-d}g.enable=function(){Oc.prototype.enable.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.Sf(a)};
g.Hb=function(){Oc.prototype.Hb.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.Be(a)};
g.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.G.hardness*Math.min(a.width,a.height));this.u.subVectors(this.o,this.C);this.u.length()>this.G.velocityMax&&this.u.setLength(this.G.velocityMax);this.u.multiplyScalar(a);a=this.G.invert?-1:1;this.c.yaw+=a*(this.u.x+this.H.x);this.c.pitch-=a*(this.u.y+this.H.y);this.H.add(this.u).multiplyScalar(G.X(1-this.G.damping,0,1))};
function u(a){this.i=a;this.J=null;this.j=1;this.M=!1;this.U=this.F=this.V=1;this.C=!1;this.R=!0;this.c=null;this.L=!1;this.m=!0;this.f=null;this.O="running";this.A=this.u=this.H=this.G=this.B=this.o=this.I=null;l.call(this,"SoundManager")}u.prototype=Object.create(l.prototype);g=u.prototype;g.constructor=u;
g.boot=function(){this.c=[];if(!0===I.Rg)try{"function"===typeof window.AudioContext?this.f=new window.AudioContext:this.f=new window.webkitAudioContext}catch(a){this.f=null,this.m=!1}!0===I.Uf&&null===this.f&&(this.m=!1,this.L=!0);null!==this.f&&(this.o="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.I=this.f.createAnalyser(),this.I.connect(this.o),this.o.gain.value=this.j,this.o.connect(this.f.destination),this.f.listener.setOrientation(0,0,-1,0,1,0));this.i.story.onSceneLoadStart.add(this.Oh,
this)};g.Oh=function(){if("undefined"!==typeof this.i.story.scene.config.audio){var a=B.Za(this.J,this.i.story.scene.config.audio);Uc(this,a)}else Uc(this,this.J);!1===this.R?null!==this.u&&this.u.D():null!==this.A&&this.A.D()};
function Uc(a,b){null!==b&&(a.R="undefined"!==typeof b.enabled?!!b.enabled:!0,a.F="undefined"!==typeof b.volume&&"number"===typeof b.volume.max?G.X(b.volume.max,0,1):1,a.V=!1===a.M?"undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?G.X(b.volume["default"],0,a.F):1:G.X(a.j,0,a.F))}g.ja=function(a){this.J=a;Uc(this,a);"number"===typeof this.V&&!1===this.M&&(this.j=G.X(this.V,0,1));Vc(this)};
g.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update();if(!0===this.m&&null!==this.i.renderer.camera.main){a=new THREE.Vector3;b=this.i.renderer.camera.main.quaternion;a.set(0,0,1);a.applyQuaternion(b);var d=a.clone();a.set(0,1,0);a.applyQuaternion(b);this.f.listener.setOrientation(d.x,d.y,d.z,a.x,a.y,a.z)}};g.add=function(a){-1===Wc(this,a)&&this.c.push(a)};g.remove=function(a){a=Wc(this,a);-1<a&&this.c.splice(a,1)};
function Wc(a,b){if(null===a.c)return-1;for(var d,e=0,h=a.c.length;e<h;e++)if(d=a.c[e],d===b)return e;return-1}g.suspend=function(){if(null!==this.f&&"undefined"!==typeof this.f.suspend&&!0===this.m&&!1===I.td&&"running"===this.O){for(var a=!0,b=0,d=this.c.length;b<d;b++)if(!0===this.c[b].playing||!0===this.c[b].paused){a=!1;break}!0===a&&(this.O="suspended",this.f.suspend())}};
g.resume=function(){if(null!==this.f&&"undefined"!==typeof this.f.resume&&!0===this.m&&!1===I.td&&"suspended"===this.O)for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].playing||!0===this.c[a].paused){this.O="running";this.f.resume();break}};g.$a=function(){!0!==this.C&&(this.C=!0,this.U=this.j,this.j=0,!0===this.m&&(this.U=this.o.gain.value),Vc(this),null!==this.B&&this.B.D())};g.Ph=function(){!1!==this.C&&(this.C=!1,this.j=this.U,Vc(this),null!==this.G&&this.G.D())};
function Vc(a){if(!0===a.m)a.o.gain.value=a.j;else if(!0===a.L)for(var b=0;b<a.c.length;b++)a.c[b].c.data.volume=G.X(a.c[b].B,0,1)*a.j;a.M=!0;null!==a.H&&a.H.D()}
g.destroy=function(){this.i.story.onSceneLoadStart.remove(this.Oh,this);this.J=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.o=this.I=this.f=this.c=null;null!==this.B&&(this.B.destroy(),this.B=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.H&&(this.H.destroy(),this.H=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(u.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(u.prototype,"analyser",{get:function(){return this.I}});Object.defineProperty(u.prototype,"inputNode",{get:function(){return this.I}});Object.defineProperty(u.prototype,"masterGain",{get:function(){return this.o}});Object.defineProperty(u.prototype,"useWebAudio",{get:function(){return this.m},set:function(a){"boolean"===typeof a&&(this.m=a,this.L=!a)}});
Object.defineProperty(u.prototype,"useAudioTag",{get:function(){return this.L},set:function(a){"boolean"===typeof a&&(this.L=a,this.m=!a)}});Object.defineProperty(u.prototype,"enabled",{get:function(){return this.R}});Object.defineProperty(u.prototype,"muted",{get:function(){return this.C},set:function(a){"boolean"===typeof a&&(!0===a?this.$a():this.Ph())}});
Object.defineProperty(u.prototype,"volume",{get:function(){return!0===this.m?this.o.gain.value:this.j},set:function(a){"number"===typeof a&&(a=G.X(a,0,1),this.j=this.F<a?this.F:a,0<this.j&&(this.C=!1),Vc(this))}});Object.defineProperty(u.prototype,"onMute",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(u.prototype,"onUnmute",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});
Object.defineProperty(u.prototype,"onVolumeChange",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(u.prototype,"onDisable",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(u.prototype,"onEnable",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});var Ga={Ol:"stereo",Nl:"3d",cf:"ambisonic"};
function M(a,b,d,e){this.i=a;this.ma=b;this.j=d;this.sa=this.B=1;this.ga=!1;this.J=!0;this.ea=!1;this.A=this.za=this.F=this.I=this.o=0;this.u=this.O=!1;this.Aa=0;this.C=!1;this.H=this.Ca=this.f=this.m=this.na=this.c=this.L=null;this.Da=this.ta=this.Ba=0;this.ra=null;this.qa=e||!1;this.Ea=[0,1,2,3];this.ha=this.aa=!1;this.ya=this.xa=null;this.W=!1;this.V=this.ia=this.S=this.ka=this.G=this.wa=this.pa=this.P=this.U=this.R=this.ba=this.M=this.Z=null;l.call(this,"Sound");!0===this.qa&&!1===Xc(this)&&(this.log("$_Sound: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),
this.qa=!1);this.N=this.ma;ba(this);!0===this.i.audio.useWebAudio&&(this.f=this.i.audio.context,this.Ca=this.i.audio.inputNode,this.H="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.H.gain.value=this.B*this.i.audio.volume,this.H.connect(this.Ca));if(!0===this.i.audio.useAudioTag||!0===Xc(this))!0===this.i.cache.has(A.qb,this.ma)&&this.Rh(this.i.cache.get(A.qb,this.ma)),this.i.audio.onVolumeChange.add(this.Sh,this);this.i.audio.onDisable.add(this.Qh,this);""!==
this.j&&(this.i.load.sound(this.ma,this.j,this.Rh,this,Xc(this)),null!==this.M&&this.M.D());this.i.audio.add(this)}M.prototype=Object.create(l.prototype);g=M.prototype;g.constructor=M;
g.Rh=function(a){this.L=a;this.ha=!0;null!==this.ba&&this.ba.D();!0===this.i.audio.useWebAudio?(a=this.L)&&!1===this.W&&(this.xa=this.wi.bind(this),this.ya=this.hm.bind(this),!0===Xc(this)?(this.ra=Omnitone.createFOADecoder(this.f,a.data,{channelMap:this.Ea}),this.ra.initialize().then(this.xa,this.ya)):this.f.decodeAudioData(a.data,this.xa,this.ya)):(Yc(this),this.wi(null))};g.hm=function(){null!==this.L&&(this.L.data=null,this.W=!1)};
function Yc(a){null!==a.Z&&a.Z.D();null!==a.R&&a.R.D();null!==a.U&&a.U.D()}g.wi=function(a){if(null===this.L)this.log("$_Sound._decodeComplete error, sound file is null");else{a&&(this.L.data=a);this.W=!0;Yc(this);if(!0===this.i.audio.useAudioTag||!0===Xc(this))this.c=this.i.cache.get(A.qb,this.ma),Zc(this),this.o=0,this.c.data.duration&&(this.o=this.c.data.duration,this.I=Math.ceil(1E3*this.o));!0===this.aa&&this.play(this.A,this.O,!0)}};g.Sh=function(){Zc(this)};
function Zc(a){null===a.c||!0!==a.i.audio.useAudioTag&&!0!==Xc(a)||(a.c.data.volume=G.X(a.B,0,1)*a.i.audio.volume)}g.Qh=function(){!0===this.u?this.pause():!1===this.paused&&this.stop()};function $c(a){a.A=0;a.aa=!1;a.u=!1;a.C=!1}
function ad(a,b){null===a.m&&(a.m=a.f.createPanner(),a.m.panningModel="HRTF",a.m.distanceModel="inverse",a.m.refDistance=1,a.m.maxDistance=1E4,a.m.rolloffFactor=1,a.m.coneInnerAngle=360,a.m.coneOuterAngle=0,a.m.coneOuterGain=0,a.m.setOrientation(0,0,0),a.m.setPosition(0,0,0));a.m.setPosition(a.Ba,a.ta,a.Da);!0===b&&(a.c.connect(a.m),a.m.connect(a.H))}function Xc(a){return!0===a.qa&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}
g.update=function(){if(!0===this.u&&!1===this.C){var a=this.i.clock.time-this.F;if(a>=this.I){if(this.A=this.I,!0===this.i.audio.useWebAudio||!0===this.i.audio.useAudioTag)this.stop(!0),null!==this.V&&this.V.D(),!0===this.O&&(this.A=0,this.resume())}else this.A=a}null!==this.ra&&!0===this.u&&this.ra.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
g.play=function(a,b,d){if(!1===this.i.audio.enabled||!1===this.J)this.C=this.u=!1;else{this.O=b||this.O;if(!0===this.u)if(!0===d)this.stop();else return;if(!1===this.ha)this.aa=!0;else{if(!0===this.i.audio.useWebAudio&&!1===Xc(this))if(!0===this.W)null===this.na&&(this.na=this.L.data),this.c=this.f.createBufferSource(),this.c.buffer=this.na,!0===this.ea?ad(this,!0):this.c.connect(this.H),this.o=this.c.buffer.duration,this.I=Math.ceil(1E3*this.o),!isNaN(a)&&a<this.I?this.F=this.i.clock.time-a:(a=0,
this.F=this.i.clock.time),b=G.sd(a/1E3),"undefined"===typeof this.c.start?this.c.noteGrainOn(0,b%this.o,this.o):this.c.start(0,b%this.o,this.o),this.u=!0,this.A=a,this.Aa++,null!==this.G&&this.G.D();else{this.log("Sound is not decoded yet");this.aa=!0;return}else if(!0===this.i.audio.useAudioTag||!0===Xc(this))this.o?Infinity===this.o&&(this.c.data.loop=!0):(this.o=this.c.data.duration,this.I=Math.ceil(1E3*this.o)),!isNaN(a)&&this.I&&a<this.I?(this.c.data.currentTime=G.sd(a/1E3),this.F=this.i.clock.time-
a):(a=0,this.c.data.currentTime=a,this.F=this.i.clock.time),this.c.data.play(),this.u=!0,this.A=a,this.Aa++,null!==this.G&&this.G.D();this.i.audio.resume()}}};g.stop=function(a){null!==this.c?(bd(this,!0),this.F=this.za=this.i.clock.time,this.C=this.u=this.aa=!1,null!==this.ka&&!0===a&&this.ka.D(),this.i.audio.suspend()):!1!==this.ha&&!0===this.W||$c(this)};
function bd(a,b){if(!0===a.i.audio.useWebAudio&&!1===Xc(a)){if("undefined"===typeof a.c.stop)a.c.noteOff(0);else try{a.c.stop(0)}catch(d){}a.c.disconnect(0);!0===b&&(a.A=0)}else if(!0===a.i.audio.useAudioTag||!0===Xc(a))a.c.data.pause(),!0===b&&(a.A=0,a.c.data.currentTime=0)}g.pause=function(){!0===this.u&&null!==this.c?(bd(this,!1),this.C=!0,this.za=this.i.clock.time,this.u=this.aa=!1,null!==this.S&&this.S.D(),this.i.audio.suspend()):!1!==this.ha&&!0===this.W||$c(this)};
g.resume=function(){if(!1!==this.i.audio.enabled&&!1!==this.J)if(!0===this.C||!1===this.u)if(null===this.c)this.play(this.A,this.O,!0);else{this.F=this.i.clock.time-(this.za-this.F);this.A=this.i.clock.time-this.F;var a=G.sd(this.A/1E3);if(!0===this.i.audio.useWebAudio&&!1===Xc(this)){this.c=this.f.createBufferSource();this.c.buffer=this.na;!0===this.ea?ad(this,!0):this.c.connect(this.H);var b=Math.ceil((this.I-this.A)/1E3);"undefined"===typeof this.c.start?this.c.noteGrainOn(0,a%this.o,b):this.c.start(0,
a%this.o,b)}else if(!0===this.i.audio.useAudioTag||!0===Xc(this))this.c.data.currentTime=G.sd(a/1E3),this.c.data.play();this.u=!0;this.C=!1;null!==this.ia&&this.ia.D();this.i.audio.resume()}else if(!1===this.ha||!1===this.W)$c(this),this.aa=!0};
g.$a=function(){!0!==this.ga&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.ga=!0,this.sa=this.B,this.B=0,!0===this.i.audio.useWebAudio&&!1===Xc(this)?this.H.gain.value=this.B:!0!==this.i.audio.useAudioTag&&!0!==Xc(this)||null===this.c||(this.c.data.volume=this.B),null!==this.P&&this.P.D())};
g.Th=function(){!1!==this.ga&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.ga=!1,this.B=this.sa,!0===this.i.audio.useWebAudio&&!1===Xc(this)?this.H.gain.value=this.sa:!0!==this.i.audio.useAudioTag&&!0!==Xc(this)||null===this.c||(this.c.data.volume=this.sa),null!==this.pa&&this.pa.D())};
g.destroy=function(){this.stop();!0!==this.i.audio.useAudioTag&&!0!==Xc(this)||this.i.audio.onVolumeChange.remove(this.Sh,this);this.i.audio.onDisable.remove(this.Qh,this);this.i.audio.remove(this);this.ya=this.xa=this.m=this.H=this.Ca=this.f=this.na=this.c=this.L=this.i=null;null!==this.Z&&(this.Z.destroy(),this.Z=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.ba&&(this.ba.destroy(),this.ba=null);null!==this.R&&(this.R.destroy(),this.R=null);null!==this.U&&(this.U.destroy(),this.U=
null);null!==this.P&&(this.P.destroy(),this.P=null);null!==this.pa&&(this.pa.destroy(),this.pa=null);null!==this.wa&&(this.wa.destroy(),this.wa=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.ka&&(this.ka.destroy(),this.ka=null);null!==this.S&&(this.S.destroy(),this.S=null);null!==this.ia&&(this.ia.destroy(),this.ia=null);null!==this.V&&(this.V.destroy(),this.V=null);l.prototype.destroy.call(this)};
Object.defineProperty(M.prototype,"enabled",{get:function(){return this.J},set:function(a){"boolean"===typeof a&&(this.J=a,!1!==this.J||!0!==this.u&&!0!==this.C||this.stop())}});Object.defineProperty(M.prototype,"currentTime",{get:function(){return this.A},set:function(a){"number"===typeof a&&(this.pause(),this.A=a,!0===this.u&&this.resume())}});Object.defineProperty(M.prototype,"spatialized",{get:function(){return this.ea},set:function(a){"boolean"===typeof a&&(this.ea=a)}});
Object.defineProperty(M.prototype,"ambisonic",{get:function(){return this.qa}});Object.defineProperty(M.prototype,"duration",{get:function(){return this.o}});Object.defineProperty(M.prototype,"muted",{get:function(){return this.ga||this.i.audio.$a},set:function(a){"boolean"===typeof a&&(!0===a?this.$a():this.Th())}});
Object.defineProperty(M.prototype,"volume",{get:function(){return this.B},set:function(a){"number"===typeof a&&!0!==isNaN(a)&&(a=G.X(a,0,1),a!==this.B&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.B=a,0<this.B&&(this.ga=!1),!0===this.i.audio.useWebAudio&&!1===Xc(this)?this.H.gain.value=a:Zc(this),null!==this.wa&&this.wa.D()))}});Object.defineProperty(M.prototype,"decoded",{get:function(){return null===this.L?!1:this.W}});Object.defineProperty(M.prototype,"playCount",{get:function(){return this.Aa}});
Object.defineProperty(M.prototype,"playing",{get:function(){return this.u}});Object.defineProperty(M.prototype,"ready",{get:function(){return this.ha}});Object.defineProperty(M.prototype,"paused",{get:function(){return this.C}});Object.defineProperty(M.prototype,"loop",{get:function(){return this.O},set:function(a){"boolean"===typeof a&&(this.O=a,!0!==this.i.audio.useAudioTag&&!0!==Xc(this)||null===this.c||Infinity!==this.o||(this.c.data.loop=this.O))}});
Object.defineProperty(M.prototype,"x",{get:function(){return this.Ba},set:function(a){"number"===typeof a&&(this.Ba=a,!0===this.i.audio.useWebAudio&&!1===Xc(this)&&null!==this.c&&null!==this.m&&!0===this.ea&&ad(this))}});Object.defineProperty(M.prototype,"y",{get:function(){return this.ta},set:function(a){"number"===typeof a&&(this.ta=a,!0===this.i.audio.useWebAudio&&!1===Xc(this)&&null!==this.c&&null!==this.m&&!0===this.ea&&ad(this))}});
Object.defineProperty(M.prototype,"z",{get:function(){return this.ta},set:function(a){"number"===typeof a&&(this.Da=a,!0===this.i.audio.useWebAudio&&!1===Xc(this)&&null!==this.c&&null!==this.m&&!0===this.ea&&ad(this))}});Object.defineProperty(M.prototype,"onSoundDecode",{get:function(){null===this.Z&&(this.Z=new q(this));return this.Z}});Object.defineProperty(M.prototype,"onLoadStart",{get:function(){null===this.M&&(this.M=new q(this));return this.M}});
Object.defineProperty(M.prototype,"onLoadedData",{get:function(){null===this.ba&&(this.ba=new q(this));return this.ba}});Object.defineProperty(M.prototype,"onCanPlay",{get:function(){null===this.R&&(this.R=new q(this));return this.R}});Object.defineProperty(M.prototype,"onCanPlayThrough",{get:function(){null===this.U&&(this.U=new q(this));return this.U}});Object.defineProperty(M.prototype,"onMute",{get:function(){null===this.P&&(this.P=new q(this));return this.P}});
Object.defineProperty(M.prototype,"onUnmute",{get:function(){null===this.pa&&(this.pa=new q(this));return this.pa}});Object.defineProperty(M.prototype,"onVolumeChange",{get:function(){null===this.wa&&(this.wa=new q(this));return this.wa}});Object.defineProperty(M.prototype,"onPlay",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(M.prototype,"onStop",{get:function(){null===this.ka&&(this.ka=new q(this));return this.ka}});
Object.defineProperty(M.prototype,"onPause",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(M.prototype,"onResume",{get:function(){null===this.ia&&(this.ia=new q(this));return this.ia}});Object.defineProperty(M.prototype,"onEnded",{get:function(){null===this.V&&(this.V=new q(this));return this.V}});
function P(a,b){this.i=a;this.j=b;this.I=this.c=null;this.f=this.O="";this.L=this.m=1;this.F=this.J=this.C=!0;this.o=this.G=this.u=this.H=this.A=this.B=null;l.call(this,"Playlist");this.N=this.j.uid;ba(this);this.I=new za(this.i,this.j.name);this.c=[];a=this.j;this.C="undefined"!==typeof a.autoPlay?!!a.autoPlay:!0;this.F="undefined"!==typeof a.loop?!!a.loop:!0;this.m="undefined"!==typeof a.volume&&"number"===typeof a.volume.max?G.X(a.volume.max,0,1):1;this.L="undefined"!==typeof a.volume&&"number"===
typeof a.volume["default"]?G.X(a.volume["default"],0,this.m):G.X(1,0,this.m);a=this.j;"undefined"!==typeof a.tracks&&!0===B.Fa(a.tracks,"string")?this.c=a.tracks:this.warn("A playlist has no track in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&""!==a["default"]?this.O=a["default"]:"number"===typeof a["default"]&&0<=a["default"]&&a["default"]<this.c.length?this.O=this.c[a["default"]].uid:this.warn("A playlist has a default track that is not in its tracks array!");
this.f=this.O;null!==this.B&&this.B.D()}P.prototype=Object.create(l.prototype);g=P.prototype;g.constructor=P;g.be=function(){0<this.c.length&&this.c.indexOf(this.f)+1===this.c.length&&(!1===this.F||!0===this.track.loop)?this.f=this.c[0]:this.qd()};g.hl=function(){null!==this.A&&this.A.D()};g.jl=function(){null!==this.H&&this.H.D()};g.gl=function(){null!==this.u&&this.u.D()};g.il=function(){null!==this.G&&this.G.D()};g.fl=function(){null!==this.o&&this.o.D()};g.kl=function(){return!!this.c.length};
g.play=function(a,b){this.J="undefined"!==typeof b?b:!1;var d;if("string"===typeof a&&p.T(a,"PlaylistTrack"))d=a;else if(B.T(a,"PlaylistTrack"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a];else if(""!==this.f)d=this.f;else if("undefined"===typeof a||""===a)d=this.c[0];if("undefined"!==typeof d){this.stop();this.f=d;if(!0===this.J&&!1===this.C)return this.warn("$_Playlist.play(); autoPlay is disabled"),this.track;this.track.play();!1===this.track.onEnded.has(this.be,this)&&
this.track.onEnded.add(this.be,this);this.log("$_Playlist.play(); [uid: "+this.f+"]");return this.track}return null};g.stop=function(){null!==this.track&&(this.track.stop(),"undefined"!==typeof this.track.onEnded&&!1===this.track.onEnded.has(this.be,this)&&this.track.onEnded.remove(this.be,this))};g.pause=function(){null!==this.track&&this.track.pause()};g.resume=function(){null!==this.track&&this.track.resume()};
g.qd=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)+1,a===this.c.length&&(a=0));this.play(a,this.J);!0===this.paused&&this.pause()};g.Ae=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)-1,-1===a&&(a=this.c.length-1));this.play(a,this.J);!0===this.paused&&this.pause()};g.destroy=function(){this.stop();this.i=null;this.I.destroy();this.I=null;0<this.c.length&&(this.c.length=0,this.c=null);this.j=null;l.prototype.destroy.call(this)};
Object.defineProperty(P.prototype,"tracks",{get:function(){return this.c}});Object.defineProperty(P.prototype,"name",{get:function(){return this.I.value}});Object.defineProperty(P.prototype,"ready",{get:function(){return null!==this.track?this.track.ready:!1}});Object.defineProperty(P.prototype,"decoded",{get:function(){return null!==this.track?this.track.decoded:!1}});Object.defineProperty(P.prototype,"playing",{get:function(){return null!==this.track?this.track.playing:!1}});
Object.defineProperty(P.prototype,"paused",{get:function(){return null!==this.track?this.track.paused:!1}});Object.defineProperty(P.prototype,"track",{get:function(){return!0===p.T(this.f,"PlaylistTrack")?p.get(this.f,"PlaylistTrack"):null}});Object.defineProperty(P.prototype,"loop",{get:function(){return this.F},set:function(a){this.F=!!a}});Object.defineProperty(P.prototype,"autoPlay",{get:function(){return this.C},set:function(a){this.C=!!a}});
Object.defineProperty(P.prototype,"volume",{get:function(){return this.L},set:function(a){"number"===typeof a&&(a=G.X(a,0,1),this.L=this.m<a?this.m:a,!0===p.T(this.f,"PlaylistTrack")&&(a=p.get(this.f,"PlaylistTrack"),null!==a&&(a.volume=this.L*this.i.playlists.volume)))}});Object.defineProperty(P.prototype,"onPlay",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});Object.defineProperty(P.prototype,"onStop",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});
Object.defineProperty(P.prototype,"onPause",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(P.prototype,"onResume",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(P.prototype,"onEnded",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(P.prototype,"onReady",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});
function z(a){this.i=a;this.u=this.c=this.I=null;this.f=this.j="";this.L=this.A=1;this.m=!0;this.o=this.O=!1;this.B=this.C=this.G=this.F=this.H=this.J=null;l.call(this,"PlaylistManager")}z.prototype=Object.create(l.prototype);g=z.prototype;g.constructor=z;g.boot=function(){this.c=[];this.u=[];this.i.audio.onEnable.add(this.zi,this);this.i.story.onSceneLoadStart.add(this.uh,this)};
g.zi=function(){!0===this.m&&0<this.c.length&&!0===this.ready&&!0===this.decoded&&!1===this.o&&(!0===this.paused?this.resume():!1===this.playing&&this.play())};
g.uh=function(){if("undefined"!==typeof this.i.story.scene.config.playlists){var a=B.Za(this.I,this.i.story.scene.config.playlists);cd(this,a);!1===this.o&&(!1===this.m?dd(this):ed(this,this.f)||!0===this.playing&&dd(this))}else cd(this,this.I),!1===this.o&&this.f!==this.j&&(!1!==this.m&&!1!==this.ready&&!1!==this.decoded&&!0!==this.playing||dd(this),ed(this,this.f))};
function cd(a,b){null!==b&&(a.m="undefined"!==typeof b.enabled?!!b.enabled:!0,"undefined"!==typeof b["default"]&&("string"===typeof b["default"]&&""!==b["default"]?a.f=b["default"]:"number"===typeof b["default"]&&0<=b["default"]&&b["default"]<a.c.length&&(a.f=a.c[b["default"]].uid)),a.A="undefined"!==typeof b.volume&&"number"===typeof b.volume.max?G.X(b.volume.max,0,1):1,a.L="undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?G.X(b.volume["default"],0,a.A):G.X(1,0,a.A))}
g.ja=function(a){var b;this.I=a;if("undefined"!==typeof a.lists)for(var d=0,e=a.lists.length;d<e;d++)b=new P(this.i,a.lists[d]),this.add(b);if("undefined"!==typeof a.tracks)for(d=0,e=a.tracks.length;d<e;d++)b=new fd(this.i,a.tracks[d]),this.vh(b),!0===this.O&&this.warn("Preload is not supported yet.");cd(this,a);"undefined"!==typeof a.lists&&0<a.lists.length&&(""===this.f&&this.warn("The playlist manager has a default playlist that is not in its playlists array!"),this.j=this.f);if(!(0>=this.c.length)){var h;
"string"===typeof this.f&&""!==this.f?h=this.f:h=this.c[0].uid;void 0===p.get(h)&&this.warn('PlaylistManager : uid "'+h+'" is not into playlists');!0===p.T(h,"Playlist")?this.play(h,!0):this.warn("Impossible to play the playlist with uid "+h+", it doesn't seem to be a playlist!")}};
function ed(a,b){return null!==b&&!0===p.T(b,"Playlist")?(null!==a.playlist&&a.playlist.uid===b?null!==a.playlist.track&&"undefined"!==typeof a.playlist.track.uid&&""!==a.playlist.track.uid?!0===a.paused?a.resume():!1===a.playing&&a.play(b,!0):(a.stop(),a.play(b,!0)):(a.stop(),a.play(b,!0)),!0):!1}function dd(a){!0===a.playing?a.pause():a.stop()}g.bl=function(){null!==this.H&&this.H.D();null!==this.playlist&&P.prototype.hl.call(this.playlist)};
g.dl=function(){null!==this.F&&this.F.D();null!==this.playlist&&P.prototype.jl.call(this.playlist)};g.al=function(){null!==this.G&&this.G.D();null!==this.playlist&&P.prototype.gl.call(this.playlist)};g.cl=function(){null!==this.C&&this.C.D();null!==this.playlist&&P.prototype.il.call(this.playlist)};g.$k=function(){null!==this.B&&this.B.D();null!==this.playlist&&P.prototype.fl.call(this.playlist)};g.add=function(a){this.c.push(a)};g.vh=function(a){this.u.push(a)};g.Ln=function(){return!!this.c.length};
g.el=function(){return!!this.u.length};g.play=function(a,b){var d;if("string"===typeof a&&p.T(a,"Playlist"))d=a;else if(B.T(a,"Playlist"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a].uid;else if(""!==this.j)d=this.j;else if("undefined"===typeof a||""===a)d=this.c[0].uid;"undefined"!==typeof d&&(!0===this.playing&&this.stop(),this.j=d,!0===this.m&&(this.o=!1,this.playlist.play(null,b),this.log("$_PlaylistManager.play(); [uid: "+this.j+"]")))};
g.stop=function(){null!==this.playlist&&this.playlist.stop()};g.pause=function(){null!==this.playlist&&!0===this.playlist.playing&&(this.o=!0,this.playlist.pause())};g.resume=function(){if(null!==this.playlist&&!0===this.m&&!0===this.playlist.paused){var a=this.o;this.o=!1;!0===a&&this.f!==this.j?ed(this,this.f):this.playlist.resume()}};g.qd=function(){null!==this.playlist&&!0===this.m&&this.playlist.qd()};g.Ae=function(){null!==this.playlist&&!0===this.m&&this.playlist.Ae()};
g.destroy=function(){this.stop();this.i.audio.onEnable.remove(this.zi,this);this.i.story.onSceneLoadStart.remove(this.uh,this);this.I=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null;for(a=this.u.length;a--;)this.u[a].destroy();this.u=null;l.prototype.destroy.call(this)};Object.defineProperty(z.prototype,"playlists",{get:function(){return this.c}});Object.defineProperty(z.prototype,"tracks",{get:function(){return this.u}});
Object.defineProperty(z.prototype,"playlist",{get:function(){return!0===p.T(this.j,"Playlist")?p.get(this.j,"Playlist"):null}});Object.defineProperty(z.prototype,"loop",{get:function(){return null!==this.playlist?this.playlist.loop:!0}});Object.defineProperty(z.prototype,"autoPlay",{get:function(){return null!==this.playlist?this.playlist.autoPlay:!0}});Object.defineProperty(z.prototype,"preload",{get:function(){return this.O},set:function(a){this.O=!!a}});
Object.defineProperty(z.prototype,"enabled",{get:function(){return this.m}});Object.defineProperty(z.prototype,"ready",{get:function(){return null!==this.playlist?this.playlist.ready:!1}});Object.defineProperty(z.prototype,"decoded",{get:function(){return null!==this.playlist?this.playlist.decoded:!1}});Object.defineProperty(z.prototype,"playing",{get:function(){return null!==this.playlist?this.playlist.playing:!1}});
Object.defineProperty(z.prototype,"paused",{get:function(){return null!==this.playlist?this.playlist.paused:!1}});Object.defineProperty(z.prototype,"volume",{get:function(){return this.L},set:function(a){if("number"===typeof a&&(a=G.X(a,0,1),this.L=this.A<a?this.A:a,!0===p.T(this.j,"Playlist")&&(a=p.get(this.j,"Playlist"),null!==a))){var b=a.track;null!==b&&(b.volume=a.volume*this.L)}}});Object.defineProperty(z.prototype,"onReady",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});
Object.defineProperty(z.prototype,"onPlay",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(z.prototype,"onStop",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});Object.defineProperty(z.prototype,"onPause",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(z.prototype,"onResume",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});
Object.defineProperty(z.prototype,"onEnded",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});function fd(a,b){this.i=a;this.u=b;this.o=this.m=null;this.j="";this.f=!1;this.c=null;l.call(this,"PlaylistTrack");this.N=this.u.uid;ba(this);a=this.u;da(this);this.N=a.uid;ba(this);this.m=new za(this.i,a.name);this.o=new za(this.i,a.author);this.j=a.url;this.f=a.loop||!1}fd.prototype=Object.create(l.prototype);g=fd.prototype;g.constructor=fd;g.yh=function(){z.prototype.bl.call(this.i.playlists)};
g.Li=function(){z.prototype.dl.call(this.i.playlists)};g.xh=function(){z.prototype.al.call(this.i.playlists)};g.Ki=function(){z.prototype.cl.call(this.i.playlists)};g.wh=function(){z.prototype.$k.call(this.i.playlists)};
g.play=function(){null===this.c&&(this.c=new M(this.i,this.N+"-sound",this.j),this.c.volume=this.i.playlists.volume*this.i.playlists.playlist.volume,!0===this.f&&(this.c.loop=this.f),this.c.onPlay.add(this.yh,this),this.c.onStop.add(this.Li,this),this.c.onPause.add(this.xh,this),this.c.onResume.add(this.Ki,this),this.c.onEnded.add(this.wh,this));this.c.play()};g.stop=function(){null!==this.c&&this.c.stop(!0)};g.pause=function(){null!==this.c&&this.c.pause()};g.resume=function(){null!==this.c&&this.c.resume()};
g.destroy=function(){this.u=this.i=null;this.m.destroy();this.m=null;this.o.destroy();this.o=null;null!==this.c&&(this.c.onPlay.remove(this.yh,this),this.c.onStop.remove(this.Li,this),this.c.onPause.remove(this.xh,this),this.c.onResume.remove(this.Ki,this),this.c.onEnded.remove(this.wh,this),this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(fd.prototype,"name",{get:function(){return this.m.value}});Object.defineProperty(fd.prototype,"author",{get:function(){return this.o.value}});
Object.defineProperty(fd.prototype,"currentTime",{get:function(){return null!==this.c?this.c.currentTime:0},set:function(a){null!==this.c&&(this.c.currentTime=a)}});Object.defineProperty(fd.prototype,"volume",{get:function(){return null!==this.c?this.c.volume:!1},set:function(a){if(null===this.c)return!1;this.c.volume=a}});Object.defineProperty(fd.prototype,"ready",{get:function(){return null!==this.c?this.c.ready:!1}});
Object.defineProperty(fd.prototype,"decoded",{get:function(){return null!==this.c?this.c.decoded:!1}});Object.defineProperty(fd.prototype,"playing",{get:function(){return null!==this.c?this.c.playing:!1}});Object.defineProperty(fd.prototype,"paused",{get:function(){return null!==this.c?this.c.paused:!1}});Object.defineProperty(fd.prototype,"loop",{get:function(){return this.f},set:function(a){this.f=!!a}});Object.defineProperty(fd.prototype,"onPlay",{get:function(){if(null!==this.c)return this.c.onPlay}});
Object.defineProperty(fd.prototype,"onStop",{get:function(){if(null!==this.c)return this.c.onStop}});Object.defineProperty(fd.prototype,"onPause",{get:function(){if(null!==this.c)return this.c.onPause}});Object.defineProperty(fd.prototype,"onResume",{get:function(){if(null!==this.c)return this.c.onResume}});Object.defineProperty(fd.prototype,"onEnded",{get:function(){if(null!==this.c)return this.c.onEnded}});
function sa(a){this.i=a;this.j=this.c=null;this.M=this.V=this.ba=!1;this.J=-1;this.I=this.o=null;l.call(this,"Director");this.Le()}sa.prototype=Object.create(l.prototype);g=sa.prototype;g.constructor=sa;g.Le=function(){this.o=this.i.clock.create(!1);this.i.story.onSceneLoadComplete.add(this.Xi,this);this.i.onReady.add(this.fh,this)};g.load=function(a){if(null!==a.tracks&&Array.isArray(a.tracks))for(var b=0,d=a.tracks.length;b<d;b++)new Cc(a.tracks[b])};
g.fh=function(){this.i.controllers.onControlStart.add(this.ed,this);this.i.controllers.onControlEnd.add(this.dd,this)};
g.Xi=function(){var a=this.i.story.scene;this.stop();gd(this);this.c=null;this.j=[];"undefined"!==typeof a.config.director&&(a=a.config.director.animation,"undefined"!==typeof a&&null!==a&&!1!==a.enabled&&(this.ba="boolean"===typeof a.loop?a.loop:!1,this.V="boolean"===typeof a.random?a.random:!1,this.M="boolean"===typeof a.stoppable?a.stoppable:!1,this.J="number"===typeof a.idleTime?a.idleTime:0,null!==a.tracks&&B.Fa(a.tracks,"string")&&(this.j=!0===this.V?B.rd(a.tracks):a.tracks),this.i.renderer.camera.animation.onComplete.add(this.Mi,
this),"undefined"!==typeof this.i.story.scene.config.media&&this.i.story.scene.config.media.type===Ja.VIDEO&&(this.i.renderer.media.displayObject.onPause.add(this.ae,this),this.i.renderer.media.displayObject.onWaiting.add(this.Xb,this),this.i.renderer.media.displayObject.onStalled.add(this.Xb,this),this.i.renderer.media.displayObject.onEnded.add(this.Ai,this),this.i.renderer.media.displayObject.onCurrentTimeChange.add(this.aj,this),document.addEventListener(I.Ng,null)),"number"===typeof a.delay&&
(this.I=this.o.add(a.delay,this.Lf,this),this.o.start())))};g.ae=function(){this.stop();this.i.renderer.media.displayObject.onPause.remove(this.ae,this);this.i.renderer.media.displayObject.onPlay.add(this.Nf,this);this.i.controllers.onControlStart.remove(this.ed,this);this.i.controllers.onControlEnd.remove(this.dd,this)};
g.Nf=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPause.add(this.ae,this);this.i.renderer.media.displayObject.onPlay.remove(this.Nf,this);this.i.controllers.onControlStart.add(this.ed,this);this.i.controllers.onControlEnd.add(this.dd,this)};
g.Xb=function(){this.stop();this.i.renderer.media.displayObject.onWaiting.remove(this.Xb,this);this.i.renderer.media.displayObject.onStalled.remove(this.Xb,this);this.i.renderer.media.displayObject.onPlaying.add(this.Of,this);this.i.controllers.onControlStart.remove(this.ed,this);this.i.controllers.onControlEnd.remove(this.dd,this)};
g.Of=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPlaying.remove(this.Of,this);this.i.renderer.media.displayObject.onWaiting.add(this.Xb,this);this.i.renderer.media.displayObject.onStalled.add(this.Xb,this);this.i.controllers.onControlStart.add(this.ed,this);this.i.controllers.onControlEnd.add(this.dd,this)};g.Ai=function(){!0===this.i.renderer.media.displayObject.loop&&this.Xi()};g.ed=function(){null!==this.c&&!0===this.M&&this.stop();this.o.stop(!0)};
g.dd=function(){null!==this.I&&this.o.remove(this.I);null!==this.c&&!0===this.M&&(null===this.c&&"number"===typeof this.i.story.scene.config.director.animation.delay?(this.I=this.o.add(this.i.story.scene.config.director.animation.delay,this.Lf,this),this.o.start()):"number"===typeof this.J&&-1<this.J&&(this.I=this.o.add(this.J,this.Lf,this),this.o.start()))};
g.Mi=function(){if(1<this.j.length){var a=this.j.indexOf(this.c)+1;if(a<this.j.length){this.play(a);return}}!0===this.ba&&(!0===this.V&&(this.j=B.rd(this.j)),this.play(0))};g.Lf=function(){this.play(this.c);this.o.stop(!0)};
g.aj=function(a){this.stop();this.c=null;"number"===typeof a?a*=1E3:"number"===typeof a.data?a=1E3*a.data:a=this.i.renderer.media.displayObject.currentTimeMS;var b=0,d,e;e=p.get(this.j[0]);if(e.duration>a)this.c=e.uid;else for(var h=1,k=this.j.length-1;h<k;h++){d=e;e=p.get(this.j[h]);if(d.duration+b<a&&e.duration+d.duration+b>a){this.c=e.uid;break}b+=d.duration}null===this.c?(a=e.keyframes[e.keyframes.length-1].data,this.i.renderer.camera.ik(a.yaw,a.pitch,a.roll,a.fov)):this.i.renderer.camera.animation.play(this.c)};
g.play=function(a){this.stop();this.c=null;this.c="number"===typeof a?this.j[a]:"string"===typeof a?a:this.j[0];this.i.renderer.camera.animation.play(this.c)};g.stop=function(){this.i.renderer.camera.animation.stop()};
function gd(a){a.i.renderer.camera.animation.onComplete.remove(a.Mi,a);"undefined"!==typeof a.i.story.scene.config.media&&a.i.story.scene.config.media.type===Ja.VIDEO&&(a.i.renderer.media.displayObject.onPlay.remove(a.Nf,a),a.i.renderer.media.displayObject.onPause.remove(a.ae,a),a.i.renderer.media.displayObject.onWaiting.remove(a.Xb,a),a.i.renderer.media.displayObject.onStalled.remove(a.Xb,a),a.i.renderer.media.displayObject.onPlaying.remove(a.Of,a),a.i.renderer.media.displayObject.onEnded.remove(a.Ai,
a),a.i.renderer.media.displayObject.onCurrentTimeChange.remove(a.aj,a))}g.destroy=function(){gd(this);this.i.onReady.remove(this.fh,this);this.c=this.j=this.i=null;l.prototype.destroy.call(this)};function Cc(a){this.G=this.o=!1;Lb.call(this,"DirectorTrack");this.j(a)}Cc.prototype=Object.create(Lb.prototype);Cc.prototype.constructor=Cc;Cc.prototype.j=function(a){this.o=a.smooth;this.G=a.cancelRoll;Lb.prototype.j.call(this,a)};Object.defineProperty(Cc.prototype,"smooth",{get:function(){return this.o}});
Object.defineProperty(Cc.prototype,"cancelRoll",{get:function(){return this.G}});function hc(a){this.i=a;this.f=[];l.call(this,"ActionEventDispatcher")}hc.prototype=Object.create(l.prototype);hc.prototype.constructor=hc;hc.prototype.c=function(a){if(!0===B.Fa(a,"string")||B.T(a,"string"))this.f=this.f.concat(a)};hc.prototype.D=function(){for(var a=0,b=this.f.length;a<b;a++){var d=this.i.actions.get(this.f[a]);"undefined"!==typeof d&&null!==d&&d.yb()}};hc.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};
function hd(a,b){this.i=a;this.j=b;this.la="";this.c=this.f=null;l.call(this,"Action");a=this.j;this.N=a.uid;this.la=a.target;this.f="undefined"!==typeof a.method?a.method:null;this.c="undefined"!==typeof a.property?a.property:null;ba(this)}hd.prototype=Object.create(l.prototype);hd.prototype.constructor=hd;var id={Cf:"set",$h:"add",ri:"substract",ji:"multiply",ei:"divide",si:"toggle"};
function jd(a,b){var d=null;if("undefined"===typeof b)d=window;else{var e=b,h=b;"object"===typeof b&&("string"===typeof b.identifier&&(e=b.identifier),"string"===typeof b.accessor&&(h=b.accessor));b=p.get(e);"undefined"!==typeof b&&null!==b&&(B.T(b,"Plugin")?d=b.instance:d=b);h=h.split(".");b=0;"viewer"===h[0].toLowerCase()&&(d=a.i,b=1);for(e=h.length;b<e;b++)"object"===typeof d[h[b]]&&(d=d[h[b]])}null===d&&a.warn("The target of the action "+a.N+" is invalid.");return d}
hd.prototype.yb=function(){var a=jd(this,this.la);if(null!==a){if(null!==this.c){var b=this.c;if("undefined"!==typeof a[b.name])switch("undefined"===typeof b.operation&&(b.operation=id.Cf),b.operation){case id.Cf:a[b.name]=b.value;break;case id.$h:a[b.name]+=b.value;break;case id.ri:a[b.name]-=b.value;break;case id.ji:a[b.name]*=b.value;break;case id.ei:a[b.name]/=b.value;break;case id.si:a[b.name]=!a[b.name]}}if(null!==this.f&&(b=this.f,"function"===typeof a[b.name])){var d="undefined"!==typeof b.args?
b.args:null;Array.isArray(d)||(d=[d]);a[b.name].apply(a,d)}}};hd.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(hd.prototype,"target",{get:function(){return jd(this,this.la)}});Object.defineProperty(hd.prototype,"count",{get:function(){return 0}});function ra(a){this.i=a;this.c=[];l.call(this,"ActionManager")}ra.prototype=Object.create(l.prototype);ra.prototype.constructor=ra;ra.prototype.get=function(a){return p.get(a,"Action")};
ra.prototype.ja=function(a){var b;if(!0===Array.isArray(a))for(var d=0,e=a.length;d<e;d++)b=new hd(this.i,a[d]),this.c.push(b);else b=new hd(this.i,a),this.c.push(b)};ra.prototype.destroy=function(){if(B.Fa(this.c,"Action"))for(;0<this.c.length;)this.c.pop().destroy()};
function Q(a,b,d,e){this.i=a;this.G=b;this.H=d;this.A=this.I=null;this.V=e;this.c=this.j=this.L=this.J=null;this.R=!1;this.C=this.F=this.B=this.f=this.m=null;this.O=this.U=!0;this.u=this.o=null;l.call(this,"Plugin");this.N=this.H.uid;this.Wa=this.H.tags;ba(this);this.C={}}Q.prototype=Object.create(l.prototype);g=Q.prototype;g.constructor=Q;
function kd(a){a.A=B.Za(a.G.defaultConfig,a.H,a.I);a.J=a.A.options||{};a.gb=a.A.data||{};a.L=a.A.actions||{};for(var b in a.j)a.j[b].destroy(),a.j[b]=null;b=a.A.events;a.j={};var d,e;for(e in b)d=new hc(a.i),d.c(b[e]),a.j[e]=d}g.ck=function(){!0===this.G.loaded?ld(this):this.G.onLoadComplete.fa(this.lm,this)};g.lm=function(){ld(this)};
function ld(a){a.log("Plugin._instantiatePlugin(); "+a.N);var b=a.H;"string"===typeof b.parent&&(a.m=b.parent);a.U="boolean"===typeof b.keep?b.keep:!0;a.O="boolean"===typeof b.reset?b.reset:!0;null===a.F&&!0===B.Fa(b.scenes,"string")&&(a.F=b.scenes);kd(a);a.c=a.G.Kj(a);a.c.boot.call(a.c);null!==a.o&&a.o.D()}g.Yn=function(){this.R=!0;null!==this.u&&this.u.D()};g.update=function(){null!==this.c&&"function"===typeof this.c.update&&this.c.update.call(this.c)};
g.uk=function(){kd(this);null!==this.c&&("function"===typeof this.c.reset?this.c.reset.call(this.c):this.warn("There is no reset function on plugin "+this.G.uid))};
g.destroy=function(){if(!1!==this.hb){null!==this.c&&(this.c.viewer=null,this.c.plugin=null,this.c.destroy(),this.c=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.u&&(this.u.destroy(),this.u=null);for(var a=this.j.length;a--;)this.j[a].destroy();this.C=this.i=this.j=null;l.prototype.destroy.call(this)}};Object.defineProperty(Q.prototype,"fullUrl",{get:function(){return this.G.fullUrl}});
Object.defineProperty(Q.prototype,"options",{get:function(){return this.J}});Object.defineProperty(Q.prototype,"actions",{get:function(){return this.L}});Object.defineProperty(Q.prototype,"events",{get:function(){return this.j}});Object.defineProperty(Q.prototype,"scenes",{get:function(){return this.F}});Object.defineProperty(Q.prototype,"persistentData",{get:function(){return this.C},set:function(a){this.C=a}});Object.defineProperty(Q.prototype,"instance",{get:function(){return this.c}});
Object.defineProperty(Q.prototype,"instanceReady",{get:function(){return this.R}});Object.defineProperty(Q.prototype,"container",{get:function(){if(null===this.f){if("string"===typeof this.m&&""!==this.m){this.m=document.getElementById(this.m);if("undefined"===typeof this.m||null===this.m||!1===ha.ng(this.m))throw"$_Plugin.boot : Plugin parent is invalid";this.f=new t(this.i,null,null,this.m)}else this.f=new t(this.i),this.i.pluginContainer.Yb(this.f),this.f.Db(!0);this.f.id=this.N;this.f.index=this.V}return this.f}});
Object.defineProperty(Q.prototype,"create",{get:function(){null===this.B&&(this.B=new R(this.i,this));return this.B}});Object.defineProperty(Q.prototype,"keep",{get:function(){return this.U}});Object.defineProperty(Q.prototype,"reset",{get:function(){return this.O}});Object.defineProperty(Q.prototype,"contextualConfig",{get:function(){return this.I},set:function(a){this.I=a}});Object.defineProperty(Q.prototype,"instanceConfig",{get:function(){return this.H}});
Object.defineProperty(Q.prototype,"config",{get:function(){return this.A}});Object.defineProperty(Q.prototype,"onInstanceCreate",{get:function(){null===this.o&&(this.o=new q(this,!0));return this.o}});Object.defineProperty(Q.prototype,"onInstanceReady",{get:function(){null===this.u&&(this.u=new q(this,!0));return this.u}});
function md(a){l.call(this,"PluginEngine");this.i=a;this.B=null;this.o=this.O=this.j=this.J="";this.I=null;this.u="";this.A=null;this.F="";this.m=this.G=this.C=this.H=this.f=null;this.R=0;this.L=!1;this.c=null}md.prototype=Object.create(l.prototype);md.prototype.constructor=md;var nd=["boot","destroy"],od=["viewer","plugin"];g=md.prototype;
g.load=function(a){if("undefined"!==typeof a){a=this.B=a;if("undefined"===typeof a.uid)throw"Can't load a plugin engine, missing id in config";this.N=a.uid;ba(this);this.J="string"===typeof a.prefix?a.prefix:this.i.plugins.prefix;if("undefined"===typeof a.url)throw"Can't load a plugin engine, missing url in config";this.j=a.url;this.o=this.J+this.j;this.O="string"===typeof a.manifest?a.manifest:"manifest.json";this.i.load.json(this.N,this.o+this.O,this.wm,this);return!0}return!1};
g.Kj=function(a){for(var b=new this.f,d=0,e=od.length;d<e;d++)if("undefined"!==typeof b[od[d]])throw"$_PluginEngine instance validation failed, "+od[d]+" is reserved";if(null!==this.m)for(d=0,e=this.m.length;d<e;d++)if("function"!==typeof b[this.m[d]])throw"$_PluginEngine instance validation failed, action "+this.m[d]+" is undefined on plugin "+this.F;b.i=this.i;b.Wb=a;return b};
g.wm=function(a){a=this.I=this.i.cache.get(A.JSON,a.key).data;if(this.N!==a.uid)throw"Plugin Engine UID doesn't match with manifest UID";var b=a.viewer,d="0.0.0",e="9.9.9";"undefined"!==typeof b&&("undefined"!==typeof b.min&&(d=b.min),"undefined"!==typeof b.max&&(e=b.max));for(var b=["0","9","1"],d=d.split("."),e=e.split("."),h=0,k=0,n=0,v=Math.max(b.length,d.length,e.length)-1;0<=v;v--)"undefined"!==typeof b[v]&&(h=parseInt(b[v],10)),"undefined"!==typeof d[v]&&(k=parseInt(d[v],10)),"undefined"!==
typeof e[v]&&(n=parseInt(e[v],10));if(!1===(h<k||h>n?!1:!0))this.warn("Version compatibility check for plugin "+a.uid+" failed!"),this.warn(a.viewer);else if(!1===I.check(a.device))this.warn("Device compatibility check for plugin "+a.uid+" failed!"),this.warn(a.device);else{"undefined"!==typeof a.options&&(this.C=a.options);"undefined"!==typeof a.data&&(this.gb=a.data);"undefined"!==typeof a.actions&&(this.m=a.actions);"undefined"!==typeof a.events&&(this.G=a.events);this.u=a.name;this.A=a.sources;
this.F=a.constructor;b=null;if("undefined"!==typeof a.i18n&&(b=a.i18n,"undefined"!==typeof b.locales))for(d=0,e=b.locales.length;d<e;d++)if(a=b.locales[d],"undefined"!==typeof a.files)for(k=0,n=a.files.length;k<n;k++)h=a.files[k],h.key=this.N+"-"+h.key,h.url=this.o+h.url;this.H=b;a=this.A;b=0;for(d=a.length;b<d;b++)e="http://"===String(a[b]).substring(0,7)||"https://"===String(a[b]).substring(0,8)?a[b]:this.o+a[b],"css"===Da(e).extension?this.i.load.rj(e,this.Fi,this):this.i.load.Gg(e,this.Fi,this)}this.log("$_Plugin._manifestLoadComplete();")};
g.Fi=function(){this.R++;if(this.R===this.A.length){var a;a:{a=this.F;if("string"===typeof a&&""!==a){a=a.split(".");for(var b=window,d=0,e=a.length;d<e;d++){if(d===a.length-1&&"function"===typeof b[a[d]]){a=b[a[d]];break a}if("object"===typeof b[a[d]])b=b[a[d]];else break}}a=null}this.f=a;!0===pd(this)&&(a=this.H,null!==a&&this.i.i18n.ja(a),this.L=!0,null!==this.c&&this.c.D())}};
function pd(a){if(null===a.f||"function"!==typeof a.f)throw"Plugin engine "+a.N+" can't find it's constructor";for(var b=0,d=nd.length;b<d;b++)if("function"!==typeof a.f.prototype[nd[b]])throw"$_PluginEngine engine validation failed, missing required method "+nd[b]+" on plugin engine "+a.u;Object.defineProperty(a.f.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(a.f.prototype,"plugin",{get:function(){return this.Wb}});return!0}
g.destroy=function(){this.H=this.f=this.A=this.u=this.I=this.B=this.i=null;null!==this.c&&(this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(md.prototype,"name",{get:function(){return this.u}});Object.defineProperty(md.prototype,"loaded",{get:function(){return this.L}});Object.defineProperty(md.prototype,"url",{get:function(){return this.j}});Object.defineProperty(md.prototype,"fullUrl",{get:function(){return this.o}});
Object.defineProperty(md.prototype,"options",{get:function(){return this.C}});Object.defineProperty(md.prototype,"actions",{get:function(){return this.m}});Object.defineProperty(md.prototype,"events",{get:function(){return this.G}});Object.defineProperty(md.prototype,"defaultConfig",{get:function(){return{data:this.gb,options:this.C,actions:this.m,events:this.G}}});Object.defineProperty(md.prototype,"onLoadComplete",{get:function(){null===this.c&&(this.c=new q(this));return this.c}});
function pa(a){l.call(this,"PluginManager");this.i=a;this.m=!0;this.u="";this.f=this.c=this.j=null}pa.prototype=Object.create(l.prototype);g=pa.prototype;g.constructor=pa;
g.ll=function(a){a=a.data.uid;for(var b,d=this.c.size;d--;)b=this.c.get(d),(!1===b.keep||null!==b.scenes&&-1===b.scenes.indexOf(a))&&this.remove(b.uid);!0===this.m&&"undefined"!==typeof this.o&&(a=this.o,qd(this,a.engines),rd(this,a.instances),sd(this,a.configurations));!0===this.m&&"undefined"!==typeof this.i.story.scene.config.plugins&&(a=this.i.story.scene.config.plugins,qd(this,a.engines),rd(this,a.instances),sd(this,a.configurations));for(b=this.c.size;b--;)a=this.c.get(b),!0===a.reset&&a.uk()};
function qd(a,b){if("undefined"!==typeof b)for(var d=0,e=b.length;d<e;d++){var h=b[d];if("string"===typeof h.uid&&!1===p.Sa(h.uid)){var k=new md(a.i);a.j.add(k);k.load(h)}}}
function rd(a,b){if("undefined"!==typeof b)for(var d=0,e=b.length;d<e;d++){var h=!1!==b[d].enabled?!0:!1,k=a.ge(b[d].uid),n=a.i.story.sceneUid,v=B.Fa(b[d].scenes,"string")?b[d].scenes:[],n=0===v.length||""===n&&0===v.length||-1!==v.indexOf(n);if(!0===h&&null===k&&!0===n){h=a;k=b[d];if("undefined"===typeof k.engine)throw"Can't create plugin instance, engineUid is undefined";a:{for(var v=h,y=k.engine,D=0,db=v.j.size;D<db;D++)if(n=v.j.get(D),n.uid===y)break a;n=null}if(null===n)throw"Plugin Engine "+
k.engine+" doesn't exist";k=new Q(h.i,n,k,"number"===typeof k.index?k.index:h.c.size);k.onInstanceCreate.fa(h.Em,h);h.c.add(k);k.ck()}}}function sd(a,b){if("undefined"!==typeof b)for(var d=0,e=b.length;d<e;d++){var h=!1!==b[d].enabled?!0:!1,k=a.ge(b[d].instance),n=null;!0===h&&(n=b[d]);null!==k&&(k.contextualConfig=n)}}g.Em=function(a){a=a.emitter;null!==this.f&&this.f.D(a)};g.boot=function(){this.j=new td;this.c=new td;this.i.story.onSceneLoadStart.add(this.ll,this)};
g.ja=function(a){this.o=a;this.m="boolean"===typeof a.enabled?a.enabled:!0;this.u="string"===typeof a.prefix?a.prefix:"./plugins/"};g.ge=function(a){for(var b,d=0,e=this.c.size;d<e;d++)if(b=this.c.get(d),b.uid===a)return b;return null};g.Ij=function(a){a=this.c.get(a);return"undefined"!==typeof a?a:null};g.get=function(a){var b=null;"string"===typeof a?b=this.ge(a):"number"===typeof a&&(b=this.Ij(a));return b};g.remove=function(a){a=this.get(a);a.destroy();this.c.remove(a)};
g.update=function(){for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),a.update()};g.render=function(){};g.destroy=function(){this.i=null;null!==this.f&&(this.f.destroy(),this.f=null);for(var a=0,b=this.j.size;a<b;a++)this.j.get(a).destroy();this.j=null;a=0;for(b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(pa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(pa.prototype,"enabled",{get:function(){return this.m}});
Object.defineProperty(pa.prototype,"prefix",{get:function(){return this.u}});Object.defineProperty(pa.prototype,"onInstanceCreate",{get:function(){null===this.f&&(this.f=new q(this,!0));return this.f}});function R(a,b){this.i=a;this.Wb=b;this.$=[];l.call(this,"PluginObjectFactory")}R.prototype=Object.create(l.prototype);g=R.prototype;g.constructor=R;g.jb=function(a){a:{for(var b=this.$.length,d;b--;)if(d=this.$[b],d===a.emitter){a=b;break a}a=-1}this.$.splice(a,1)};
g.jo=function(a){a=new za(this.i,a);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.ko=function(a){a=new S(this.i,a);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.sound=function(a,b){a=new M(this.i,a,b);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.yn=function(a){a=new t(this.i,a);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.nl=function(a){a=new T(this.i,a);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};
g.image=function(a,b){var d=a;"string"===typeof a&&(d={key:null,url:a});d.key=this.Wb.uid+"-"+d.key;!1!==b&&(d.url=this.Wb.fullUrl+d.url);a=new Ma(this.i,d);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.ho=function(a,b){a.key=this.Wb.uid+"-"+a.key;!1!==b&&(a.url=this.Wb.fullUrl+a.url,a.frames=this.Wb.fullUrl+a.frames);a=new ud(this.i,a);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.ml=function(a){a=new vd(this.i,a);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};
g.pl=function(a,b,d,e,h){var k;"undefined"!==typeof d&&d.toLowerCase()===Na.df?k=new J(this.i,a,b,e):k=new K(this.i,a,b,e,h);k.onDestroy.fa(this.jb,this);this.$.push(k);return k};g.canvas=function(){var a=new ia(this.i);a.onDestroy.fa(this.jb,this);this.$.push(a);return a};g.ol=function(a){a=new Fb(this.i,a);a.onDestroy.fa(this.jb,this);this.i.tween.add(a);this.$.push(a);return a};g.vj=function(){this.log("destroyAllObjects();");for(var a=this.$.length;a--;)this.$[a].destroy()};
g.destroy=function(){this.vj();this.$=this.Wb=this.i=null;l.prototype.destroy.call(this)};
var I=function(a){a=a();a.prototype=Object.create(null);a.prototype.constructor=a;a.prototype.dm=function(){if(/Playstation Vita/.test(this.ca))this.ab="Playstation Vita",this.Og=!0;else if(/Xbox/.test(this.ca))this.ab="Xbox",this.Yg=!0;else if(/Kindle/.test(this.ca)||/\bKF[A-Z][A-Z]+/.test(this.ca)||/Silk.*Mobile Safari/.test(this.ca))this.ab="Kindle",this.qg=!0;else if(/Windows Phone/i.test(this.ca)||/IEMobile/i.test(this.ca))this.ab="Windows Phone",this.Ie=!0,/Windows Phone (\d+)/.test(this.ca)&&
(this.ac=parseInt(RegExp.$1,10));else if(/Android/.test(this.ca))this.ab="Android",this.jj=!0,/Android ([\.\_\d]+)/.test(this.ca)&&(this.ac=parseInt(RegExp.$1,10));else if(/CrOS/.test(this.ca))this.ab="Chrome OS",this.Wf=!0;else if(/iP[ao]d|iPhone/i.test(this.ca))this.ab="iOS",this.Jc=!0,/OS (\d+)/.test(navigator.appVersion)&&(this.ac=parseInt(RegExp.$1,10));else if(/(Linux|X11)/.test(this.ca))this.ab="Linux",this.rg=!0;else if(/Mac OS X/.test(this.ca))this.ab="Mac OS X",this.vg=!0,/Mac OS X (10[\.\_\d]+)/.test(this.ca)&&
(this.ac=parseInt(RegExp.$1,10));else if(/Windows/.test(this.ca)||/WPDesktop/i.test(this.ca))/WPDesktop/i.test(this.ca)?(this.ab="Windows Phone",this.Ie=!0):(this.ab="Windows",this.Wg=!0),/(Windows 10.0|Windows NT 10.0)/.test(this.ca)?this.ac=10:/(Windows 8.1|Windows NT 6.3)/.test(this.ca)||/(Windows 8|Windows NT 6.2)/.test(this.ca)?this.ac=8:/(Windows 7|Windows NT 6.1)/.test(this.ca)&&(this.ac=7)};a.prototype.Vl=function(){this.$b="undefined"!==typeof document.documentMode;this.wb=!1===this.$b&&
!0===!!window.StyleMedia;this.dg="undefined"!==typeof window.InstallTrigger;this.opera=!0===!!window.opr||0<=this.ca.indexOf(" OPR/")||0<=this.ca.indexOf("Opera");this.td=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);this.chrome=!1===this.$b&&!1===this.wb&&!1===this.opera&&(!0===!!window.chrome||0<=this.ca.indexOf("CriOS"));if(this.wb)this.lb="Edge",/Edge\/(\d+)/.test(this.ca)&&(this.Ya=this.xj=parseInt(RegExp.$1,10));else if(this.chrome)this.lb="Chrome",/CriOS\/(\d+)/.test(this.ca)?
this.Ya=this.Xf=parseInt(RegExp.$1,10):/Chrome\/(\d+)/.test(this.ca)&&(this.Ya=this.Xf=parseInt(RegExp.$1,10));else if(this.dg)this.lb="Firefox",/Firefox\D+(\d+)/.test(this.ca)&&(this.Ya=this.Bj=parseInt(RegExp.$1,10));else if(this.qg)/Silk/.test(this.ca)&&(this.lb="Silk",this.Jg=!0);else if(this.$b)this.lb="Internet Explorer",/MSIE (\d+\.\d+);/.test(this.ca)?this.Ya=this.mg=parseInt(RegExp.$1,10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(this.ca)&&(this.Ya=this.mg=parseInt(RegExp.$3,10));else if(this.opera)this.lb=
"Opera",/OPR\/(\d+)/.test(this.ca)?this.Ya=this.xe=parseInt(RegExp.$1,10):0<=this.ca.indexOf("Opera/")?/Version\/(\d+)/.test(this.ca)&&(this.Ya=this.xe=parseInt(RegExp.$1,10)):/Opera (\d+)/.test(this.ca)&&(this.Ya=this.xe=parseInt(RegExp.$1,10));else if(this.td)this.lb="Safari",/version\/(\d+(\.\d+)?)/i.test(this.ca)&&(this.Ya=this.wk=parseInt(RegExp.$1,10));else{var a=this.ca.match(/Android.*AppleWebKit\/([\d.]+)/);a&&537>a[1]&&(this.lb="Android Stock",this.ek=!0,this.Ya=this.kj=parseFloat(this.ca.slice(this.ca.indexOf("Android")+
8)))}navigator.j&&(this.Ik=!0);this.sk="CSS1Compat"===document.compatMode?!1:!0};a.prototype.Xl=function(){this.pc=window.devicePixelRatio||1;this.ak=!0===this.Jc&&-1!==this.ca.toLowerCase().indexOf("iphone");this.bk=!0===this.Jc&&-1!==this.ca.toLowerCase().indexOf("ipod");this.lg=!0===this.Jc&&-1!==this.ca.toLowerCase().indexOf("ipad");this.vk=2<=this.pc&&!0===this.Jc;this.Wg&&!this.Ie||this.vg||this.rg&&!this.Jg||this.Wf?this.Hc=!0:/Mobi/i.test(this.ca)&&!1===this.lg?this.te=!0:this.Lg=!0;if(/TV/i.test(this.ca)||
!0===this.Og||!0===this.Yg||this.Hc&&/Windows NT/i.test(this.ca)&&/Touch/i.test(this.ca))this.nk=!0,this.Hc=this.Lg=this.te=!1};a.prototype.fm=function(){var a=document.createElement("video");try{"function"===typeof a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(this.Ag=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.yg=this.hg=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(this.Vg=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,
"")&&(this.Pg=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.kg=!0))}catch(d){}};a.prototype.Tl=function(){this.Uf="undefined"!==typeof window.Audio;this.Rg="undefined"!==typeof window.AudioContext||"undefined"!==typeof window.webkitAudioContext;var a=document.createElement("audio");try{if("function"===typeof a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.zg=!0);a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.wg=
!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))this.ye=!0;a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.Qg=!0);a.canPlayType("audio/aac;").replace(/^no$/,"")&&(this.Qf=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.ug=!0;if(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.xg=!0;
a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.Tg=this.Ug=!0)}}catch(d){}};a.prototype.Yl=function(){this.Mg="undefined"!==typeof navigator.Mg||"undefined"!==typeof navigator.o||"undefined"!==typeof navigator.c||"undefined"!==typeof navigator.f;this.Vf="function"===typeof navigator.getBattery};a.prototype.$l=function(){this.canvas="undefined"!==typeof window.CanvasRenderingContext2D;if(!0===this.canvas){this.oj="function"===typeof document.createElement("canvas").getContext("2d").fillText;
var a=document.createElement("canvas").getContext("2d");a.rect(0,0,10,10);a.rect(2,2,6,6);this.pj=!1===a.isPointInPath(5,5,"evenodd")}try{this.localStorage="object"===typeof window.localStorage&&"function"===typeof window.localStorage.getItem}catch(e){this.localStorage=!1}this.kk="function"===typeof window.MediaSource;this.yj="function"===typeof window.HTMLMediaElement&&"function"===typeof window.N&&"function"===typeof window.f&&"function"===typeof navigator.N;this.applicationCache="object"===typeof window.applicationCache;
this.addEventListener="function"===typeof window.addEventListener;this.raf="function"===typeof window.requestAnimationFrame||"function"===typeof window.webkitRequestAnimationFrame||"function"===typeof window.mozRequestAnimationFrame;try{var d=document.createElement("canvas");d.f=!1;this.Sg="function"===typeof d.getContext&&"undefined"!==typeof window.WebGLRenderingContext&&!(!d.getContext("webgl")&&!d.getContext("experimental-webgl"))}catch(e){this.Sg=!1}this.He="function"===typeof navigator.getVRDisplays?
!0:!1;this.JSON="object"===typeof window.JSON&&"function"===typeof window.JSON.parse&&"function"===typeof window.JSON.stringify;this.geolocation="object"===typeof navigator.geolocation;this.history="object"===typeof window.history&&"function"===typeof window.history.pushState;this.Ak="function"===typeof document.createElementNS&&"function"===typeof document.createElementNS("http://www.w3.org/2000/svg","svg").c;this.contextMenu="undefined"!==typeof document.documentElement.contextMenu&&"function"===
typeof window.HTMLMenuItemElement};a.prototype.Zl=function(){this.gk=/^https/i.test(window.location.protocol);try{this.og=window.self!==window.top}catch(b){this.og=!0}};a.prototype.cm=function(){this.Ck="undefined"!==typeof window.ontouchstart||"undefined"!==typeof window.c&&document instanceof window.c||"number"===typeof navigator.maxTouchPoints&&0<navigator.maxTouchPoints||"number"===typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints;if("undefined"!==typeof window.j||"undefined"!==
typeof window.m)this.Dk=!(!MouseEvent.f||!MouseEvent.c);this.Hj="function"===typeof navigator.getGamepads||"function"===typeof navigator.webkitGetGamepads};a.prototype.am=function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen mozRequestFullScreen mozRequestFullscreen msRequestFullscreen msRequestFullScreen".split(" "),d="cancelFullscreen cancelFullScreen exitFullscreen exitFullScreen webkitCancelFullscreen webkitCancelFullScreen webkitExitFullscreen webkitExitFullScreen mozCancelFullscreen mozCancelFullScreen mozExitFullscreen mozExitFullScreen msCancelFullscreen msCancelFullScreen msExitFullscreen msExitFullScreen".split(" "),
e=document.createElement("div"),h=0,k=a.length;h<k;h++)if(e[a[h]]){this.requestFullscreen=a[h];break}a=0;for(e=d.length;a<e;a++)if(document[d[a]]){this.exitFullscreen=d[a];break}"function"===typeof window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.Fj=!0);d=["fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement"];a=0;for(e=d.length;a<e;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenElement=d[a];break}d=["fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled",
"msFullscreenEnabled"];a=0;for(e=d.length;a<e;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenEnabled=d[a];break}};a.prototype.Ul=function(){for(var a=["visibilitychange","mozvisibilitychange","webkitvisibilitychange","msvisibilitychange"],d=["hidden","mozHidden","webkitHidden","msHidden"],e=0,h=d.length;e<h;e++)if("undefined"!==typeof document[d[e]]){this.visibilityState=d[e];this.Ng=a[e];break}a=["orientation","mozOrientation","msOrientation"];d=0;for(e=a.length;d<e;d++)if("string"===
typeof screen[a[d]]){this.orientation=a[d];break}this.xk="object"===typeof screen.orientation&&"string"===typeof screen.orientation.type&&"function"===typeof screen.orientation.lock;a=["lockOrientation","mozLockOrientation","msLockOrientation"];d=["unlockOrientation","mozUnlockOrientation","msUnlockOrientation"];e=0;for(h=a.length;e<h;e++)if("function"===typeof screen[a[e]]){this.hk=a[e];this.Ek=d[e];break}this.file="undefined"!==typeof window.File&&"undefined"!==typeof window.FileReader&&"undefined"!==
typeof window.FileList&&"undefined"!==typeof window.Blob;this.Aj="undefined"!==typeof window.requestFileSystem||"undefined"!==typeof window.webkitRequestFileSystem;this.rk="undefined"!==typeof document.f||"undefined"!==typeof document.c||"undefined"!==typeof document.N};a.prototype.Wl=function(){var a=document.createElement("a").style;a.cssText="pointer-events:auto";this.jd="auto"===a.pointerEvents;a.cssText="background-color:rgba(150,255,150,.5)";this.uj=-1<(""+a.backgroundColor).indexOf("rgba");
this.tj="undefined"!==typeof a.animationName||"undefined"!==typeof a.webkitAnimationName||"undefined"!==typeof a.m||"undefined"!==typeof a.o;var a=document.createElement("p"),d,e={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var h in e)"undefined"!==typeof a.style[h]&&(a.style[h]="translate3d(1px,1px,1px)",d=window.getComputedStyle(a).getPropertyValue(e[h]));document.body.removeChild(a);
this.sj="undefined"!==typeof d&&0<d.length&&"none"!==d};a.prototype.jm=function(a){null!==a.rotationRate&&"undefined"!==typeof a.rotationRate.alpha&&"undefined"!==typeof a.rotationRate.beta&&"undefined"!==typeof a.rotationRate.gamma&&(this.$f=!0);"undefined"!==typeof a.acceleration&&"undefined"!==typeof a.acceleration.x&&"undefined"!==typeof a.acceleration.y&&"undefined"!==typeof a.acceleration.z&&(this.Zf=!0);this.Qi();"function"!==typeof this.Fc&&this.Hf()};a.prototype.km=function(a){"undefined"!==
typeof a.alpha&&"undefined"!==typeof a.beta&&"undefined"!==typeof a.gamma&&(this.bg=!0);this.Ri();"function"!==typeof this.Ec&&this.Hf()};a.prototype.Qi=function(){window.removeEventListener("devicemotion",this.Ec,!1);this.Ec=null};a.prototype.Ri=function(){window.removeEventListener("deviceorientation",this.Fc,!1);this.Fc=null};a.prototype.bm=function(){this.Yf="undefined"!==typeof window.DeviceMotionEvent;this.ag="undefined"!==typeof window.DeviceOrientationEvent;window.addEventListener("deviceorientation",
this.Fc,!1);window.addEventListener("devicemotion",this.Ec,!1)};a.prototype.em=function(){var a=document.createElement("div");a.style.width="1in";a.style.height="1in";document.body.appendChild(a);this.wj=a.offsetWidth;document.body.removeChild(a);this.te?(this.Fg=Math.floor(Math.min(window.screen.width,window.screen.height)*this.pc),this.Eg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.pc)):(this.Fg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.pc),this.Eg=
Math.floor(Math.min(window.screen.width,window.screen.height)*this.pc))};a.prototype.Sl=function(){this.ca=navigator.userAgent;this.language=navigator.languages&&navigator.languages[0]||navigator.language||navigator.m||"";this.dm();this.Vl();this.Xl();this.Tl();this.fm();this.Yl();this.$l();this.Zl();this.Ul();this.am();this.cm();this.Wl();this.Ec=this.jm.bind(this);this.Fc=this.km.bind(this);this.bm();this.em();!1===this.Yf&&!1===this.ag&&this.Hf()};a.prototype.Hf=function(){"function"===typeof this.Ec&&
this.Qi();"function"===typeof this.Fc&&this.Ri();!0===this.$f&&!0===this.Zf&&!0===this.bg&&(this.Uj=!0);this.ready=!0;Object.freeze(I)};a.prototype.vn=function(a){return"mp3"===a&&!0===this.wg||"ogg"===a&&(!0===this.zg||!0===this.ye)||"m4a"===a&&!0===this.ug||"mp4"===a&&!0===this.xg||"opus"===a&&!0===this.ye||"wav"===a&&!0===this.Qg||"aac"===a&&!0===this.Qf||"webm"===a&&!0===this.Ug||"weba"===a&&!0===this.Tg?!0:!1};a.prototype.wn=function(a){if("webm"!==a||!0!==this.Vg&&!0!==this.Pg)if("mp4"!==a||
!0!==this.yg&&!0!==this.hg){if(("ogg"===a||"ogv"===a)&&!0===this.Ag||"mpeg"===a&&!0===this.kg)return!0}else return!0;else return!0;return!1};a.prototype.Tn=function(){return navigator.getBattery().then(function(a){return this.Vf&&!a.charging&&.2>=a.level}.bind(this),function(){return!1})};a.prototype.check=function(a){if("undefined"===typeof a)return!0;for(var b in a)if("undefined"===typeof this[b])this.warn("Unable to check plugin device compatibility for: "+b);else if(this[b]!==a[b])return!1;return!0};
return new a}(function(){return function(){this.ready=!1;this.ab=this.language=this.ca="";this.ac=0;this.dg=this.Ie=this.Wg=this.vg=this.rg=this.Jc=this.Wf=this.jj=this.qg=this.Yg=this.Og=!1;this.Bj=0;this.chrome=!1;this.Xf=0;this.$b=!1;this.mg=0;this.opera=!1;this.xe=0;this.wb=!1;this.xj=0;this.td=!1;this.wk=0;this.Jg=!1;this.lb="";this.Ya=0;this.ek=this.Ik=!1;this.kj=0;this.sk=!1;this.fullscreenElement=this.exitFullscreen=this.requestFullscreen=this.fullscreenEnabled="";this.lg=this.bk=this.vk=
this.ak=this.Fj=!1;this.pc=1;this.og=this.gk=this.Ak=this.history=this.JSON=this.yj=this.kk=this.contextMenu=this.rk=this.geolocation=this.applicationCache=this.localStorage=this.Aj=this.file=this.He=this.Sg=this.raf=this.addEventListener=this.oj=this.pj=this.canvas=this.kg=this.Pg=this.Vg=this.yg=this.hg=this.Ag=this.Tg=this.Ug=this.Qf=this.xg=this.ug=this.Qg=this.ye=this.wg=this.zg=this.Rg=this.Uf=this.Dk=this.Hj=this.Ck=this.nk=this.te=this.Lg=this.Hc=this.Vf=this.Mg=!1;this.Ng=this.visibilityState=
"";this.bg=this.$f=this.Zf=this.ag=this.Yf=this.Uj=this.tj=this.jd=this.uj=this.sj=!1;this.Fc=this.Ec=null;this.Eg=this.Fg=this.wj=0;this.xk=!1;this.Ek=this.hk=this.orientation="";this.Sl()}});function la(a){this.i=a;this.m=!1;this.c=null;this.j=!1;this.f=null}g=la.prototype;g.constructor=la;
g.boot=function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;b++)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"];this.f=window};
g.start=function(a){this.f="undefined"!==typeof a&&(a===window||a instanceof VRDisplay)?a:window;this.j=!0;"undefined"===typeof this.f.requestAnimationFrame||"timeout"===this.i.config.update?(this.m=!0,this.c=function(){!0===this.j&&(this.i.update(0),this.N=window.setTimeout(this.c.bind(this),1E3/30))},this.N=window.setTimeout(this.c.bind(this),0)):(this.m=!1,this.c=function(a){!0===this.j&&(this.i.update(Math.floor(a)),this.N=this.f.requestAnimationFrame(this.c.bind(this)))},this.N=this.f.requestAnimationFrame(this.c.bind(this)))};
g.stop=function(){this.m?clearTimeout(this.N):(this.f.cancelAnimationFrame(this.N),this.N=null);this.j=!1};g.destroy=function(){this.stop();this.f=this.c=this.i=null};Object.defineProperty(la.prototype,"running",{get:function(){return this.j}});function na(a){this.i=a;this.c=!1;l.call(this,"History")}na.prototype=Object.create(l.prototype);na.prototype.constructor=na;var wd={enabled:!0};g=na.prototype;
g.oh=function(){this.log("_addState");var a=this.i.story.scene,b={viewer:{uid:this.i.uid},scene:{uid:a.uid},locale:this.i.i18n.locale},d=window.history.state;null===d?window.history.replaceState(b,a.name,xd(a)):d.scene.uid!==b.scene.uid&&window.history.pushState(b,a.name,xd(a))};
g.nh=function(){this.log("_updateState");var a=window.history.state,b;null===a?b=!1:(b="undefined"!==typeof a.scene&&"string"===typeof a.scene.uid,b=!0===("undefined"!==typeof a.viewer&&"string"===typeof a.viewer.uid)&&!0===b);b&&(b=p.get(a.scene.uid),a.locale=this.i.i18n.locale,window.history.replaceState(a,b.name,xd(b)))};
function xd(a){for(var b=/(?:#|&)(\w+)=(\w+)/g,d=window.location.hash,e=b.exec(d),h="";null!==e;)"uid"!==e[1]&&(h+="&"+e[1]+"="+e[2]),e=b.exec(d);return"#"+a.slug+"&uid="+a.uid+h}g.Ji=function(a){if(null!==a.state){var b=p.get(a.state.viewer.uid);b.history.log("_onPopStateHandler");b.story.scene=a.state.scene.uid}};
g.ja=function(a){this.f=B.mb(wd,a);this.c="boolean"===typeof this.f.enabled?this.f.enabled:!0;!0===this.c&&(this.i.story.onSceneLoadStart.add(this.oh,this),this.i.i18n.onLocaleChangeComplete.add(this.nh,this),window.addEventListener("popstate",this.Ji,!1))};g.destroy=function(){this.i.story.onSceneLoadStart.remove(this.oh,this);this.i.i18n.onLocaleChangeComplete.remove(this.nh,this);window.removeEventListener("popstate",this.Ji,!1);this.i=null;l.prototype.destroy.call(this)};
Object.defineProperty(na.prototype,"enabled",{get:function(){return this.c}});function q(a,b){this.o=a;this.j=b||!1;this.c=this.m=null;this.f=!0;l.call(this,"EventDispatcher")}q.prototype=Object.create(l.prototype);g=q.prototype;g.constructor=q;
function yd(a,b,d,e,h){if("function"!==typeof b)a.warn("You're trying to add an undefined listener");else if(!0===a.has(b,e))a.warn("You're trying to add a duplicate listener for this context");else{b=new zd(a,b,d,e,h);null===a.c&&(a.c=[]);if(a.c.length){d=a.c.length;do d--;while(a.c[d]&&b.Pf<=a.c[d].Pf);a.c.splice(d+1,0,b)}else a.c.push(b);!0===a.j&&!0===a.f&&null!==a.m&&b.yb(a.m)}}
function Ad(a,b,d){if(null===a.c)return-1;"undefined"===typeof d&&(d=null);for(var e,h=0,k=a.c.length;h<k;h++)if(e=a.c[h],e.listener===b&&e.context===d)return h;return-1}g.add=function(a,b,d){yd(this,a,!1,b,d)};g.fa=function(a,b,d){yd(this,a,!0,b,d)};g.remove=function(a,b){a=Ad(this,a,b);-1!==a&&(this.c[a].destroy(),this.c.splice(a,1))};g.has=function(a,b){return-1!==Ad(this,a,b)};
g.D=function(a,b){!0===this.j&&(this.m=void 0===a?null:a);if(!1!==this.f&&null!==this.c)for(var d=this.c.length;d--;)this.c[d].yb(a,b)};g.destroy=function(){if(!1!==this.hb){if(null!==this.c){for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null}this.m=this.o=null;l.prototype.destroy.call(this)}};Object.defineProperty(q.prototype,"emitter",{get:function(){return this.o}});Object.defineProperty(q.prototype,"memorize",{get:function(){return this.j},set:function(a){this.j=!!a}});
Object.defineProperty(q.prototype,"active",{get:function(){return this.f},set:function(a){this.f=!!a}});function Bd(a,b){this.f=a;this.c=b||null}Bd.prototype.constructor=Bd;Object.defineProperty(Bd.prototype,"emitter",{get:function(){return this.f}});Object.defineProperty(Bd.prototype,"data",{get:function(){return this.c}});function zd(a,b,d,e,h){this.j=a;this.c=b;this.f=e||null;this.o=d||!1;this.Pf=h||0;this.m=0;this.N=!1}g=zd.prototype;g.constructor=zd;
g.Ci=function(a){this.c.call(this.f,new Bd(this.j.emitter,a));this.m++;!0===this.o&&this.qh();this.N=!1};g.yb=function(a,b){null!==this.c&&(!0===b&&!1===this.N?(this.N=!0,window.setTimeout(this.Ci.bind(this,a),0)):!0!==b&&this.Ci(a))};g.qh=function(){return this.j.remove(this.c,this.f)};g.destroy=function(){this.f=this.c=this.j=null};Object.defineProperty(zd.prototype,"listener",{get:function(){return this.c}});Object.defineProperty(zd.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(zd.prototype,"priority",{get:function(){return this.Pf}});Object.defineProperty(zd.prototype,"callCount",{get:function(){return this.m}});function ma(a){this.i=a;this.c=null;this.f=-1;this.o="";this.u=!0;this.j=this.m=null;l.call(this,"LocaleManager");this.log("$_LocaleManager._boot();");this.c=new td}ma.prototype=Object.create(l.prototype);g=ma.prototype;g.constructor=ma;
g.ja=function(a){this.u="boolean"===typeof a.enabled?a.enabled:!0;"undefined"!==typeof a.auto&&!0===a.auto&&""!==I.language?this.o=I.language:"string"===typeof a["default"]&&(this.o=a["default"]);if(!1===this.u)this.warn("$_LocaleManager: locale management is deactivated");else if("undefined"!==typeof a.locales){for(var b=!1,d=0,e=a.locales.length;d<e;d++){var h;var k=a.locales[d],n=Cd(this,k.uid);-1===n?(h=new Dd(this.i),h.f.add(this.vm,this),n=this.c.add(h)-1):h=this.c.get(n);h.ja(k);n===this.f||
this.o.toLowerCase()===k.uid.toLowerCase()?(h.sg(),-1===this.f&&Ed(this,n),h=!0):h=!1;!0===h&&(b=!0)}!1===b&&(-1===Cd(this,this.o)&&(this.o=a.locales[0].uid),Ed(this,Cd(this,a.locales[0].uid)))}};function Cd(a,b){for(var d,e=0,h=a.c.size;e<h;e++)if(d=a.c.get(e),d.uid.toLowerCase()===b.toLowerCase())return e;return-1}
function Ed(a,b){if(0>b||b>=a.c.size)throw"The locale you are trying to set doesn't exist";a.f===b?a.warn("$_LocaleManager: You're trying to set a locale that is already the actual locale"):(a.f=b,null!==a.m&&a.m.D(),a.c.get(a.f).sg())}g.vm=function(){this.log("$_LocaleManager._localeAllFilesLoaded();");null!==this.j&&this.j.D()};
g.Zb=function(a,b){if(-1===this.f)return this.warn("$_LocaleManager: You trying to get a value with no locale selected!"),a;var d=this.c.get(this.f).Zb(a,b),e=Cd(this,this.o);this.f!==e&&-1!==e&&d===a&&(d=this.c.get(e).Zb(a,b));return d};g.xb=function(a,b){if(-1===this.f)return!1;var d=this.c.get(this.f).xb(a,b),e=Cd(this,this.o);this.f!==e&&-1!==e&&!1===d&&(d=this.c.get(e).xb(a,b));return d};
g.destroy=function(){this.i=null;if(null!==this.c){for(var a=0,b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null}null!==this.m&&(this.m.destroy(),this.m=null);null!==this.j&&(this.j.destroy(),this.j=null);l.prototype.destroy.call(this)};Object.defineProperty(ma.prototype,"locale",{get:function(){return-1!==this.f?this.c.get(this.f).uid:""},set:function(a){var b;"number"===typeof a&&a<this.c.size?b=a:"string"===typeof a&&(b=Cd(this,a));Ed(this,b)}});
Object.defineProperty(ma.prototype,"localeIndex",{get:function(){return this.f},set:function(a){"number"===typeof a&&a<this.c.size&&Ed(this,a)}});Object.defineProperty(ma.prototype,"localeObject",{get:function(){return-1!==this.f?this.c.get(this.f):null}});Object.defineProperty(ma.prototype,"locales",{get:function(){for(var a=[],b=0,d=this.c.size;b<d;b++)a.push(this.c.get(b).uid);return a}});
Object.defineProperty(ma.prototype,"onLocaleChangeRequest",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});Object.defineProperty(ma.prototype,"onLocaleChangeComplete",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});function za(a,b,d,e){this.i=a;this.c=b;this.m=d;this.j=e;this.f=null;l.call(this,"LocaleString")}za.prototype=Object.create(l.prototype);za.prototype.constructor=za;za.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};
Object.defineProperty(za.prototype,"key",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(za.prototype,"jsonKey",{get:function(){return this.m},set:function(a){this.m=a}});Object.defineProperty(za.prototype,"value",{get:function(){if(""===this.i.i18n.locale)return"undefined"!==typeof this.j?this.j:this.c;this.f=this.i.i18n.Zb(this.c,this.m);this.f===this.c&&"undefined"!==typeof this.j&&(this.f=this.j);return this.f}});
Object.defineProperty(za.prototype,"loaded",{get:function(){var a=this.i.i18n.Zb(this.c,this.m);return"undefined"!==typeof a&&a!==this.c}});function Dd(a){this.i=a;this.m="";this.f=this.j=this.c=null;l.call(this,"Locale");this.c=new td;this.j=new q(this);this.f=new q(this)}Dd.prototype=Object.create(l.prototype);g=Dd.prototype;g.constructor=Dd;
g.ja=function(a){"string"===typeof a.uid&&(this.N=a.uid);""===this.m&&"string"===typeof a.name&&(this.m=a.name);if("undefined"!==typeof a.files)for(var b,d=0,e=a.files.length;d<e;d++)b=a.files[d],null===Fd(this,b.key)&&(b.Bb=!1,b.loaded=!1,this.c.add(b));this.log("Locale.addConfig(); number of files : "+this.c.size)};
g.sg=function(){if(!0===Gd(this))return this.f.D(),!0;for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),!1===a.Bb&&!1===a.loaded&&!1===a.Bb&&!1===a.loaded&&(a.Bb=!0,this.i.load.json(a.key,a.url,this.tm,this))};function Fd(a,b){for(var d,e=0,h=a.c.size;e<h;e++)if(d=a.c.get(e),d.key===b)return d;return null}g.tm=function(a){a=Fd(this,a.key);a.Bb=!1;a.loaded=!0;this.log("loadFileComplete(); "+a.key);this.j.D();!0===Gd(this)&&this.f.D()};
function Gd(a){for(var b,d=0,e=a.c.size;d<e;d++)if(b=a.c.get(d),!1===b.loaded)return!1;return!0}g.Zb=function(a,b){for(var d,e=0,h=this.c.size;e<h;e++)if(d=this.c.get(e),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(A.JSON,d.key),"undefined"!==typeof d.data[a]))return d.data[a];"undefined"!==typeof b&&(this.warn("$_Locale: value not found into the specified JSON file, try to find it in all files."),this.Zb(a));return a};
g.xb=function(a,b){for(var d,e=0,h=this.c.size;e<h;e++)if(d=this.c.get(e),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(A.JSON,d.key),"undefined"!==typeof d.data[a]))return!0;"undefined"!==typeof b&&(this.warn("$_Locale: key not found into the specified JSON file, try to find it in all files."),this.xb(a));return!1};
g.rh=function(a,b){for(var d,e=0,h=this.c.size;e<h;e++)if(d=this.c.get(e),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)){d=this.i.cache.get(A.JSON,d.key);for(var k in d.data)if(d.data[k]===a)return k}"undefined"!==typeof b&&(this.warn("$_Locale: value not found into the specified JSON file, try to find it in all files."),this.rh(a))};g.destroy=function(){this.c=this.i=null;this.j.destroy();this.j=null;this.f.destroy();this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(Dd.prototype,"name",{get:function(){return this.m}});function ua(a){this.i=a;this.j=!0;this.o=this.m=this.f=this.c=null;l.call(this,"Keyboard");this.c=[];this.f=[];this.m=this.qm.bind(this);this.o=this.rm.bind(this);window.addEventListener("keydown",this.m,!1);window.addEventListener("keyup",this.o,!1)}ua.prototype=Object.create(l.prototype);g=ua.prototype;g.constructor=ua;
g.qm=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyDown "+b);-1===this.f.indexOf(b)?(this.f.push(b),b=!0):b=!1;!0===b&&Hd(this,a)}};
g.rm=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyUp "+b);b=this.f.indexOf(b);-1!==b?(this.f.splice(b,1),b=!0):b=!1;if(!0===b)a:if(b=a.keyCode,!0!==this.pg(b))for(var b=this.fg(b),d,e=0,h=b.length;e<h;e++){d=b[e];for(var k=0,n=this.f.length;k<n;k++)if(d.ne(this.f[k]))break a;d.Fk(a);k=0;for(n=this.f.length;k<n;k++)if(d.ig(this.f[k])){var v=new KeyboardEvent("keydown",{vo:this.f[k],ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey});Hd(this,v)}}}};
function Id(a,b){if(null===a.c||!a.c.length)return-1;if("object"===typeof b&&"KeyBinding"===b.type)return a.c.indexOf(b);if("number"===typeof b)for(var d=0,e=a.c.length;d<e;d++)if(!0===a.c[d].ne(b))return d;return-1}function Hd(a,b){var d=b.keyCode;if(!0!==a.pg(d)){a=a.fg(d);for(var e=0,h=a.length;e<h;e++)d=a[e],!1===d.pressed&&d.ph(b)}}g.update=function(){for(var a,b=0,d=this.c.length;b<d;b++)if(a=this.c[b],!0===a.pressed){if(!0===a.hasToWaitToHold&&!1===a.downComplete)break;a.$j()}};
g.Sn=function(a){return-1!==this.f.indexOf(a)};g.pg=function(a){for(var b,d=0,e=this.c.length;d<e;d++)if(b=this.c[d],!0===b.pressed&&!0===b.ig(a))return!0;return!1};g.Sf=function(a){if("object"!==typeof a&&"KeyBinding"!==a.type)return!1;if(-1===Id(this,a))return this.c.push(a),!0;this.warn("Trying to add a duplicate key binding on keyboard!");return!1};g.Be=function(a){a=Id(this,a);return-1!==a?(this.c[a].destroy(),this.c.splice(a,1),!0):!1};g.In=function(a){return-1!==Id(this,a)};
g.fg=function(a){for(var b=[],d=0,e=this.c.length;d<e;d++)!0===this.c[d].ne(a)&&b.push(this.c[d]);return b};g.destroy=function(){this.i=null;window.removeEventListener("keydown",this.m,!1);window.removeEventListener("keyup",this.o,!1);for(var a=this.c.length;a--;)this.Be(this.c[a]);this.o=this.m=this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(ua.prototype,"enabled",{get:function(){return this.j},set:function(a){this.j=!!a}});
function O(a,b,d,e,h,k,n,v){this.i=a;this.G=b||[];this.o=d||null;this.B=e||null;this.u=h||null;this.A=k||null;this.f=n||this;this.L=v||"";this.Jf=this.H=this.I=!1;this.F=this.C=this.fd=0;this.m=this.j=this.c=null;l.call(this,"KeyBinding");if(!0===B.T(this.o,"string")||B.Fa(this.o,"string"))this.c=new hc(this.i),this.c.c(this.o);if(!0===B.T(this.u,"string")||B.Fa(this.u,"string"))this.j=new hc(this.i),this.j.c(this.u);if(!0===B.T(this.B,"string")||B.Fa(this.B,"string"))this.m=new hc(this.i),this.m.c(this.B)}
O.prototype=Object.create(l.prototype);g=O.prototype;g.constructor=O;g.ne=function(a){return"number"===typeof this.G&&this.G===a?!0:"function"===typeof this.G.indexOf?-1!==this.G.indexOf(a):!1};g.ig=function(a){if(null!==this.A){if("number"===typeof this.A&&this.A===a)return!0;if("function"===typeof this.A.indexOf)return-1!==this.A.indexOf(a)}return!1};g.ph=function(a){this.log("down");this.fd++;this.H=!0;"function"===typeof this.o?this.o.call(this.f,this,a):null!==this.c&&this.c.D()};
g.oo=function(){this.I=!0;var a=this.fd;return function(){this.log("downCompleteCallback "+a+" "+this.fd);a===this.fd&&(this.Jf=!0)}.bind(this)};g.Fk=function(a){this.log("up");this.F++;this.Jf=this.H=!1;"function"===typeof this.B?this.B.call(this.f,this,a):null!==this.m&&this.m.D()};g.$j=function(){this.log("hold");this.C++;"function"===typeof this.u?this.u.call(this.f,this):null!==this.j&&this.j.D()};
g.destroy=function(){this.f=this.A=this.u=this.B=this.o=this.G=null;null!==this.c&&(this.c.destroy(),this.c=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};Object.defineProperty(O.prototype,"name",{get:function(){return this.L}});Object.defineProperty(O.prototype,"pressed",{get:function(){return this.H}});Object.defineProperty(O.prototype,"downCount",{get:function(){return this.fd}});
Object.defineProperty(O.prototype,"upCount",{get:function(){return this.F}});Object.defineProperty(O.prototype,"holdCount",{get:function(){return this.C}});Object.defineProperty(O.prototype,"hasToWaitToHold",{get:function(){return this.I}});Object.defineProperty(O.prototype,"downComplete",{get:function(){return this.Jf}});
function Jd(a){this.f=this.K=a;this.J=!1;this.c=null;this.j="";this.G=this.L=null;this.I=this.C=this.H=!1;this.m=null;this.R=200;this.F=this.O=1;this.U=Kd.LINEAR;this.B=this.u=this.A=this.o=null;l.call(this,"Drag");this.F=this.K.alpha}Jd.prototype=Object.create(l.prototype);g=Jd.prototype;g.constructor=Jd;
function Ld(a,b){null!==a.f&&(null!==a.f&&(a.f.pointer.onPanStart.remove(a.lh,a),a.f.pointer.onPanMove.remove(a.kh,a),a.f.pointer.onPanEnd.remove(a.jh,a)),a.f=null);a.f=b;a.f.pointer.enabled=!0;a.f.pointer.onPanStart.add(a.lh,a);a.f.pointer.onPanMove.add(a.kh,a);a.f.pointer.onPanEnd.add(a.jh,a)}
g.lh=function(a){this.log("_panStartHandler");var b=a.data;a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);if(b=!0!==this.I&&b.target===this.f.dom){if(null===this.c)b=!0;else var b=this.K.globalOffset,d=this.c.globalOffset,e=b.left+this.K.pixelWidth>d.left+this.c.innerWidth,h=b.top<d.top,k=b.top+this.K.pixelHeight>d.top+this.c.innerHeight,b=!0===b.left<d.left||!0===e||!0===h||!0===k?!1:!0;b=!1!==b}b&&(this.H=!0,this.L={x:this.K.x,y:this.K.y},this.K.top=
null,this.K.right=null,this.K.bottom=null,this.K.left=null,this.G={x:a.pageX,y:a.pageY},this.O=this.K.alpha,this.K.alpha=this.F,null!==this.o&&this.o.D())};g.jh=function(){this.log("_panEndHandler");!0===this.H&&(this.H=!1,null!==this.u&&this.u.D(),!0===this.C&&null!==this.m?(this.I=!0,this.m.bf({x:this.L.x,y:this.L.y},this.R,this.U).start()):this.K.alpha=this.O,this.G=this.L=null)};
g.kh=function(a){this.log("_panMoveHandler");if(!0===this.H){a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);var b={x:a.pageX,y:a.pageY};a=b.x-this.G.x;var d=b.y-this.G.y;this.G=b;if(null!==this.c){var b=this.K.globalOffset,e=this.K.parent.globalOffset,h=this.c.globalOffset;if(""===this.j||"x"===this.j)b.left+a<h.left?(this.log("out left"),this.K.x=Math.abs(e.left-h.left)):b.left+a+this.K.pixelWidth>h.left+this.c.innerWidth?(this.log("out right"),
this.K.x=Math.abs(e.left-h.left)+this.c.innerWidth-this.K.pixelWidth):this.K.x+=a;if(""===this.j||"y"===this.j)b.top+d<h.top?(this.log("out top"),this.K.y=Math.abs(e.top-h.top)):b.top+d+this.K.pixelHeight>h.top+this.c.innerHeight?(this.log("out bottom"),this.K.y=Math.abs(e.top-h.top)+this.c.innerHeight-this.K.pixelHeight):this.K.y+=d}else{if(""===this.j||"x"===this.j)this.K.x+=a;if(""===this.j||"y"===this.j)this.K.y+=d}null!==this.A&&this.A.D()}};
g.Ti=function(){this.log("_revertCompleteHandler");this.I=!1;this.K.alpha=this.O;null!==this.B&&this.B.D()};g.enable=function(){this.J=!0;Ld(this,this.f)};g.mh=function(){this.J=!1};g.destroy=function(){this.revert=!1;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.B&&(this.B.destroy(),this.B=null);this.G=this.c=this.K=this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(Jd.prototype,"enabled",{get:function(){return this.J},set:function(a){!0===!!a?this.enable():this.mh()}});Object.defineProperty(Jd.prototype,"dragging",{get:function(){return this.H}});Object.defineProperty(Jd.prototype,"handle",{get:function(){return this.f},set:function(a){Ld(this,a)}});Object.defineProperty(Jd.prototype,"constrain",{get:function(){return this.c},set:function(a){this.c=a}});
Object.defineProperty(Jd.prototype,"progress",{get:function(){if(null!==this.c){var a=this.K.globalOffset,b=this.c.globalOffset;return{x:(a.left-b.left)/(this.c.innerWidth-this.K.pixelWidth),y:(a.top-b.top)/(this.c.innerHeight-this.K.pixelHeight)}}}});Object.defineProperty(Jd.prototype,"axis",{get:function(){return this.j},set:function(a){"x"===a||"y"===a?this.j=a:this.j=""}});Object.defineProperty(Jd.prototype,"alpha",{get:function(){return this.F},set:function(a){"number"===typeof a&&(this.F=a)}});
Object.defineProperty(Jd.prototype,"reverting",{get:function(){return this.I}});Object.defineProperty(Jd.prototype,"revert",{get:function(){return this.C},set:function(a){this.C=!!a;!0===this.C&&null===this.m?(this.m=new Fb(this.K.viewer,this.K),this.m.onComplete.add(this.Ti,this),this.K.viewer.tween.add(this.m)):!1===this.C&&null!==this.m&&(this.K.viewer.tween.remove(this.m),this.m.onComplete.remove(this.Ti,this),this.m.destroy(),this.m=null)}});
Object.defineProperty(Jd.prototype,"revertDuration",{get:function(){return this.R},set:function(a){"number"===typeof a&&(this.R=a)}});Object.defineProperty(Jd.prototype,"revertEasing",{get:function(){return this.U},set:function(a){"function"===typeof a&&(this.U=a)}});Object.defineProperty(Jd.prototype,"onStart",{get:function(){null===this.o&&(this.o=new q(this.K));return this.o}});Object.defineProperty(Jd.prototype,"onDrag",{get:function(){null===this.A&&(this.A=new q(this.K));return this.A}});
Object.defineProperty(Jd.prototype,"onStop",{get:function(){null===this.u&&(this.u=new q(this.K));return this.u}});Object.defineProperty(Jd.prototype,"onRevert",{get:function(){null===this.B&&(this.B=new q(this.K));return this.B}});
function U(a){this.K=a;this.c=!1;this.ea=Md.DEFAULT;this.Ra=null;this.vd=[];this.ba=this.f=this.j=this.m=this.A=this.u=this.V=this.O=this.R=this.U=this.C=this.F=this.I=this.B=this.G=this.H=this.L=this.J=this.o=this.M=this.P=this.S=this.aa=this.Z=this.pa=this.ka=this.W=this.wa=this.ia=null;l.call(this,"Pointer");this.Ra=new Hammer.Manager(this.K.dom);this.Ra.set({enable:!1})}U.prototype=Object.create(l.prototype);g=U.prototype;g.constructor=U;
function Nd(a,b,d,e){for(var h,k=0,n=a.vd.length;k<n;k++)if(h=a.vd[k],h.event===b&&h.un===d&&h.type===e)return k;return-1}function Od(a,b,d,e){if(-1===Nd(a,b,d,e))if(a.vd.push({event:b,un:d,type:e}),e===V.Qa)a.K.dom.addEventListener(b,Hammer.bindFn(d,a));else if(e===V.oa)a.Ra.on(b,Hammer.bindFn(d,a))}function Pd(a,b,d){return function(){var e=Nd(this,a,b,d);-1!==e&&(this.vd.splice(e,1),d===V.Qa?this.K.dom.removeEventListener(a,b):d===V.oa&&this.Ra.off(a))}}
g.bj=function(a){null!==this.M&&!0===this.c&&this.M.D(a)};g.yi=function(a){null!==this.o&&!0===this.c&&this.o.D(a)};g.Gh=function(a){null!==this.J&&!0===this.c&&this.J.D(a)};g.Fh=function(a){null!==this.L&&!0===this.c&&this.L.D(a)};g.Bh=function(a){null!==this.H&&!0===this.c&&this.H.D(a)};g.Ah=function(a){null!==this.G&&!0===this.c&&this.G.D(a)};g.zh=function(a){null!==this.B&&!0===this.c&&this.B.D(a)};g.Eh=function(a){null!==this.I&&!0===this.c&&this.I.D(a)};
g.Dh=function(a){null!==this.F&&!0===this.c&&this.F.D(a)};g.Ch=function(a){null!==this.C&&!0===this.c&&this.C.D(a)};g.Wi=function(a){null!==this.U&&!0===this.c&&this.U.D(a)};g.Vi=function(a){null!==this.R&&!0===this.c&&this.R.D(a)};g.Ui=function(a){null!==this.O&&!0===this.c&&this.O.D(a)};g.$i=function(a){null!==this.V&&!0===this.c&&this.V.D(a)};g.Bi=function(a){null!==this.u&&!0===this.c&&this.u.D(a)};g.Di=function(a){null!==this.A&&!0===this.c&&this.A.D(a)};
g.Oi=function(a){null!==this.m&&!0===this.c&&this.m.D(a)};g.Ni=function(a){null!==this.j&&!0===this.c&&this.j.D(a)};g.Ii=function(a){null!==this.f&&!0===this.c&&this.f.D(a)};g.Hh=function(a){null!==this.ba&&!0===this.c&&this.ba.D(a)};
g.enable=function(){!0===I.jd&&(this.K.dom.style.pointerEvents="auto");this.Ra.set({enable:!0});null===this.ia&&(this.ia=new Hammer.Tap,this.Ra.add(this.ia));null===this.wa&&(this.wa=(new Hammer.Tap({event:U.events.Ed,yo:2})).recognizeWith(this.ia),this.Ra.add(this.wa));null===this.W&&(this.W=(new Hammer.Press).recognizeWith(this.ia),this.Ra.add(this.W));null===this.ka&&(this.ka=new Hammer.Pan,this.Ra.add(this.ka));null===this.pa&&(this.pa=new Hammer.Pinch,this.Ra.add(this.pa));null===this.Z&&(this.Z=
(new Hammer.Rotate).recognizeWith(this.pa),this.Ra.add(this.Z));null===this.aa&&(this.aa=(new Hammer.Swipe).recognizeWith(this.ka),this.Ra.add(this.aa));this.c=!0;null!==this.S&&this.S.D()};g.Xe=function(){!0===I.jd&&(this.K.dom.style.pointerEvents="none");this.c=!1;this.Ra.set({enable:!1});null!==this.P&&this.P.D()};
g.destroy=function(){this.Xe();this.aa=this.Z=this.pa=this.ka=this.W=this.wa=this.ia=null;null!==this.S&&(this.S.destroy(),this.S=null);null!==this.P&&(this.P.destroy(),this.P=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.J&&(this.J.destroy(),this.J=null);null!==this.L&&(this.L.destroy(),this.L=null);null!==this.H&&(this.H.destroy(),this.H=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.B&&(this.B.destroy(),this.B=null);
null!==this.I&&(this.I.destroy(),this.I=null);null!==this.F&&(this.F.destroy(),this.F=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.U&&(this.U.destroy(),this.U=null);null!==this.R&&(this.R.destroy(),this.R=null);null!==this.O&&(this.O.destroy(),this.O=null);null!==this.V&&(this.V.destroy(),this.V=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.j&&(this.j.destroy(),this.j=null);
null!==this.f&&(this.f.destroy(),this.f=null);null!==this.ba&&(this.ba.destroy(),this.ba=null);this.K=null;l.prototype.destroy.call(this)};Object.defineProperty(U.prototype,"enabled",{get:function(){return this.c},set:function(a){!0===!!a?this.enable():this.Xe()}});Object.defineProperty(U.prototype,"cursor",{get:function(){return this.ea},set:function(a){this.K.dom.style.cursor=a;if(a!==this.K.dom.style.cursor||""===this.K.dom.style.cursor)this.K.dom.style.cursor="-webkit-"+a;this.ea=a}});
Object.defineProperty(U.prototype,"onEnable",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(U.prototype,"onDisable",{get:function(){null===this.P&&(this.P=new q(this));return this.P}});Object.defineProperty(U.prototype,"onTap",{get:function(){null===this.M&&(this.M=new q(this.K),this.M.onDestroy.fa(Pd(U.events.Ef,this.bj,V.oa),this),Od(this,U.events.Ef,this.bj,V.oa));return this.M}});Object.defineProperty(U.prototype,"onClick",{get:function(){return this.onTap}});
Object.defineProperty(U.prototype,"onDoubleTap",{get:function(){null===this.o&&(this.o=new q(this.K),this.o.onDestroy.fa(Pd(U.events.Ed,this.yi,V.oa),this),Od(this,U.events.Ed,this.yi,V.oa));return this.o}});Object.defineProperty(U.prototype,"onDoubleClick",{get:function(){return this.onDoubleTap}});Object.defineProperty(U.prototype,"onPressStart",{get:function(){null===this.J&&(this.J=new q(this.K),this.J.onDestroy.fa(Pd(U.events.yf,this.Gh,V.oa),this),Od(this,U.events.yf,this.Gh,V.oa));return this.J}});
Object.defineProperty(U.prototype,"onDown",{get:function(){return this.onPressStart}});Object.defineProperty(U.prototype,"onPressEnd",{get:function(){null===this.L&&(this.L=new q(this.K),this.L.onDestroy.fa(Pd(U.events.xf,this.Fh,V.oa),this),Od(this,U.events.xf,this.Fh,V.oa));return this.L}});Object.defineProperty(U.prototype,"onUp",{get:function(){return this.onPressEnd}});
Object.defineProperty(U.prototype,"onPanStart",{get:function(){null===this.H&&(this.H=new q(this.K),this.H.onDestroy.fa(Pd(U.events.sf,this.Bh,V.oa),this),Od(this,U.events.sf,this.Bh,V.oa));return this.H}});Object.defineProperty(U.prototype,"onPanMove",{get:function(){null===this.G&&(this.G=new q(this.K),this.G.onDestroy.fa(Pd(U.events.rf,this.Ah,V.oa),this),Od(this,U.events.rf,this.Ah,V.oa));return this.G}});
Object.defineProperty(U.prototype,"onPanEnd",{get:function(){null===this.B&&(this.B=new q(this.K),this.B.onDestroy.fa(Pd(U.events.qf,this.zh,V.oa),this),Od(this,U.events.qf,this.zh,V.oa));return this.B}});Object.defineProperty(U.prototype,"onPinchStart",{get:function(){null===this.I&&(this.I=new q(this.K),this.I.onDestroy.fa(Pd(U.events.wf,this.Eh,V.oa),this),Od(this,U.events.wf,this.Eh,V.oa));return this.I}});
Object.defineProperty(U.prototype,"onPinchMove",{get:function(){null===this.F&&(this.F=new q(this.K),this.F.onDestroy.fa(Pd(U.events.vf,this.Dh,V.oa),this),Od(this,U.events.vf,this.Dh,V.oa));return this.F}});Object.defineProperty(U.prototype,"onPinchEnd",{get:function(){null===this.C&&(this.C=new q(this.K),this.C.onDestroy.fa(Pd(U.events.uf,this.Ch,V.oa),this),Od(this,U.events.uf,this.Ch,V.oa));return this.C}});
Object.defineProperty(U.prototype,"onRotateStart",{get:function(){null===this.U&&(this.U=new q(this.K),this.U.onDestroy.fa(Pd(U.events.Bf,this.Wi,V.oa),this),Od(this,U.events.Bf,this.Wi,V.oa));return this.U}});Object.defineProperty(U.prototype,"onRotateMove",{get:function(){null===this.R&&(this.R=new q(this.K),this.R.onDestroy.fa(Pd(U.events.Af,this.Vi,V.oa),this),Od(this,U.events.Af,this.Vi,V.oa));return this.R}});
Object.defineProperty(U.prototype,"onRotateEnd",{get:function(){null===this.O&&(this.O=new q(this.K),this.O.onDestroy.fa(Pd(U.events.zf,this.Ui,V.oa),this),Od(this,U.events.zf,this.Ui,V.oa));return this.O}});Object.defineProperty(U.prototype,"onSwipe",{get:function(){null===this.V&&(this.V=new q(this.K),this.V.onDestroy.fa(Pd(U.events.Df,this.$i,V.oa),this),Od(this,U.events.Df,this.$i,V.oa));return this.V}});
Object.defineProperty(U.prototype,"onEnter",{get:function(){null===this.u&&(this.u=new q(this.K),this.u.onDestroy.fa(Pd(U.events.ff,this.Bi,V.Qa),this),Od(this,U.events.ff,this.Bi,V.Qa));return this.u}});Object.defineProperty(U.prototype,"onLeave",{get:function(){null===this.A&&(this.A=new q(this.K),this.A.onDestroy.fa(Pd(U.events.nf,this.Di,V.Qa),this),Od(this,U.events.nf,this.Di,V.Qa));return this.A}});
Object.defineProperty(U.prototype,"onOver",{get:function(){null===this.m&&(this.m=new q(this.K),this.m.onDestroy.fa(Pd(U.events.zc,this.Oi,V.Qa),this),Od(this,U.events.zc,this.Oi,V.Qa));return this.m}});Object.defineProperty(U.prototype,"onOut",{get:function(){null===this.j&&(this.j=new q(this.K),this.j.onDestroy.fa(Pd(U.events.Sb,this.Ni,V.Qa),this),Od(this,U.events.Sb,this.Ni,V.Qa));return this.j}});
Object.defineProperty(U.prototype,"onMove",{get:function(){null===this.f&&(this.f=new q(this.K),this.f.onDestroy.fa(Pd(U.events.pf,this.Ii,V.Qa),this),Od(this,U.events.pf,this.Ii,V.Qa));return this.f}});Object.defineProperty(U.prototype,"onWheel",{get:function(){null===this.ba&&(this.ba=new q(this.K),this.ba.onDestroy.fa(Pd(U.events.Gf,this.Hh,V.Qa),this),Od(this,U.events.Gf,this.Hh,V.Qa));return this.ba}});var V={Qa:0,oa:1};U.events={};U.events.Ef="tap";U.events.Ed="doubletap";U.events.yf="press";
U.events.xf="pressup";U.events.sf="panstart";U.events.rf="panmove";U.events.qf="panend";U.events.wf="pinchstart";U.events.vf="pinchmove";U.events.uf="pinchend";U.events.Bf="rotatestart";U.events.Af="rotatemove";U.events.zf="rotateend";U.events.Df="swipe";U.events.ff="mouseenter";U.events.nf="mouseleave";U.events.zc="mouseover";U.events.Sb="mouseout";U.events.pf="mousemove";U.events.Gf="wheel";var Md={DEFAULT:"default",Xa:"pointer",Hl:"grab",Il:"grabbing"};
function ga(a){this.i=a;this.$=[];this.f=[];this.j=this.c=null;l.call(this,"DisplayList");this.c=this.mm.bind(this);document.addEventListener("fullscreenchange",this.c,!1);document.addEventListener("mozfullscreenchange",this.c,!1);document.addEventListener("webkitfullscreenchange",this.c,!1);document.addEventListener("MSFullscreenChange",this.c,!1)}ga.prototype=Object.create(l.prototype);g=ga.prototype;g.constructor=ga;
g.mm=function(){this.log("_fullScreenChangeHandler");if(null!==document[I.fullscreenElement])for(var a,b=this.$.length;b--;){if(a=this.$[b],a.dom===document[I.fullscreenElement]){a=this.j=a;a.log("_notifyFullscreenEnter");b=a;b.log("_fullscreenSaveData");b.U={x:b.G,y:b.H,width:b.u,unitWidth:b.B,height:b.o,unitHeight:b.A,top:b.Rb,right:b.wa,bottom:b.gc,left:b.ia};b.G=0;b.H=0;b.u=screen.width;b.B="px";b.c.style.width=b.u+"px";b.o=screen.height;b.A="px";b.c.style.height=b.o+"px";b.Rb=null;b.wa=null;
b.gc=null;b.ia=null;b.c.style.top="0";b.c.style.left="0";b.va({property:"both"});null!==a.Ob&&a.Ob.D();break}}else a=this.j,a.log("_notifyFullscreenChange"),a.log("_fullscreenRestoreData"),a.G=a.U.x,a.c.style.left=a.G+"px",a.H=a.U.y,a.c.style.top=a.H+"px",a.u=a.U.width,a.B=a.U.unitWidth,a.c.style.width=a.pixelWidth+"px",a.o=a.U.height,a.A=a.U.unitHeight,a.c.style.height=a.pixelHeight+"px",a.Rb=a.U.top,a.wa=a.U.right,a.gc=a.U.bottom,a.ia=a.U.left,a.va({property:"both"}),a.U=null,null!==a.Pb&&a.Pb.D(),
this.j=null};g.register=function(a,b){this.$.push(a);!0===b&&this.f.push(a)};g.unregister=function(a){this.$.splice(this.$.indexOf(a),1);a=this.f.indexOf(a);-1!==a&&this.f.splice(a,1)};g.update=function(){for(var a=0,b=this.f.length;a<b;a++)this.f[a].update()};
g.destroy=function(){for(var a=this.$.length;a--;)this.$[a].destroy();this.$=[];this.f=[];document.removeEventListener("fullscreenchange",this.c,!1);document.removeEventListener("mozfullscreenchange",this.c,!1);document.removeEventListener("webkitfullscreenchange",this.c,!1);document.removeEventListener("MSFullscreenChange",this.c,!1);this.j=this.c=null};var Qd="DisplayObject DisplayObjectContainer Image TextField Button Video Canvas Sprite Iframe".split(" ");
function T(a,b,d){this.i=a;this.c=b||null;this.m=null;this.oe=0;this.ef="";this.H=this.G=0;this.Jb=!1;this.u=0;this.B="px";this.Ke=1;this.o=0;this.A="px";this.Je=1;this.Dc=this.Bc=!1;this.ia=this.gc=this.wa=this.Rb=null;this.fe=1;this.re=0;this.Ac=this.Cc=null;this.Zc="";this.ad="solid";this.O=0;this.$c="rgb(0, 0, 0)";this.ue=0;this.R=!1;this.wd="";this.gb=null;this.qe=!1;this.V=!0;this.pa=null;this.ba=!1;this.Pb=this.Ob=this.cd=this.kd=this.Kb=this.Mb=this.L=this.Nb=this.Qb=this.ka=this.U=null;l.call(this,
d||"DisplayObject");this.Ga()}T.prototype=Object.create(l.prototype);g=T.prototype;g.constructor=T;
g.Ga=function(){!0!==this.qe&&("undefined"===typeof this.c||null===this.c?this.c=document.createElement("div"):(this.u=ha.Tj(this.c),this.B=ha.Rj(this.c),this.o=ha.Sj(this.c),this.A=ha.Qj(this.c)),this.c.style.width=this.u+""+this.B,this.c.style.height=this.o+""+this.A,this.c.style.display="block",this.c.style.position="relative",this.c.style.margin="0px",this.c.style.padding="0px",this.c.style.top=this.H+"px",this.c.style.left=this.G+"px",this.c.style.overflow="hidden",this.c.style.boxSizing="border-box",
!0===I.jd&&(this.c.style.pointerEvents="none"),this.c.style.N="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none",this.c.style.borderStyle=this.ad,this.c.style.borderWidth=this.O+"px",this.c.style.borderColor=this.$c,this.c.style.background=this.Zc,this.pa=[],"DisplayObject"===this.Ua&&(this.i.display.register(this),Rd(this),Sd(this)))};function Rd(a){!0!==a.qe&&(a.log("_notifyReady"),a.qe=!0,null!==a.ka&&a.ka.D())}
g.Vd=function(){this.log("_notifyAddedToDom");null!==this.Kb&&this.Kb.D()};g.lc=function(){this.log("_notifyShow");!1!==this.pd()&&null!==this.kd&&!0===this.visible&&this.kd.D()};g.Wd=function(){this.log("_notifyHide");null!==this.cd&&!1===this.visible&&this.cd.D()};g.Mf=function(){null!==this.Nb&&this.Nb.D()};g.va=function(a){Td(this);null!==this.Qb&&this.Qb.D(a)};
function Td(a){null!==a.m&&a.u&&a.o&&(a.log("_updateAnchors"),!0===a.Bc?a.horizontalCenter=!0:(a.left=a.ia,a.right=a.wa),!0===a.Dc?a.verticalCenter=!0:(a.top=a.Rb,a.bottom=a.gc))}
function Ud(a,b){var d=-1!==b.toLowerCase().indexOf("height")||"both"===b;!0===(-1!==b.toLowerCase().indexOf("width")||"both"===b)&&"%"===a.B&&(a.c.style.width=a.pixelWidth+"px",a.c.width=a.pixelWidth,a.va({property:"width"}));!0===d&&"%"===a.A&&(a.c.style.height=a.pixelHeight+"px",a.c.height=a.pixelHeight,a.va({property:"height"}))}function Vd(a,b,d){a.pa.push({prop:b,value:d})}
function Sd(a){a.log("_applyPending");a.V=!1;if(null!==a.pa&&0!==a.pa.length){a.ba=!0;for(var b=0,d=a.pa.length;b<d;b++)a[a.pa[b].prop]=a.pa[b].value;a.ba=!1;a.pa=[]}}g.ih=function(){this.c.style.display="block";this.lc()};g.Zj=function(){this.c.style.display="none";this.Wd()};g.mo=function(){this.visible=!this.visible};
g.Db=function(a){!0===a&&(this.R=!0,!0===this.V&&Vd(this,"maximized",!0));null!==this.m&&(this.Jb=!1,a=this.pixelWidth,this.u=this.m.innerWidth,this.B="px",this.c.style.width=this.m.innerWidth+"px",this.c.width=this.m.innerWidth,a!==this.pixelWidth&&this.va({property:"width"}),a=this.pixelHeight,this.o=this.m.innerHeight,this.A="px",this.c.style.height=this.m.innerHeight+"px",this.c.height=this.m.innerHeight,a!==this.pixelHeight&&this.va({property:"height"}))};g.pd=function(){return ha.has(this.c)};
g.hh=function(a,b){null!==a&&"undefined"!==typeof a&&(this.width=a);null!==b&&"undefined"!==typeof b&&(this.height=b)};g.Dj=function(){if(!0===document[I.fullscreenEnabled]&&!1===this.od())this.c[I.requestFullscreen]()};g.Ej=function(){if(!0===document[I.fullscreenEnabled]&&!0===this.od())document[I.exitFullscreen]()};g.od=function(){return document[I.fullscreenElement]===this.c};
g.destroy=function(){!1!==this.hb&&(this.i.display.unregister(this),null!==this.m&&(this.m.removeChild(this,!1),this.m=null),null!==this.Cc&&(this.Cc.destroy(),this.Cc=null),null!==this.Ac&&(this.Ac.destroy(),this.Ac=null),null!==this.Qb&&(this.Qb.destroy(),this.Qb=null),null!==this.Nb&&(this.Nb.destroy(),this.Nb=null),null!==this.ka&&(this.ka.destroy(),this.ka=null),null!==this.Mb&&(this.Mb.destroy(),this.Mb=null),null!==this.Kb&&(this.Kb.destroy(),this.Kb=null),null!==this.Ob&&(this.Ob.destroy(),
this.Ob=null),null!==this.Pb&&(this.Pb.destroy(),this.Pb=null),this.i=this.gb=this.c=null,l.prototype.destroy.call(this))};Object.defineProperty(T.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(T.prototype,"dom",{get:function(){return this.c}});Object.defineProperty(T.prototype,"id",{get:function(){return this.ef},set:function(a){this.ef=a;this.c.id=this.ef}});Object.defineProperty(T.prototype,"ready",{get:function(){return this.qe}});
Object.defineProperty(T.prototype,"parent",{get:function(){return this.m},set:function(a){"object"===typeof a&&!1!==Array.isArray(a.children)&&a!==this.m&&(this.m=a,this.c.style.position="absolute",!0===this.R&&this.Db(this.R),Ud(this,"both"),Td(this),null!==this.Mb&&this.Mb.D(),!0===this.m.pd()&&(this.Vd(),this.lc()))}});Object.defineProperty(T.prototype,"visible",{get:function(){return"block"===this.c.style.display},set:function(a){"boolean"===typeof a&&(!0===a?this.ih():this.Zj())}});
Object.defineProperty(T.prototype,"x",{get:function(){return this.G},set:function(a){if("number"===typeof a){var b=this.G;this.G=a;this.c.style.left=this.G+"px";null!==this.L&&b!==this.G&&this.L.D({property:"x"})}}});Object.defineProperty(T.prototype,"y",{get:function(){return this.H},set:function(a){if("number"===typeof a){var b=this.H;this.H=a;this.c.style.top=this.H+"px";null!==this.L&&b!==this.H&&this.L.D({property:"y"})}}});
Object.defineProperty(T.prototype,"keepRatio",{get:function(){return this.Jb},set:function(a){"boolean"===typeof a&&a!==this.Jb&&(this.Jb=a)}});
Object.defineProperty(T.prototype,"width",{get:function(){return this.u},set:function(a){var b=this.u,d=this.B;if("string"===typeof a){var e=B.Bg(a);if(null===e.value||null===e.Mc)throw"$_DisplayObject.width value "+a+" is incorrect";this.B=e.Mc;this.u=e.value}else if("number"===typeof a)this.u=a;else return;!0===this.V?Vd(this,"width",this.u):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&d===this.B&&!0!==this.ba||this.va({property:"width"}))}});
Object.defineProperty(T.prototype,"pixelWidth",{get:function(){if("px"===this.B)return this.u;if("%"===this.B)return null!==this.m?this.m.innerWidth*this.u/100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.B;this.u=a;this.B="px";!0===this.V?Vd(this,"pixelWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"px"===d&&!0!==this.ba||this.va({property:"pixelWidth"}))}}});
Object.defineProperty(T.prototype,"percentWidth",{get:function(){if("%"===this.B)return this.u;if("px"===this.B)return null!==this.m?this.u/this.m.innerWidth*100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.B;this.u=a;this.B="%";!0===this.V?Vd(this,"percentWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"%"===d&&!0!==this.ba||this.va({property:"percentWidth"}))}}});
Object.defineProperty(T.prototype,"unitWidth",{get:function(){return this.B},set:function(a){if("string"===typeof a&&("px"===a||"%"===a)){var b=this.B;this.B=a;!0===this.V?Vd(this,"unitWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.B&&!0!==this.ba||this.va({property:"unitWidth"}))}}});Object.defineProperty(T.prototype,"innerWidth",{get:function(){return this.pixelWidth-2*this.O}});
Object.defineProperty(T.prototype,"height",{get:function(){return this.o},set:function(a){var b=this.o,d=this.A;if("string"===typeof a){var e=B.Bg(a);if(null===e.value||null===e.Mc)throw"$_DisplayObject.height value "+a+" is incorrect";this.A=e.Mc;this.o=e.value}else if("number"===typeof a)this.o=a;else return;!0===this.V?Vd(this,"height",this.o):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&d===this.A&&!0!==this.ba||this.va({property:"height"}))}});
Object.defineProperty(T.prototype,"pixelHeight",{get:function(){if("px"===this.A)return this.o;if("%"===this.A)return null!==this.m?this.m.innerHeight*this.o/100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.A;this.o=a;this.A="px";!0===this.V?Vd(this,"pixelHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"px"===d&&!0!==this.ba||this.va({property:"pixelHeight"}))}}});
Object.defineProperty(T.prototype,"percentHeight",{get:function(){if("%"===this.A)return this.o;if("px"===this.A)return null!==this.m?this.o/this.m.innerHeight*100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.A;this.o=a;this.A="%";!0===this.V?Vd(this,"percentHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"%"===d&&!0!==this.ba||this.va({property:"percentHeight"}))}}});
Object.defineProperty(T.prototype,"unitHeight",{get:function(){return this.A},set:function(a){if("string"===typeof a){var b=this.A;this.A=a;!0===this.V?Vd(this,"unitHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.A&&!0!==this.ba||this.va({property:"unitHeight"}))}}});Object.defineProperty(T.prototype,"innerHeight",{get:function(){return this.pixelHeight-2*this.O}});
Object.defineProperty(T.prototype,"maximized",{get:function(){return this.R},set:function(a){"boolean"===typeof a&&(this.R=a,!0===this.R&&this.Db(!0))}});Object.defineProperty(T.prototype,"horizontalCenter",{get:function(){return this.Bc},set:function(a){"boolean"===typeof a&&(this.Bc=a,!0===this.Bc&&(this.wa=this.ia=null),null!==this.m&&(a=this.G,this.G=(this.m.innerWidth-this.pixelWidth)/2,this.c.style.left=this.G+"px",null!==this.L&&a!==this.G&&this.L.D({property:"x"})))}});
Object.defineProperty(T.prototype,"verticalCenter",{get:function(){return this.Dc},set:function(a){"boolean"===typeof a&&(this.Dc=a,!0===this.Dc&&(this.gc=this.Rb=null),null!==this.m&&(a=this.H,this.H=(this.m.innerHeight-this.pixelHeight)/2,this.c.style.top=this.H+"px",null!==this.L&&a!==this.H&&this.L.D({property:"y"})))}});
Object.defineProperty(T.prototype,"top",{get:function(){return this.Rb},set:function(a){if("number"===typeof a||null===a)if(this.Rb=a,this.Dc=!1,null!==this.m&&null!==this.Rb){var b=this.H;this.H=a;this.c.style.top=this.H+"px";null!==this.L&&b!==this.H&&this.L.D({property:"y"})}}});
Object.defineProperty(T.prototype,"right",{get:function(){return this.wa},set:function(a){if("number"===typeof a||null===a)if(this.wa=a,this.Bc=!1,null!==this.m&&null!==this.wa){var b=this.G;this.G=this.m.innerWidth-this.pixelWidth-a;this.c.style.left=this.G+"px";null!==this.L&&b!==this.G&&this.L.D({property:"x"})}}});
Object.defineProperty(T.prototype,"bottom",{get:function(){return this.gc},set:function(a){if("number"===typeof a||null===a)if(this.gc=a,this.Dc=!1,null!==this.m&&null!==this.gc){var b=this.H;this.H=this.m.innerHeight-this.pixelHeight-a;this.c.style.top=this.H+"px";null!==this.L&&b!==this.H&&this.L.D({property:"y"})}}});
Object.defineProperty(T.prototype,"left",{get:function(){return this.ia},set:function(a){if("number"===typeof a||null===a)if(this.ia=a,this.Bc=!1,null!==this.m&&null!==this.ia){var b=this.G;this.G=a;this.c.style.left=this.G+"px";null!==this.L&&b!==this.G&&this.L.D({property:"x"})}}});Object.defineProperty(T.prototype,"alpha",{get:function(){return this.fe},set:function(a){"number"===typeof a&&a!==this.fe&&(this.fe=a,this.c.style.opacity=this.fe)}});
Object.defineProperty(T.prototype,"rotation",{get:function(){return this.re},set:function(a){"number"===typeof a&&a!==this.re&&(this.re=a,this.c.style.transform="rotate("+this.re+"deg)")}});Object.defineProperty(T.prototype,"background",{get:function(){return this.Zc},set:function(a){"string"===typeof a&&a!==this.Zc&&(this.Zc=a,this.c.style.background=this.Zc)}});
Object.defineProperty(T.prototype,"borderStyle",{get:function(){return this.ad},set:function(a){-1!=="none dotted dashed solid double groove ridge inset outset".split(" ").indexOf(a)&&a!==this.ad&&(this.ad=a,!0===this.V?Vd(this,"borderStyle",a):this.c.style.borderStyle=this.ad)}});
Object.defineProperty(T.prototype,"borderWidth",{get:function(){return this.O},set:function(a){if("number"===typeof a){var b=this.O;this.O=a;!0===this.V?Vd(this,"borderWidth",a):(this.c.style.borderWidth=this.O+"px",b===this.O&&!0!==this.ba||this.Mf())}}});Object.defineProperty(T.prototype,"borderColor",{get:function(){return this.$c},set:function(a){"string"===typeof a&&a!==this.$c&&(this.$c=a,this.c.style.borderColor=this.$c)}});
Object.defineProperty(T.prototype,"borderRadius",{get:function(){return this.ue},set:function(a){"number"!==typeof a&&"string"!==typeof a||a===this.ue||("string"===typeof a&&(a=parseInt(a,10)),isNaN(a)||(this.ue=a,this.c.style.borderRadius=this.ue+"px"))}});Object.defineProperty(T.prototype,"globalOffset",{get:function(){var a=this.c,b=0,d=0;do b+=a.offsetTop||0,d+=a.offsetLeft||0,a=a.offsetParent;while(a);return{top:b,left:d}}});
Object.defineProperty(T.prototype,"tooltip",{get:function(){return this.wd},set:function(a){"string"===typeof a&&a!==this.wd&&(this.wd=a,this.c.title=this.wd)}});Object.defineProperty(T.prototype,"index",{get:function(){return this.oe},set:function(a){"number"===typeof a&&a!==this.oe&&(this.oe=a,this.c.style.zIndex=this.oe)}});Object.defineProperty(T.prototype,"fullscreen",{set:function(a){"boolean"===typeof a&&(!0===a?this.Dj():this.Ej())}});
Object.defineProperty(T.prototype,"pointer",{get:function(){null===this.Cc&&(this.Cc=new U(this));return this.Cc}});Object.defineProperty(T.prototype,"drag",{get:function(){null===this.Ac&&(this.Ac=new Jd(this));return this.Ac}});Object.defineProperty(T.prototype,"onResize",{get:function(){null===this.Qb&&(this.Qb=new q(this));return this.Qb}});Object.defineProperty(T.prototype,"onBorderResize",{get:function(){null===this.Nb&&(this.Nb=new q(this));return this.Nb}});
Object.defineProperty(T.prototype,"onMove",{get:function(){null===this.L&&(this.L=new q(this));return this.L}});Object.defineProperty(T.prototype,"onReady",{get:function(){null===this.ka&&(this.ka=new q(this,!0));return this.ka}});Object.defineProperty(T.prototype,"onAddedToParent",{get:function(){null===this.Mb&&(this.Mb=new q(this));return this.Mb}});Object.defineProperty(T.prototype,"onAddedToDom",{get:function(){null===this.Kb&&(this.Kb=new q(this));return this.Kb}});
Object.defineProperty(T.prototype,"onShow",{get:function(){null===this.kd&&(this.kd=new q(this));return this.kd}});Object.defineProperty(T.prototype,"onHide",{get:function(){null===this.cd&&(this.cd=new q(this));return this.cd}});Object.defineProperty(T.prototype,"onFullscreenEnter",{get:function(){null===this.Ob&&(this.Ob=new q(this));return this.Ob}});Object.defineProperty(T.prototype,"onFullscreenExit",{get:function(){null===this.Pb&&(this.Pb=new q(this));return this.Pb}});
function t(a,b,d,e){this.f=[];this.M="undefined"!==typeof e?e:null;this.C=null;this.Kf=!1;this.ea="hidden";T.call(this,a,b,d||"DisplayObjectContainer")}t.prototype=Object.create(T.prototype);g=t.prototype;g.constructor=t;
g.Ga=function(){T.prototype.Ga.call(this);if("DisplayObjectContainer"===this.Ua){var a=null!==this.M;!0===a&&(this.C={originalWidth:this.M.clientWidth,originalHeight:this.M.clientHeight,currentWidth:this.M.clientWidth,currentHeight:this.M.clientHeight,scaleWidth:1,scaleHeight:1,frameCount:0,frameInterval:10},this.u=this.C.currentWidth,this.c.style.width=this.pixelWidth+"px",this.o=this.C.currentHeight,this.c.style.height=this.pixelHeight+"px",this.c.style.position="absolute",this.M.appendChild(this.c));
this.i.display.register(this,a);Rd(this);Sd(this)}};g.va=function(a){for(var b=0,d=this.f.length;b<d;b++){var e=this.f[b],h=a;!0===e.R&&e.Db(e.R);Ud(e,h.property);Td(e)}T.prototype.va.call(this,a)};g.Vd=function(){T.prototype.Vd.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].Vd()};g.lc=function(){T.prototype.lc.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].lc()};g.Wd=function(){T.prototype.Wd.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].Wd()};
function Wd(a,b){if(null===a.f)return-1;for(var d=0,e=a.f.length;d<e;d++)if(a.f[d]===b)return d;return-1}
g.update=function(){this.C.frameCount++;if(!(this.C.frameCount<this.C.frameInterval)){this.C.frameCount=0;var a=this.M.clientWidth,b=this.M.clientHeight,d=!1;a!==this.C.currentWidth&&(this.C.currentWidth=a,this.C.scaleWidth=this.C.currentWidth/this.C.originalWidth,d=!0);b!==this.C.currentHeight&&(this.C.currentHeight=b,this.C.scaleHeight=this.C.currentHeight/this.C.scaleHeight,d=!0);!0===d&&this.hh(this.C.currentWidth,this.C.currentHeight)}};
g.Yb=function(a){if(a===this)throw"You can't add a $_DisplayObjectContainer to itself!";var b=a;a instanceof Element&&(b=new T(a));this.c.appendChild(b.dom);b.parent=this;a=this.f.push(b)-1;null===b.index&&(b.index=a)};g.rn=function(a,b){var d=a;a instanceof Element&&(d=new T(a));this.c.appendChild(d.dom);d.parent=this;this.f.splice(b,0,d);d.index=b;b=0;for(d=this.f.length;b<d;b++)a=this.f[b],a.index=b};
g.Cj=function(){var a=this.f;if(0<a.length){this.Kf=!0;for(var b=0,d=a.length;b<d;b++)if(!0===a[b].pd()&&!0===a[b].visible){var e=Math.max(a[b].width+a[b].x,a[b].width+a[b].left,a[b].width+a[b].right),h=Math.max(a[b].height+a[b].y,a[b].height+a[b].top,a[b].height+a[b].bottom);e>this.pixelWidth&&(this.width=e);h>this.pixelHeight&&(this.height=h)}}null!==this.parent&&!0===B.T(this.parent,"DisplayObjectContainer")&&!0===this.parent.Kf&&this.parent.Cj()};
g.removeChild=function(a,b){a=Wd(this,a);-1!==a&&this.Cg(a,b)};g.Cg=function(a,b){if(0<=a&&a<this.f.length){var d=this.f[a];this.f.splice(a,1);this.c.removeChild(d.dom);"undefined"!==typeof b&&!0!==b||d.destroy();!0!==this.Kf||this.f.length||(this.height=this.width=0)}};g.gh=function(a){for(var b=this.f.length;b--;)this.Cg(b,a)};g.Nk=function(a){return-1!==Wd(this,a)};g.destroy=function(){this.gh(!1);this.C=this.M=this.f=null;T.prototype.destroy.call(this)};
Object.defineProperty(t.prototype,"children",{get:function(){return this.f}});Object.defineProperty(t.prototype,"overflow",{get:function(){return this.ea},set:function(a){-1!==["hidden","visible","scroll"].indexOf(a)&&(this.ea=a,this.c.style.overflow=a)}});function Xd(a,b){this.f=null;this.W=b||null;this.j="";this.M=!1;this.C="";this.S=this.J=null;this.P=!1;this.F=this.I=null;T.call(this,a,null,"Iframe")}Xd.prototype=Object.create(T.prototype);g=Xd.prototype;g.constructor=Xd;
g.Ga=function(){T.prototype.Ga.call(this);this.S=this.sm.bind(this);this.f=document.createElement("iframe");this.f.style.width="100%";this.f.style.height="100%";this.f.style.border=0;this.f.style.overflow="hidden";this.f.addEventListener("load",this.S,null!==this&&!!this);this.f.setAttribute("allowFullScreen","");this.c.appendChild(this.f);null!==this.W&&this.load(this.W);this.i.display.register(this);Rd(this);Sd(this)};
g.Se=function(){this.log("_localeChangeComplete");!0===this.i.i18n.xb(this.C)&&Yd(this,this.J.value)};function Yd(a,b){a.log("_loadIframe url: "+b);a.P=!1;null!==a.I&&a.I.D();a.j=b;a.f.src=a.j}g.sm=function(){""!==this.j&&(this.log("_loadCompleteHandler url: "+this.j),this.P=!0,null!==this.F&&this.F.D())};function Zd(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.Se,a)&&a.i.i18n.onLocaleChangeComplete.add(a.Se,a)}
g.load=function(a){"object"===typeof a&&null!==a?(this.M=a.i18n||!1,!0===this.M?(this.j="",this.C=a.url):this.j=a.url):(this.M=!1,this.j="","string"===typeof a&&(this.j=a));var b;!0===this.M&&"string"===typeof this.C&&""!==this.C?(this.J=new za(this.i,this.C),Zd(this),b=this.J.value):"string"===typeof this.j&&""!==this.j&&(b=this.j);"undefined"!==typeof b&&Yd(this,b)};
g.destroy=function(){!1!==this.hb&&(null!==this.J&&(this.J.destroy(),this.J=null,this.i.i18n.onLocaleChangeComplete.remove(this.Se,this)),null!==this.I&&(this.I.destroy(),this.I=null),null!==this.F&&(this.F.destroy(),this.F=null),this.S=this.f=null,T.prototype.destroy.call(this))};
Object.defineProperty(Xd.prototype,"i18nUrl",{get:function(){return this.C},set:function(a){if("string"===typeof a){this.M=!0;this.C=a;var b;""!==this.C&&(this.J=new za(this.i,this.C),Zd(this),b=this.J.value);"undefined"!==typeof b&&Yd(this,b)}}});Object.defineProperty(Xd.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.M=!1,Yd(this,a))}});Object.defineProperty(Xd.prototype,"loaded",{get:function(){return this.P}});
Object.defineProperty(Xd.prototype,"onLoadStart",{get:function(){null===this.I&&(this.I=new q(this));return this.I}});Object.defineProperty(Xd.prototype,"onLoadComplete",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});
function S(a,b){this.ea=b;this.F="";this.j=!1;this.I=null;this.W="";this.aa="rgb(0, 0, 0)";this.P=this.S=!0;this.Aa=0;this.M=this.Ba=!1;this.Z=null;this.Na=!1;this.za=this.xa=this.ya=this.ta=this.sa=this.ra=this.qa=this.Ma=this.Ia=this.Ka=this.Ja=this.Ea=this.Da="";this.ha=this.ma=this.na=this.f=this.Ca=null;this.ga=!1;this.C=this.J=null;T.call(this,a,null,"TextField")}S.prototype=Object.create(T.prototype);g=S.prototype;g.constructor=S;
g.Ga=function(){T.prototype.Ga.call(this);this.na=this.gm.bind(this);this.ma=this.Rl.bind(this);this.ha=this.Ql.bind(this);this.Ca=document.createElement("span");this.c.appendChild(this.Ca);"undefined"!==typeof this.ea&&null!==this.ea&&this.load(this.ea);this.i.display.register(this);Rd(this);Sd(this)};
g.va=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.S=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.P=!1);T.prototype.va.call(this,a)};g.lc=function(){$d(this);T.prototype.lc.call(this)};function ae(a,b){b!==a.W&&(a.W=String(b),a.Ca.innerHTML=b,$d(a),Td(a),null!==a.J&&a.J.D());if(!1===a.j||!0===a.j&&!0===a.I.loaded)a.ga=!0,null!==a.C&&a.C.D()}
function $d(a){if(!1!==a.pd()){if(!0===a.S){var b=a.pixelWidth;a.c.style.width="";var d=a.c.offsetWidth;0<d&&(d+=1);a.u=d;a.B="px";a.c.style.width=a.u+"px";b!==a.u&&a.va({property:"autoWidth"})}!0===a.P&&(b=a.pixelHeight,a.c.style.height="",d=a.c.offsetHeight,0<d&&(d+=1),a.o=d,a.A="px",a.c.style.height=a.o+"px",b!==a.o&&a.va({property:"autoHeight"}))}}function be(a){null===a.I&&(a.I=new za(a.i,a.F));ae(a,a.I.value)}
function ce(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.$e,a)&&a.i.i18n.onLocaleChangeComplete.add(a.$e,a)}g.$e=function(){this.log("_localeChangeComplete");!0===this.i.i18n.xb(this.F)&&(this.value=this.I.value)};
g.gm=function(){!0===this.M&&null===this.f&&(this.f=document.createElement("textarea"),this.f.style.position="absolute",this.f.style.top="0px",this.f.style.left="0px",this.f.style.width="100%",this.f.style.height="100%",this.f.style.resize="none",this.f.style.margin="0px",this.f.style.padding="0px",this.f.style.overflowX="hidden",this.f.style.overflowY="auto",this.f.style.boxSizing="border-box",this.f.value=this.W,this.f.addEventListener("input",this.ma,!1),this.f.addEventListener("blur",this.ha,
!1),this.c.appendChild(this.f),this.f.focus())};g.Rl=function(){ae(this,this.f.value)};g.Ql=function(){this.If()};g.If=function(){null!==this.f&&(this.f.removeEventListener("input",this.ma,!1),this.f.removeEventListener("blur",this.ha,!1),this.c.removeChild(this.f),this.f=null)};
g.load=function(a){this.ga=!1;"object"===typeof a&&null!==a?(a.color&&(this.color=a.color),a.font&&(this.font=a.font),a.fontFamily&&(this.fontFamily=a.fontFamily),a.fontWeight&&(this.fontWeight=a.fontWeight),a.fontSize&&(this.fontSize=a.fontSize),a.fontStyle&&(this.fontStyle=a.fontStyle),a.fontVariant&&(this.fontVariant=a.fontVariant),a.textAlign&&(this.textAlign=a.textAlign),a.textShadow&&(this.textShadow=a.textShadow),a.textDecoration&&(this.textDecoration=a.textDecoration),a.textOverflow&&(this.textOverflow=
a.textOverflow),a.textTransform&&(this.textTransform=a.textTransform),a.whiteSpace&&(this.whiteSpace=a.whiteSpace),a.wordWrap&&(this.wordWrap=a.wordWrap),a.lineHeight&&(this.lineHeight=a.lineHeight),a.autoWidth&&(this.autoWidth=a.autoWidth),a.autoHeight&&(this.autoHeight=a.autoHeight),a.padding&&(this.padding=a.padding),a.selectable&&(this.selectable=a.selectable),a.editable&&(this.editable=a.editable),this.j=a.i18n||!1,!0===this.j?this.F=a.value:this.value=a.value):"string"===typeof a&&(this.j=!1,
this.value=a);!0===this.j&&"string"===typeof this.F&&""!==this.F&&(be(this),ce(this))};g.destroy=function(){!1!==this.hb&&(null!==this.I&&(this.I.destroy(),this.I=null,this.i.i18n.onLocaleChangeComplete.remove(this.$e,this)),this.If(),null!==this.C&&(this.C.destroy(),this.C=null),null!==this.J&&(this.J.destroy(),this.J=null),T.prototype.destroy.call(this))};
Object.defineProperty(S.prototype,"i18nValue",{get:function(){return this.F},set:function(a){"string"===typeof a&&(""===this.F&&ce(this),this.j=!0,this.F=a,be(this))}});Object.defineProperty(S.prototype,"i18n",{get:function(){return this.j}});Object.defineProperty(S.prototype,"value",{get:function(){return this.W},set:function(a){if("string"===typeof a||"number"===typeof a)this.j=!1,ae(this,a)}});
Object.defineProperty(S.prototype,"color",{get:function(){return this.aa},set:function(a){"string"===typeof a&&(this.aa=a,this.c.style.color=this.aa)}});Object.defineProperty(S.prototype,"font",{get:function(){return this.qa},set:function(a){"string"!==typeof a||2>a.split(" ").toString().length||(this.qa=a.replace(/"/g,'"'),this.c.style.font=this.qa)}});
Object.defineProperty(S.prototype,"fontFamily",{get:function(){return this.ra},set:function(a){"string"===typeof a&&(this.ra=a.replace(/"/g,'"'),this.c.style.fontFamily=this.ra,$d(this))}});Object.defineProperty(S.prototype,"fontSize",{get:function(){return this.sa},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.sa=a,this.c.style.fontSize=this.sa}});
Object.defineProperty(S.prototype,"fontStyle",{get:function(){return this.ta},set:function(a){"string"===typeof a&&(this.ta=a,this.c.style.fontStyle=this.ta)}});Object.defineProperty(S.prototype,"fontWeight",{get:function(){return this.ya},set:function(a){"string"===typeof a&&"number"===typeof a&&(this.ya=a,this.c.style.fontWeight=this.ya)}});Object.defineProperty(S.prototype,"fontVariant",{get:function(){return this.xa},set:function(a){"string"===typeof a&&(this.xa=a,this.c.style.fontVariant=this.xa)}});
Object.defineProperty(S.prototype,"lineHeight",{get:function(){return this.za},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.za=a,this.c.style.lineHeight=this.za}});Object.defineProperty(S.prototype,"textAlign",{get:function(){return this.Da},set:function(a){"string"===typeof a&&(this.Da=a,this.c.style.textAlign=this.Da)}});
Object.defineProperty(S.prototype,"textShadow",{get:function(){return this.Ja},set:function(a){"string"===typeof a&&(this.Ja=a,this.c.style.textShadow=this.Ja)}});Object.defineProperty(S.prototype,"textDecoration",{get:function(){return this.Ea},set:function(a){"string"===typeof a&&(this.Ea=a,this.c.style.textDecoration=this.Ea)}});Object.defineProperty(S.prototype,"textTransform",{get:function(){return this.Ka},set:function(a){"string"===typeof a&&(this.Ka=a,this.c.style.textTransform=this.Ka)}});
Object.defineProperty(S.prototype,"autoWidth",{get:function(){return this.S},set:function(a){"boolean"===typeof a&&(this.S=a,$d(this))}});Object.defineProperty(S.prototype,"autoHeight",{get:function(){return this.P},set:function(a){"boolean"===typeof a&&(this.P=a,$d(this))}});
Object.defineProperty(S.prototype,"padding",{get:function(){return this.Aa},set:function(a){if("number"===typeof a||"string"===typeof a)this.Aa=a="string"===typeof a?a.split(" ",4).toString().replace(/,/g," "):a+"px",this.c.style.padding=this.Aa}});
Object.defineProperty(S.prototype,"selectable",{get:function(){return this.Ba},set:function(a){"boolean"===typeof a&&(this.Ba=a,!1===this.Ba?(!1===this.M&&!0===this.Oa&&(this.Oa=this.pointer.enabled=!1),this.c.style.N="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none"):(!1===this.pointer.enabled&&(this.Oa=this.pointer.enabled=!0),this.c.style.N="text",this.c.style.webkitUserSelect="text",this.c.style.c="text",this.c.style.f="text",this.c.style.j=
"inherit"))}});Object.defineProperty(S.prototype,"wordWrap",{get:function(){return this.Na},set:function(a){"boolean"===typeof a&&(this.Na=a,this.c.style.wordWrap=!1===this.Na?"normal":"break-word")}});Object.defineProperty(S.prototype,"whiteSpace",{get:function(){return this.Ma},set:function(a){"string"===typeof a&&(this.Ma=a,this.c.style.whiteSpace=this.Ma)}});
Object.defineProperty(S.prototype,"textOverflow",{get:function(){return this.Ia},set:function(a){"string"===typeof a&&(this.Ia=a,this.c.style.textOverflow=this.Ia)}});
Object.defineProperty(S.prototype,"editable",{get:function(){return this.M},set:function(a){a=!!a;this.M!==a&&(this.M=a,!1===this.M?(this.c.removeEventListener("click",this.na,null!==this&&!!this),this.i.keyboard.Be(this.Z),this.Z=null,this.pointer.enabled=!0,this.c.style.cursor="text"):(this.c.addEventListener("click",this.na,null!==this&&!!this),this.Z=new O(this.i,[13,27],this.If,null,null,null,this),this.i.keyboard.Sf(this.Z),this.c.style.cursor="default"))}});
Object.defineProperty(S.prototype,"loaded",{get:function(){return this.ga}});Object.defineProperty(S.prototype,"onLoadComplete",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(S.prototype,"onValueChange",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});function vd(a,b){this.ga=b||null;this.F={};this.Z=this.I=this.P="";this.j=this.J=null;this.S=this.W=!1;this.aa=0;t.call(this,a,null,"Button")}vd.prototype=Object.create(t.prototype);
vd.prototype.constructor=vd;vd.states={Sb:"out",zc:"over",Gl:"down"};g=vd.prototype;
g.Ga=function(){t.prototype.Ga.call(this);this.I=vd.states.Sb;this.J=new Ma(this.i);this.J.onLoadComplete.add(this.Td,this);this.J.onResize.add(this.Ud,this);this.Yb(this.J);this.j=new S(this.i);this.j.onLoadComplete.add(this.Td,this);this.j.onResize.add(this.Ud,this);this.j.autoWidth=!0;this.j.autoHeight=!0;this.Yb(this.j);this.pointer.enabled=!0;this.pointer.cursor=Md.Xa;this.pointer.onEnter.add(this.xm,this);this.pointer.onLeave.add(this.ym,this);this.pointer.onPressStart.add(this.Mk,this);this.pointer.onPressEnd.add(this.Lk,
this);this.i.display.register(this);Rd(this);Sd(this);this.i.i18n.onLocaleChangeComplete.add(this.Zg,this);this.load(this.ga)};g.xm=function(){de(this,vd.states.zc)};g.ym=function(){de(this,vd.states.Sb)};g.Mk=function(){de(this,vd.states.Gl)};g.Lk=function(){de(this,vd.states.zc)};g.Zg=function(){de(this,this.I)};g.Td=function(a){this.log("_itemLoadComplete "+a.emitter.className);this.aa++;2===this.aa&&(this.log("_allItemsLoaded"),ee(this),fe(this))};g.Ud=function(){ee(this);fe(this)};
function ge(a,b){a.P=b;de(a,a.I)}function de(a,b){a.I=b;b=a.F[a.P];a.aa=0;var d=b.Vj(a.I);a.background=b.Pa("background",a.I);a.borderStyle=b.Pa("borderStyle",a.I);a.borderColor=b.Pa("borderColor",a.I);a.borderRadius=b.Pa("borderRadius",a.I);a.borderWidth=b.Pa("borderWidth",a.I);a.W=b.Pa("autoWidth",a.I);a.S=b.Pa("autoHeight",a.I);var e=b.Pa("label",a.I);"undefined"!==typeof e&&a.j.load(e);!0===d&&a.J.load(b.Pa("image",a.I))}
function ee(a){a.log("_updateLayout");var b=a.F[a.P],d=b.Pa("align",a.I),e=b.Pa("padding",a.I),h=b.Pa("spacing",a.I);"label"===b.Pa("first",a.I)?(b=a.j,a=a.J):(b=a.J,a=a.j);switch(d){case "left":b.left=e;b.verticalCenter=!0;a.left=b.left+h+b.pixelWidth;a.verticalCenter=!0;break;case "right":b.right=e;b.verticalCenter=!0;a.right=b.right+h+b.pixelWidth;a.verticalCenter=!0;break;case "top":b.top=e;b.horizontalCenter=!0;a.top=b.top+b.pixelHeight+h;a.horizontalCenter=!0;break;case "bottom":b.bottom=e;
b.horizontalCenter=!0;a.bottom=b.bottom+h+b.pixelHeight;a.horizontalCenter=!0;break;default:b.horizontalCenter=!0,b.verticalCenter=!0,a.horizontalCenter=!0,a.verticalCenter=!0}}
function fe(a){a.log("_updateAutoSize");if(!1!==a.W||!1!==a.S){var b=a.F[a.P].Pa("padding",a.I);if(!0===a.W){var d=a.pixelWidth;a.u=Math.max(a.j.x+a.j.pixelWidth,a.J.x+a.J.pixelWidth)-Math.min(a.j.x,a.J.x)+2*b+2*a.O;a.B="px";a.c.style.width=a.u+"px";d!==a.pixelWidth&&a.va({property:"autoWidth"})}!0===a.S&&(d=a.pixelHeight,a.o=Math.max(a.j.y+a.j.pixelHeight,a.J.y+a.J.pixelHeight)-Math.min(a.j.y,a.J.y)+2*b+2*a.O,a.A="px",a.c.style.height=a.o+"px",d!==a.pixelHeight&&a.va({property:"autoHeight"}))}}
g.load=function(a){if("undefined"!==typeof a&&null!==a){if(!0===B.Fa(a.skins,"ButtonSkin"))for(var b=0,d=a.skins.length;b<d;b++)this.mc(a.skins[b]);else if("object"===typeof a.skins&&0<a.skins.length)for(var d=0,e=a.skins.length;d<e;d++)b=new he(a.skins[d].name,a.skins[d].states),this.mc(b);B.T(a.skin,"ButtonSkin")?this.mc(a.skin):"object"===typeof a.skin&&(b=new he(a.skin.name,a.skin.states),this.mc(b));!0===B.T(a["default"],"string")&&!0===this.Wj(a["default"])&&(this.Z=a["default"])}a=this.F||
{};Object.keys(a).length||(b=new he("default"),this.mc(b));""===this.Z&&(this.Z=this.F[Object.keys(a)[0]].name);ge(this,this.Z)};g.mc=function(a,b){if(!1===B.T(a,"ButtonSkin"))throw"$_Button: Invalid button skin!";a.Hg(vd.states.Sb);this.F[a.name]=a;!0===b&&ge(this,a.name)};g.yk=function(a){"string"===typeof a&&!0===B.T(this.F[a],"ButtonSkin")?ge(this,a):!0===B.T(a,"ButtonSkin")&&(this.F[a.name]===a?ge(this,a.name):"undefined"!==typeof this.F[a.name]&&null!==this.F[a.name]||this.mc(a,!0))};
g.Wj=function(a){return"undefined"!==typeof this.F[a]};g.no=function(){this.F[this.P].Hg(vd.states.Sb);ge(this,this.P)};
g.destroy=function(){this.i.i18n.onLocaleChangeComplete.remove(this.Zg,this);if("undefined"!==typeof this.F&&0<this.F.length)for(var a in this.F)this.F.hasOwnProperty(a)&&this.F[a].destroy();this.F={};null!==this.J&&(this.J.onLoadComplete.remove(this.Td,this),this.J.onResize.remove(this.Ud,this),this.removeChild(this.J,!0),this.J=null);null!==this.j&&(this.j.onLoadComplete.remove(this.Td,this),this.j.onResize.remove(this.Ud,this),this.removeChild(this.j,!0),this.j=null);t.prototype.destroy.call(this)};
Object.defineProperty(vd.prototype,"skins",{get:function(){return this.F}});Object.defineProperty(vd.prototype,"skin",{get:function(){return this.F[this.P]},set:function(a){this.yk(a)}});Object.defineProperty(vd.prototype,"autoWidth",{get:function(){return this.W},set:function(a){"boolean"===typeof a&&(this.W=a,fe(this))}});Object.defineProperty(vd.prototype,"autoHeight",{get:function(){return this.S},set:function(a){"boolean"===typeof a&&(this.S=a,fe(this))}});
function he(a,b){this.j=a||"";this.f=B.mb(ie,{});this.c=B.mb(b||{},{out:{},over:{},down:{}});l.call(this,"ButtonSkin")}he.prototype=Object.create(l.prototype);he.prototype.constructor=he;
var je={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},ke={value:"",i18n:!1,color:"",fontFamily:"",fontWeight:""},le={name:"",background:"",borderStyle:"solid",borderColor:"",borderRadius:0,borderWidth:0,autoWidth:!0,autoHeight:!0,align:"center",padding:0,spacing:0,first:"image",image:je,label:ke},me={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},ne={value:"Button",i18n:!1,color:"",fontFamily:"",fontWeight:""},ie={name:"default",background:"#eee",borderStyle:"solid",borderColor:"#555",
borderRadius:5,borderWidth:2,autoWidth:!0,autoHeight:!0,align:"left",padding:5,spacing:0,first:"image",image:me,label:ne};he.prototype.Hg=function(a){"undefined"!==typeof this.c[a]&&(this.f=this.c[a])};he.prototype.Pa=function(a,b){b=B.le(this.c,b+"."+a,B.le(this.f,a,B.le(le,a)));"object"===typeof b&&(b=B.mb(this.f[a],b));return b};he.prototype.Vj=function(a){a=this.Pa("image",a);return"undefined"!==typeof a&&"string"===typeof a.url&&""!==a.url};
he.prototype.m=function(a){a=this.Pa("label",a);return"undefined"!==typeof a&&"string"===typeof a.value&&""!==a.value};Object.defineProperty(he.prototype,"name",{get:function(){return this.j}});Object.defineProperty(he.prototype,"default",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(he.prototype,"out",{get:function(){return this.c.out},set:function(a){this.c.out=a}});
Object.defineProperty(he.prototype,"over",{get:function(){return this.c.over},set:function(a){this.c.over=a}});Object.defineProperty(he.prototype,"down",{get:function(){return this.c.down},set:function(a){this.c.down=a}});function ia(a){T.call(this,a,document.createElement("canvas"),"Canvas")}ia.prototype=Object.create(T.prototype);ia.prototype.constructor=ia;ia.prototype.Ga=function(){T.prototype.Ga.call(this);this.i.display.register(this);Rd(this);Sd(this)};
Object.defineProperty(ia.prototype,"context2D",{get:function(){return this.c.getContext("2d")}});Object.defineProperty(ia.prototype,"context3D",{get:function(){return this.c.getContext("webgl")}});Object.defineProperty(ia.prototype,"element",{get:function(){return this.c}});
function Ma(a,b,d){this.sa=b||null;this.ha=this.M="";this.aa=!1;this.ea=this.ta="";this.j=this.W=null;this.ga=!1;this.Z=this.f=null;this.na="";this.P=this.ma=!1;this.qa=this.ra=!0;this.F="";this.J=this.S=this.C=null;T.call(this,a,null,d||"Image")}Ma.prototype=Object.create(T.prototype);Ma.prototype.constructor=Ma;var oc={CSS:"css",Lb:"canvas"},oe=oc.CSS;g=Ma.prototype;g.Ga=function(){T.prototype.Ga.call(this);this.Jb=!0;null!==this.sa&&this.load(this.sa);this.i.display.register(this);Rd(this)};
g.va=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.ra=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.qa=!1);null!==this.j&&(this.F===oc.CSS?(pe(this),qe(this)):this.F===oc.Lb&&null!==this.f&&re(this,this.f),!0===this.Jb&&(-1!==b.toLowerCase().indexOf("width")?(b=this.pixelWidth/this.f.w,b!==this.Ke&&(this.Ke=b,!0===this.Jb&&(this.Je=b,this.height=this.f.h*this.Je))):-1!==b.toLowerCase().indexOf("height")&&(b=this.pixelHeight/this.f.h,
b!==this.Je&&(this.Je=b,!0===this.Jb&&(this.Ke=b,this.width=this.f.w*this.Ke)))),T.prototype.va.call(this,a))};g.Mf=function(){this.F===oc.CSS?this.c.style.backgroundPosition=-this.O+"px "+-this.O+"px":this.F===oc.Lb&&(this.C.style.top=-this.O+"px",this.C.style.left=-this.O+"px");T.prototype.Mf.call(this)};g.Te=function(){var a=this.M+"_"+this.i.i18n.locale;if(a!==this.ta&&(this.ta=a,!0===this.i.i18n.xb(this.ea))){var b=this.W.value;this.P=!1;this.i.load.image(a,b,this.Ei,this)}};
function se(a,b){if(b===oc.CSS||b===oc.Lb)a.F=b;a.F===oc.CSS?a.c.style.backgroundRepeat="no-repeat":a.F===oc.Lb&&(a.C=document.createElement("canvas"),a.C.style.position="absolute",a.C.style.top="0px",a.C.style.left="0px",a.c.appendChild(a.C))}function te(a,b){a.f=b;!0===a.ra&&(a.u=a.f.w,a.B="px",a.c.style.width=a.pixelWidth+"px");!0===a.qa&&(a.o=a.f.h,a.A="px",a.c.style.height=a.pixelHeight+"px");a.F===oc.CSS?(pe(a),qe(a)):a.F===oc.Lb&&re(a,a.f)}
function re(a,b){if(null!==a.j&&!1!==a.ga){a.C.width=a.innerWidth;a.C.height=a.innerHeight;var d=a.C.getContext("2d");d.clearRect(0,0,a.innerWidth,a.innerHeight);d.drawImage(a.j,b.x,b.y,b.w,b.h,0,0,a.innerWidth,a.innerHeight)}}function pe(a){a.c.style.backgroundSize=a.pixelWidth/a.f.w*a.j.naturalWidth+"px "+a.pixelHeight/a.f.h*a.j.naturalHeight+"px"}function qe(a){a.c.style.backgroundPosition=a.pixelWidth/a.f.w*(-a.f.x-a.O)+"px "+a.pixelHeight/a.f.h*(-a.f.y-a.O)+"px"}
g.Ei=function(a){!1!==this.hb&&(this.j=a.data,this.F===oc.CSS&&(this.c.style.backgroundImage="url('"+a.url+"')"),this.ga=!0,ue(this))};g.um=function(a){"undefined"!==typeof a.data.frames?this.Z=a.data.frames:this.warn("No frames found in file!");this.ma=!0;ue(this)};function ue(a){if(!0!==a.P&&!0===a.ga&&!0===a.ma){a.P=!0;var b;null!==a.f?b=a.f:null!==a.Z?b=a.Z[0].frame:b={x:0,y:0,w:a.j.naturalWidth,h:a.j.naturalHeight};te(a,b);Td(a);Sd(a);null!==a.J&&a.J.D()}}
g.load=function(a){this.ma=this.ga=this.P=!1;"object"===typeof a&&null!==a?(se(this,"string"===typeof a.tk?a.tk:oe),this.M=a.key||"",this.aa=a.i18n||!1,!0===this.aa?(this.ha="",this.ea=a.url):this.ha=a.url,this.f=a.frame||null,"string"===typeof a.frames?this.na=a.frames:"object"===typeof a.frames&&null!==a.frames&&(this.Z=a.frames),this.alpha=a.alpha,this.keepRatio=a.keepRatio,this.maximized=a.maximized,this.width=a.width,this.height=a.height):(se(this,oe),this.ha=this.M="",this.aa=!1,"string"===
typeof a&&(this.ha=a));a=this.M;var b=this.ha;if(!0===this.aa&&"string"===typeof this.ea){this.W=new za(this.i,this.ea);!1===this.i.i18n.onLocaleChangeComplete.has(this.Te,this)&&this.i.i18n.onLocaleChangeComplete.add(this.Te,this);var d=this.i.i18n.locale;""!==d&&(a=this.M+"_"+d);!0===this.i.i18n.xb(this.ea)&&(b=this.W.value)}""!==b?(this.P=!1,this.i.load.image(a,b,this.Ei,this)):this.ga=!0;"string"===typeof this.na&&""!==this.na?(a=this.na,this.P=!1,this.i.load.json(this.M+"-frames",a,this.um,this)):
this.ma=!0};g.Ge=function(){this.c.style.backgroundImage="";this.j=null};
g.destroy=function(a){if(!1!==this.hb){null!==this.W&&(this.W.destroy(),this.W=null,this.i.i18n.onLocaleChangeComplete.remove(this.Te,this));null!==this.S&&(this.S.destroy(),this.S=null);null!==this.J&&(this.J.destroy(),this.J=null);this.j=null;if("undefined"===typeof a||!0===a)if(!0===this.aa){a=this.i.i18n.locales;for(var b,d=0,e=a.length;d<e;d++)b=this.M+"_"+a[d],this.i.cache.remove(A.IMAGE,b)}else this.i.cache.remove(A.IMAGE,this.M);T.prototype.destroy.call(this)}};
Object.defineProperty(Ma.prototype,"loaded",{get:function(){return this.P}});Object.defineProperty(Ma.prototype,"element",{get:function(){return this.j}});Object.defineProperty(Ma.prototype,"canvas",{get:function(){return this.C}});Object.defineProperty(Ma.prototype,"frame",{get:function(){return this.f},set:function(a){te(this,a)}});Object.defineProperty(Ma.prototype,"frames",{get:function(){return this.Z}});Object.defineProperty(Ma.prototype,"originalWidth",{get:function(){if(null!==this.j)return this.j.naturalWidth}});
Object.defineProperty(Ma.prototype,"originalHeight",{get:function(){if(null!==this.j)return this.j.naturalHeight}});Object.defineProperty(Ma.prototype,"onLoadStart",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(Ma.prototype,"onLoadComplete",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});function ud(a,b){this.I=null;Ma.call(this,a,b,"Sprite")}ud.prototype=Object.create(Ma.prototype);g=ud.prototype;g.constructor=ud;
g.Ga=function(){this.F=oc.Lb;Ma.prototype.Ga.call(this);this.I=new ve(this);this.i.display.register(this,!0)};g.play=function(a,b,d){this.I.play(a,b,d)};g.pause=function(a){this.I.pause(a)};g.resume=function(a){this.I.resume(a)};g.stop=function(){this.I.stop()};g.update=function(){this.I.update()};g.destroy=function(){!1!==this.hb&&(this.I.destroy(),this.I=null,Ma.prototype.destroy.call(this))};Object.defineProperty(ud.prototype,"animations",{get:function(){return this.I}});
Object.defineProperty(ud.prototype,"animation",{get:function(){return this.I.currentAnimation}});function ve(a){this.m=a;this.f={};this.c=null;this.j=[];l.call(this,"SpriteAnimationManager");!1===this.m.loaded&&this.m.onLoadComplete.fa(this.kn,this)}ve.prototype=Object.create(l.prototype);g=ve.prototype;g.constructor=ve;g.kn=function(){this.log("_spriteLoadComplete");for(var a,b,d=0,e=this.j.length;d<e;d++)a=this.j[d].method,b=this.j[d].args,ve.prototype[a].apply(this,b);this.j=[]};
g.add=function(a,b,d,e,h){if(!1===this.m.loaded)this.j.push({method:"add",args:arguments});else{this.log("add");"string"!==typeof a&&(a="default");b=parseInt(b,10);d=parseInt(d,10);var k=this.m.frames;if("number"!==typeof b||!0===isNaN(b)||0>b||b>=k.length)b=0;if("number"!==typeof d||!0===isNaN(d)||0>d||d>=k.length)d=k.length;h="undefined"===typeof h?!1:!!h;this.f[a]=new W(this.m,a,k.slice(b,d),e||60);this.c=this.f[a]}};
g.play=function(a,b,d){if(!1===this.m.loaded)this.j.push({method:"play",args:arguments});else{var e=this.c;"string"===typeof a&&null!==a&&(e=this.get(a));null!==e&&e.play(b,d)}};g.pause=function(a){var b=this.c;null!==b&&b.pause(a)};g.resume=function(a){var b=this.c;null!==b&&b.resume(a)};g.stop=function(){var a=this.c;null!==a&&a.stop()};g.get=function(a){return!0===B.T(this.f[a],"SpriteAnimation")?this.f[a]:null};g.update=function(){null!==this.c&&this.c.update()};
g.destroy=function(){for(var a in this.f)this.f[a].destroy(),this.f[a]=null;this.j=this.c=this.f=this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(ve.prototype,"currentAnimation",{get:function(){return this.c},set:function(a){!0===B.T(a,"SpriteAnimation")&&(this.c=a)}});
function W(a,b,d,e){this.C=a;this.M=b;this.B=d||[];this.O=0;this.U=e||60;this.J=!1;this.V=0;this.G=1E3/e;this.F=this.I=0;this.R=1;this.L=this.c=this.H=!1;this.f=this.A=this.j=this.u=this.m=this.o=null;l.call(this,"SpriteAnimation")}W.prototype=Object.create(l.prototype);g=W.prototype;g.constructor=W;function we(a,b){a.O="number"===typeof b&&0<=b&&b<a.B.length?b:0;a.C.frame=a.B[a.O].frame}
g.play=function(a,b){"boolean"===typeof a&&(this.J=a);this.H=!0;this.c=this.L=!1;this.V=0;this.I=this.C.viewer.clock.time+this.G;we(this,b);this.C.animations.so=this;null!==this.o&&this.o.D()};g.pause=function(a){!0!==this.c&&(this.c=!0,"number"===typeof a&&we(this,a),null!==this.m&&this.m.D())};g.resume=function(a){!1!==this.c&&(this.c=!1,"number"===typeof a&&we(this,a),this.H&&(this.I=this.C.viewer.clock.time+this.G),null!==this.u&&this.u.D())};
g.stop=function(){this.H=!1;this.L=!0;this.c=!1;we(this,0);null!==this.A&&this.A.D()};
g.update=function(){if(!0!==this.c){var a=this.C.viewer.clock.time;!0===this.H&&a>=this.I&&(this.R=1,this.F=a-this.I,this.F>this.G&&(this.R=Math.floor(this.F/this.G),this.F-=this.R*this.G),this.I=a+(this.G-this.F),a=this.O+this.R,a>=this.B.length?!0===this.J?(a%=this.B.length,this.V++,null!==this.j&&this.j.D(),we(this,a)):(we(this,this.B.length-1),this.H=!1,this.L=!0,this.c=!1,null!==this.f&&this.f.D()):we(this,a))}};
g.destroy=function(){this.B=this.C=null;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(W.prototype,"name",{get:function(){return this.M}});Object.defineProperty(W.prototype,"frames",{get:function(){return this.B}});
Object.defineProperty(W.prototype,"frameIndex",{get:function(){return this.O}});Object.defineProperty(W.prototype,"frameRate",{get:function(){return this.U},set:function(a){"number"===typeof a&&(this.U=a,this.G=1E3/this.U)}});Object.defineProperty(W.prototype,"loop",{get:function(){return this.J},set:function(a){this.J=!!a}});Object.defineProperty(W.prototype,"loopCount",{get:function(){return this.V}});Object.defineProperty(W.prototype,"playing",{get:function(){return this.H}});
Object.defineProperty(W.prototype,"paused",{get:function(){return this.c},set:function(a){!0===!!a?this.pause():this.resume()}});Object.defineProperty(W.prototype,"complete",{get:function(){return this.L}});Object.defineProperty(W.prototype,"onPlay",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(W.prototype,"onPause",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
Object.defineProperty(W.prototype,"onResume",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(W.prototype,"onLoop",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(W.prototype,"onComplete",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});Object.defineProperty(W.prototype,"onStop",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
function K(a,b,d,e,h){this.i=a;this.Xc=b;this.bc=d||null;this.F=null;this.Wc=e||xe.Ib;this.cb="";this.J=null;this.I=this.C=-1;this.Oa=null;this.rb=!1;this.fb=null;this.cc=!1;this.eb=1;this.Va=!1;this.uc=0;this.Eb=null;this.zb=h||!1;this.Oc=[0,1,2,3];this.sc=!1;this.Ba=this.S=this.za=this.Aa=this.Ca=this.Ja=this.ra=this.xa=this.Ea=this.Na=this.ha=this.ga=this.Da=this.Ka=this.aa=this.Ia=this.sa=this.ta=this.Z=this.W=this.ea=this.ya=this.na=this.qa=this.ma=null;this.Ab=this.M=!1;this.rc=this.vc=0;this.ec=
this.fc=this.j=this.Fb=this.Ma=this.vb=this.nb=this.tb=this.ub=this.sb=this.P=null;T.call(this,a,null,"VideoHTML5")}K.prototype=Object.create(T.prototype);g=K.prototype;g.constructor=K;
g.Ga=function(){T.prototype.Ga.call(this);!0===this.zb&&!1===ye(this)&&(this.log("$_VideoHTML5: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),this.zb=!1);this.N=this.Xc;ba(this);this.P=this.Om.bind(this);this.sb=this.Pm.bind(this);this.ub=this.Rm.bind(this);this.tb=this.Qm.bind(this);this.nb=this.Nm.bind(this);this.vb=this.Sm.bind(this);this.Ma=this.Mm.bind(this);this.Fb=this.Tm.bind(this);this.j=this.Dm.bind(this);this.Oa=this.i.clock.create(!1);this.fb=
this.i.clock.create(!1);this.fb.af(500,this.Pl,this);this.i.audio.onVolumeChange.add(this.Yh,this);this.i.audio.onDisable.add(this.Xh,this);this.S=new q(this,!0);null!==this.bc&&this.load(this.bc);this.i.display.register(this,ye(this));Rd(this);Sd(this)};g.va=function(a){var b=ze(this);null!==b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));T.prototype.va.call(this,a)};
function Ae(a,b){for(var d,e=0,h=a.J.length;e<h;e++)if(d=a.J[e],d===b)return e;return-1}function Be(a,b){if(null===a.J)return null;a=a.J[b];return null!==a&&"undefined"!==typeof a?a:null}function Ce(a){return Be(a,a.C)}function ze(a){return Be(a,a.I)}function De(a,b){a=ze(a);return null!==a&&null!==a.element?a.element[b]:0}
function Ee(a,b){if(-1!==b){a.log("_destroyVideoAt "+b);b=a.J[b];var d=b.element;if("undefined"!==typeof d&&null!==d){d.removeEventListener("loadstart",a.j,!1);d.removeEventListener("durationchange",a.j,!1);d.removeEventListener("loadedmetadata",a.j,!1);d.removeEventListener("loadeddata",a.j,!1);d.removeEventListener("progress",a.j,!1);d.removeEventListener("canplay",a.j,!1);d.removeEventListener("canplaythrough",a.j,!1);d.removeEventListener("play",a.j,!1);d.removeEventListener("pause",a.j,!1);d.removeEventListener("timeupdate",
a.j,!1);d.removeEventListener("volumechange",a.j,!1);d.removeEventListener("seeked",a.j,!1);d.removeEventListener("ended",a.j,!1);d.removeEventListener("error",a.j,!1);d.removeEventListener("waiting",a.j,!1);d.removeEventListener("stalled",a.j,!1);d.removeEventListener("playing",a.j,!1);d.removeEventListener("error",a.P,!1);d.pause();d.src="";if(!0!==I.wb)for(var e,h=0,k=d.children.length;h<k;h++)e=d.children[h],e.removeEventListener("error",a.P,!1),e.src="",d.removeChild(e);d.load();d.parentNode===
a.c&&a.c.removeChild(d)}b.element=null;null!==b.buffer&&(b.buffer.destroy(),b.buffer=null);null!==b.played&&(b.played.destroy(),b.played=null)}}
function Fe(a,b,d){a.rb=d||!1;a.log("Requesting index: "+b+", force: "+a.rb);-1!==a.C&&a.C!==b&&Ge(a);d=b===a.C?!0:!1;a.C=b;null!==a.Ca&&a.Ca.D(b);if(b!==a.I&&!0!==d){d=a.C;var e=document.createElement("video");e.setAttribute("webkit-playsinline","true");e.setAttribute("playsinline","true");e.setAttribute("width",a.pixelWidth);e.setAttribute("height",a.pixelHeight);e.volume=0;e.crossOrigin="anonymous";e.id="FORGE-VideoHTML5-"+a.N+"-"+d;var h=new He(e,"buffered"),k=new He(e,"played");d=a.J[d];d.element=
e;d.buffer=h;d.played=k;d.requestCount++;e=a.F[a.C];-1<a.I&&(d.element.addEventListener("loadstart",a.sb,!1),d.element.addEventListener("error",a.P,!1));!0===I.wb?d.element.src=e.url:(h=document.createElement("source"),h.addEventListener("error",a.P,!1),h.src=e.url,h.type=e.mimeType,d.element.appendChild(h));a.fc=a.xi.bind(a);!0===ye(a)?(a.f=a.i.audio.context,a.Eb=Omnitone.createFOADecoder(a.f,d.element,{channelMap:a.Oc}),a.ec=a.im.bind(a),a.Eb.initialize().then(a.fc,a.ec)):a.xi();-1===a.I?(a.log("No current video, set directly the current index"),
Ie(a,b)):(a.Oa.add(2E4,a.en,a),a.Oa.start())}}g.xi=function(){-1===this.C?ze(this).element.load():Ce(this).element.load()};g.im=function(){this.log("FOA decoder could not be initialized")};g.Pm=function(){var a=Ce(this).element;this.log("_onRequestLoadStart [readyState: "+a.readyState+"]");a.removeEventListener("loadstart",this.sb,!1);a.addEventListener("loadedmetadata",this.ub,!1)};
g.Rm=function(){var a=Ce(this).element;this.log("_onRequestLoadedMetaData [readyState: "+a.readyState+"]");a.removeEventListener("loadedmetadata",this.ub,!1);a.addEventListener("loadeddata",this.tb,!1)};g.Qm=function(){var a=Ce(this).element;this.log("_onRequestLoadedData [readyState: "+a.readyState+"]");a.removeEventListener("loadeddata",this.tb,!1);!0===I.Hc?(a.addEventListener("play",this.nb,!1),a.play()):Ie(this,this.C,!0)};
g.Nm=function(){var a=Ce(this).element;this.log("_onRequestCanPlayBeforeSeek [readyState: "+a.readyState+"]");a.pause();a.removeEventListener("play",this.nb,!1);a.addEventListener("seeked",this.vb,!1);var b=this.currentTime;a.currentTime=!0===this.M&&!1===this.rb?b+6:b};
g.Sm=function(){var a=Ce(this).element;this.log("_onRequestSeeked [readyState: "+a.readyState+"]");a.removeEventListener("seeked",this.vb,!1);a.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA?(a.removeEventListener("error",this.P,!1),Je(this)):!0===I.wb||!0===I.$b?a.addEventListener("canplaythrough",this.Ma,!1):a.addEventListener("canplay",this.Ma,!1)};
g.Mm=function(){var a=Ce(this).element;this.log("_onRequestCanPlayAfterSeek [readyState: "+a.readyState+"]");a.currentTime=this.currentTime;!0===I.wb||!0===I.$b?a.removeEventListener("canplaythrough",this.Ma,!1):a.removeEventListener("canplay",this.Ma,!1);a.removeEventListener("error",this.P,!1);Je(this)};
function Je(a){var b=ze(a);null!==b&&null!==b.element&&!1===a.rb&&(a.log("Current video listen to seek, wait both video to sync"),b.element.addEventListener("seeked",a.Fb,!1),a.Oa.af(10,a.nn,a));if(!0!==I.wb)for(var b=Ce(a).element,d,e=0,h=b.children.length;e<h;e++)d=b.children[e],d.removeEventListener("error",a.P,!1);!0===a.rb&&Ie(a,a.C)}g.Tm=function(){this.log("_onRequestSeekedWhileSync "+this.currentTime);var a=this.C;Ke(this,!1);Fe(this,a)};
g.nn=function(){this.log("_videoSyncTimerLoop "+this.C);var a=Ce(this);null!==a&&this.currentTime>=a.element.currentTime&&this.currentTime<a.element.currentTime+.05&&Ie(this,this.C)};g.en=function(){this.log("_requestTimeOutHandler "+this.C);Ke(this,!0)};g.Om=function(a){this.log("_onRequestError");this.log(a);Ke(this,!0)};
function Ie(a,b,d){if(b!==a.I){a.c.innerHTML="";var e=Ce(a);!0===a.M&&e.element.play();Le(a,e);e=ze(a);a.C=-1;a.I=b;b=ze(a);b.currentCount++;!0===d&&null!==e&&(b.element.currentTime=e.element.currentTime);d=b.element;d.addEventListener("loadstart",a.j,!1);d.addEventListener("durationchange",a.j,!1);d.addEventListener("loadedmetadata",a.j,!1);d.addEventListener("loadeddata",a.j,!1);d.addEventListener("progress",a.j,!1);d.addEventListener("canplay",a.j,!1);d.addEventListener("canplaythrough",a.j,!1);
d.addEventListener("play",a.j,!1);d.addEventListener("pause",a.j,!1);d.addEventListener("timeupdate",a.j,!1);d.addEventListener("volumechange",a.j,!1);d.addEventListener("seeked",a.j,!1);d.addEventListener("ended",a.j,!1);d.addEventListener("error",a.j,!1);d.addEventListener("waiting",a.j,!1);d.addEventListener("stalled",a.j,!1);d.addEventListener("playing",a.j,!1);a.c.appendChild(b.element);null!==e&&null!==e.element&&(e.element.removeEventListener("seeked",a.Fb,!1),d=Ae(a,e),-1!==d&&Ee(a,d));a.Oa.stop(!0);
null!==a.Aa&&a.Aa.D(a.I);""===a.cb&&Me(a,a.Wc)}}
g.Pl=function(){if(!1!==this.M&&-1===this.C){var a;a:{a=ze(this);var b=a.element.currentTime;if(!1!==a.element.playing)if(b===a.lastTimeStamp){if(a.downCount++,3<=a.downCount){a.lastTimeStamp=0;a=!0;break a}}else a.lastTimeStamp=b,a.downCount=0;a=!1}!0===a?(ze(this).leaveCount++,0<=this.I-1?(this.log("AutoQuality downgrade quality"),Fe(this,this.I-1,!0)):this.log("Can't downgrade video quality anymore!")):(a=ze(this),!0===(null!==a&&null!==a.buffer&&a.buffer.fk(a.element.currentTime,6)?!0:!1)&&this.I!==
this.F.length-1&&(a=this.I+1,!this.J[a].abortCount&&1>=this.J[a].leaveCount?(this.log("AutoQuality upgrade quality"),Fe(this,a)):this.log("AutoQuality do not attempt to load an already aborted video")))}};function Me(a,b){!1===I.Hc&&(b=xe.MANUAL,a.warn("Quality mode force to manual, you are not on desktop"));a.cb===b||b!==xe.Ib&&b!==xe.MANUAL||(a.cb=b,a.fb.stop(!1),a.cb===xe.Ib&&a.fb.start(),null!==a.Ba&&a.Ba.D(a.cb))}
function Ke(a,b){var d=Ce(a);null!==d&&(!0===b&&d.abortCount++,Ge(a),a.Oa.stop(!0),null!==a.za&&a.za.D())}
function Ge(a){var b=Ce(a);if(null!==b){var d=b.element;d.removeEventListener("loadstart",a.sb,!1);d.removeEventListener("loadedmetadata",a.ub,!1);d.removeEventListener("loadeddata",a.tb,!1);d.removeEventListener("play",a.nb,!1);d.removeEventListener("seeked",a.vb,!1);!0===I.wb||!0===I.$b?d.removeEventListener("canplaythrough",a.Ma,!1):d.removeEventListener("canplay",a.Ma,!1);d.removeEventListener("error",a.P,!1);b=Ae(a,b);-1!==b&&Ee(a,b);a.C=-1}}g.Yh=function(){Le(this)};
function Le(a,b){b=b||ze(a);null!==b&&null!==b.element&&!0===a.i.audio.enabled&&(b.element.volume=a.eb*a.i.audio.volume)}g.Xh=function(){var a=ze(this);null!==a&&null!==a.element&&!1===this.i.audio.enabled&&(a.element.volume=0)};
g.Dm=function(a){var b=ze(this).element;this.log(a.type+" [readyState: "+b.readyState+"]");switch(a.type){case "loadstart":null!==this.ma&&this.ma.D(a);break;case "durationchange":null!==this.ea&&b.readyState===HTMLMediaElement.HAVE_METADATA&&this.ea.D(a);break;case "loadedmetadata":this.sc=!0;null!==this.qa&&this.qa.D(a);break;case "loadeddata":null!==this.na&&this.na.D(a);break;case "progress":null!==this.ya&&this.ya.D(a);break;case "canplay":this.Ab=!0;null!==this.W&&this.W.D(a);break;case "canplaythrough":this.Ab=
!0;null!==this.Z&&this.Z.D(a);break;case "play":null!==this.ta&&this.ta.D(a);break;case "pause":this.M=!1;null!==this.sa&&this.sa.D(a);break;case "timeupdate":null!==this.Ia&&this.Ia.D(a);break;case "volumechange":null!==this.Ka&&b.readyState!==HTMLMediaElement.HAVE_NOTHING&&this.Ka.D(a);break;case "seeked":this.Ab=!1;null!==this.Da&&this.Da.D(a);break;case "ended":this.M=!1;this.currentTime=0;this.rc++;!0===this.cc&&this.play(0);null!==this.ga&&this.ga.D(a);break;case "error":null!==this.ha&&this.ha.D(a);
break;case "waiting":null!==this.Na&&this.Na.D(a);break;case "stalled":null!==this.Ea&&this.Ea.D(a);break;case "playing":null!==this.xa&&this.xa.D(a);break;default:this.warn('The event "'+a.type+'" is not handled.')}};function ye(a){return!0===a.zb&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}g.update=function(){null!==this.Eb&&!0===this.M&&this.Eb.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
g.load=function(a){if(null!==a)if(!0===B.T(a,"string")?a=[a]:!0===B.T(a,"VideoQuality")&&(a=[a]),!0===B.Fa(a,"string")){for(var b=[],d,e=0,h=a.length;e<h;e++)d=new Ne(a[e]),b.push(d);this.F=b}else!0===B.Fa(a,"VideoQuality")&&(this.F=a);null!==this.S&&this.S.D(this.F);if(null===this.F||!this.F.length)throw"$_VideoHTML5.load: Can't create video with no qualities set!";a=this.F.length;b=[];for(e=0;e<a;e++)d={index:e,element:null,buffer:null,played:null,requestCount:0,currentCount:0,abortCount:0,leaveCount:0,
uo:0,lastTimeStamp:0},b[e]=d;this.J=b;Fe(this,0)};g.play=function(a,b){this.currentTime=a;this.loop=b;a=ze(this);null!==a&&null!==a.element&&(a.element.play(),this.M=!0,this.vc++)};g.pause=function(){var a=ze(this);null!==a&&null!==a.element&&(a.element.pause(),this.M=!1)};g.stop=function(){var a=ze(this);null!==a&&null!==a.element&&(a.element.pause(),a.element.currentTime=0,this.M=!1)};g.Dl=function(){!0===this.M||!1===this.i.audio.enabled?this.pause():this.play()};
g.$a=function(){!0!==this.Va&&!1!==this.i.audio.enabled&&(this.Va=!0,this.uc=this.eb,this.eb=0,Le(this),null!==this.ra&&this.ra.D())};g.Zh=function(a){!1!==this.Va&&(a="number"===typeof a?a:this.uc,this.Va=!1,this.eb=G.X(a,0,1),Le(this),null!==this.Ja&&this.Ja.D())};
g.destroy=function(){Ge(this);this.Oa.destroy();this.Oa=null;this.fb.destroy();this.fb=null;null!==this.ma&&(this.ma.destroy(),this.ma=null);null!==this.qa&&(this.qa.destroy(),this.qa=null);null!==this.na&&(this.na.destroy(),this.na=null);null!==this.ya&&(this.ya.destroy(),this.ya=null);null!==this.ea&&(this.ea.destroy(),this.ea=null);null!==this.W&&(this.W.destroy(),this.W=null);null!==this.Z&&(this.Z.destroy(),this.Z=null);null!==this.ta&&(this.ta.destroy(),this.ta=null);null!==this.sa&&(this.sa.destroy(),
this.sa=null);null!==this.Ia&&(this.Ia.destroy(),this.Ia=null);null!==this.aa&&(this.aa.destroy(),this.aa=null);null!==this.Ka&&(this.Ka.destroy(),this.Ka=null);null!==this.Da&&(this.Da.destroy(),this.Da=null);null!==this.ga&&(this.ga.destroy(),this.ga=null);null!==this.ha&&(this.ha.destroy(),this.ha=null);null!==this.Na&&(this.Na.destroy(),this.Na=null);null!==this.Ea&&(this.Ea.destroy(),this.Ea=null);null!==this.xa&&(this.xa.destroy(),this.xa=null);null!==this.ra&&(this.ra.destroy(),this.ra=null);
null!==this.Ja&&(this.Ja.destroy(),this.Ja=null);null!==this.Ca&&(this.Ca.destroy(),this.Ca=null);null!==this.Aa&&(this.Aa.destroy(),this.Aa=null);null!==this.za&&(this.za.destroy(),this.za=null);null!==this.Ba&&(this.Ba.destroy(),this.Ba=null);null!==this.S&&(this.S.destroy(),this.S=null);for(var a=0,b=this.J.length;a<b;a++)Ee(this,a);this.j=this.Fb=this.Ma=this.vb=this.nb=this.tb=this.ub=this.sb=this.P=this.ec=this.fc=null;this.i.audio.onVolumeChange.remove(this.Yh,this);this.i.audio.onDisable.remove(this.Xh,
this);this.J=this.F=this.bc=null;T.prototype.destroy.call(this)};Object.defineProperty(K.prototype,"quality",{get:function(){return this.F[this.I]},set:function(a){if("number"===typeof a&&0<=a&&a<this.F.length)Me(this,xe.MANUAL),Fe(this,a);else if(!0===B.T(a,"VideoQuality")){a:{for(var b,d=0,e=this.F.length;d<e;d++)if(b=this.F[d],b===a){a=d;break a}a=-1}if(-1!==a)Me(this,xe.MANUAL),Fe(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(K.prototype,"qualityMode",{get:function(){return this.cb},set:function(a){a!==xe.Ib&&a!==xe.MANUAL||Me(this,a)}});Object.defineProperty(K.prototype,"qualities",{get:function(){return this.F}});Object.defineProperty(K.prototype,"requestIndex",{get:function(){return this.C}});Object.defineProperty(K.prototype,"currentIndex",{get:function(){return this.I}});Object.defineProperty(K.prototype,"videos",{get:function(){return this.J}});
Object.defineProperty(K.prototype,"element",{get:function(){var a=ze(this);return null!==a&&null!==a.element?a.element:null}});Object.defineProperty(K.prototype,"buffer",{get:function(){var a=ze(this);return null!==a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(K.prototype,"played",{get:function(){var a=ze(this);return null!==a&&null!==a.played?a.played:null}});Object.defineProperty(K.prototype,"originalWidth",{get:function(){return De(this,"videoWidth")}});
Object.defineProperty(K.prototype,"originalHeight",{get:function(){return De(this,"videoHeight")}});Object.defineProperty(K.prototype,"currentTime",{get:function(){return De(this,"currentTime")},set:function(a){if("number"===typeof a){var b=ze(this);null!==b&&null!==b.element&&(b.element.currentTime=a,null!==this.aa&&this.aa.D(a))}}});Object.defineProperty(K.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});
Object.defineProperty(K.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});Object.defineProperty(K.prototype,"duration",{get:function(){return De(this,"duration")}});Object.defineProperty(K.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(K.prototype,"playing",{get:function(){return this.M}});Object.defineProperty(K.prototype,"playCount",{get:function(){return this.vc}});
Object.defineProperty(K.prototype,"canPlay",{get:function(){return this.Ab}});Object.defineProperty(K.prototype,"endCount",{get:function(){return this.rc}});Object.defineProperty(K.prototype,"metaDataLoaded",{get:function(){return this.sc}});Object.defineProperty(K.prototype,"loop",{get:function(){return this.cc},set:function(a){"boolean"===typeof a&&(this.cc=a)}});
Object.defineProperty(K.prototype,"volume",{get:function(){return this.eb},set:function(a){"number"===typeof a&&(this.eb=G.X(a,0,1),this.Va=!1,Le(this))}});Object.defineProperty(K.prototype,"muted",{get:function(){return this.Va},set:function(a){!0===!!a?this.$a():this.Zh()}});Object.defineProperty(K.prototype,"ambisonic",{get:function(){return this.zb}});Object.defineProperty(K.prototype,"onLoadStart",{get:function(){null===this.ma&&(this.ma=new q(this));return this.ma}});
Object.defineProperty(K.prototype,"onLoadedMetaData",{get:function(){null===this.qa&&(this.qa=new q(this));return this.qa}});Object.defineProperty(K.prototype,"onLoadedData",{get:function(){null===this.na&&(this.na=new q(this));return this.na}});Object.defineProperty(K.prototype,"onProgress",{get:function(){null===this.ya&&(this.ya=new q(this));return this.ya}});Object.defineProperty(K.prototype,"onDurationChange",{get:function(){null===this.ea&&(this.ea=new q(this));return this.ea}});
Object.defineProperty(K.prototype,"onCanPlay",{get:function(){null===this.W&&(this.W=new q(this));return this.W}});Object.defineProperty(K.prototype,"onCanPlayThrough",{get:function(){null===this.Z&&(this.Z=new q(this));return this.Z}});Object.defineProperty(K.prototype,"onPlay",{get:function(){null===this.ta&&(this.ta=new q(this));return this.ta}});Object.defineProperty(K.prototype,"onPause",{get:function(){null===this.sa&&(this.sa=new q(this));return this.sa}});
Object.defineProperty(K.prototype,"onTimeUpdate",{get:function(){null===this.Ia&&(this.Ia=new q(this));return this.Ia}});Object.defineProperty(K.prototype,"onCurrentTimeChange",{get:function(){null===this.aa&&(this.aa=new q(this));return this.aa}});Object.defineProperty(K.prototype,"onVolumeChange",{get:function(){null===this.Ka&&(this.Ka=new q(this));return this.Ka}});Object.defineProperty(K.prototype,"onSeeked",{get:function(){null===this.Da&&(this.Da=new q(this));return this.Da}});
Object.defineProperty(K.prototype,"onEnded",{get:function(){null===this.ga&&(this.ga=new q(this));return this.ga}});Object.defineProperty(K.prototype,"onError",{get:function(){null===this.ha&&(this.ha=new q(this));return this.ha}});Object.defineProperty(K.prototype,"onWaiting",{get:function(){null===this.Na&&(this.Na=new q(this));return this.Na}});Object.defineProperty(K.prototype,"onStalled",{get:function(){null===this.Ea&&(this.Ea=new q(this));return this.Ea}});
Object.defineProperty(K.prototype,"onPlaying",{get:function(){null===this.xa&&(this.xa=new q(this));return this.xa}});Object.defineProperty(K.prototype,"onMute",{get:function(){null===this.ra&&(this.ra=new q(this));return this.ra}});Object.defineProperty(K.prototype,"onUnmute",{get:function(){null===this.Ja&&(this.Ja=new q(this));return this.Ja}});Object.defineProperty(K.prototype,"onQualityRequest",{get:function(){null===this.Ca&&(this.Ca=new q(this));return this.Ca}});
Object.defineProperty(K.prototype,"onQualityChange",{get:function(){null===this.Aa&&(this.Aa=new q(this));return this.Aa}});Object.defineProperty(K.prototype,"onQualityAbort",{get:function(){null===this.za&&(this.za=new q(this));return this.za}});Object.defineProperty(K.prototype,"onQualityModeChange",{get:function(){null===this.Ba&&(this.Ba=new q(this));return this.Ba}});Object.defineProperty(K.prototype,"onQualitiesLoaded",{get:function(){null===this.S&&(this.S=new q(this,!0));return this.S}});
function J(a,b,d,e){this.i=a;this.Ml=b;this.Wc=d||null;this.Oa="";this.Da=null;this.Ll=e||xe.Ib;this.Ma="";this.j=null;this.Xc=!1;this.Ja=1;this.Ba=!1;this.ki=0;this.hi=!1;this.Va=this.f=null;this.jf=this.hf=this.Ea=this.Na=0;this.eb=this.za=this.vc=this.Oc=null;this.cb=this.Ca=!1;this.gi=this.li=0;this.zb=this.lf=this.cc=this.ec=this.Fb=this.rc=this.Ka=this.sb=this.fc=this.uc=this.sc=this.Ab=this.Eb=this.rb=this.fb=this.nb=this.bc=this.ub=this.vb=this.tb=this.Aa=this.qa=this.C=this.Ia=this.na=this.ra=
this.ha=this.ta=this.S=this.P=this.sa=this.ya=this.J=this.xa=this.ea=this.ga=this.I=this.F=this.M=this.ma=this.Z=this.aa=this.W=null;T.call(this,a,null,"VideoDash")}J.prototype=Object.create(T.prototype);J.prototype.constructor=J;var Oe={VIDEO:"video",AUDIO:"audio"};g=J.prototype;
g.Ga=function(){T.prototype.Ga.call(this);if("undefined"===typeof dashjs)throw"$_VideoDash._boot: Can't create MPEG-DASH video stream without dash.js Media Player.";this.N=this.Ml;ba(this);this.tb=this.Fm.bind(this);this.nb=this.Bm.bind(this);this.vb=this.yl.bind(this);this.ub=this.Gm.bind(this);this.bc=this.Jm.bind(this);this.fb=this.Am.bind(this);this.rb=this.wl.bind(this);this.Eb=this.Al.bind(this);this.Ab=this.zl.bind(this);this.sc=this.Ym.bind(this);this.uc=this.cn.bind(this);this.fc=this.Vm.bind(this);
this.sb=this.xl.bind(this);this.Ka=this.Cm.bind(this);this.rc=this.Wm.bind(this);this.Fb=this.Im.bind(this);this.ec=this.Lm.bind(this);this.cc=this.Km.bind(this);this.lf=this.Xm.bind(this);this.zb=this.Hm.bind(this);this.i.audio.onVolumeChange.add(this.Vh,this);this.i.audio.onDisable.add(this.Uh,this);this.C=new q(this,!0);null!==this.Wc&&this.load(this.Wc);this.i.display.register(this);Rd(this);Sd(this)};
g.va=function(a){var b=this.j;null!==b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));T.prototype.va.call(this,a)};function Pe(a,b){a=a.j;return null!==a&&null!==a.element?a.element[b]:0}
g.Fm=function(a){this.log("onLoadStart [readyState: "+this.j.element.readyState+"]");var b=this.Oa,d=this.f.getBitrateInfoListFor(Oe.VIDEO),e=[],h;if(null!==d){for(var k=0,n=d.length;k<n;k++)h=new Ne(b),h.id=d[k].qualityIndex,h.bitrate=d[k].bitrate,h.width=d[k].width,h.height=d[k].height,e.push(h);this.Da=e;null!==this.C&&this.C.D(e)}else this.destroy();null!==this.W&&this.W.D(a)};g.Xm=function(a){this.log("_onSwitchCompleted [readyState: "+this.j.element.readyState+"]");this.Va=a.toStreamInfo};
g.Hm=function(a){this.log("_onMetricsChangedHandler [readyState: "+this.j.element.readyState+"]");null===this.Oc&&(this.Oc=this.f.getMetricsFor(Oe.VIDEO));null===this.vc&&(this.vc=this.f.getMetricsFor(Oe.AUDIO));null===this.za&&(this.za=this.f.getDashMetrics());if(null!==this.Aa){var b;a.mediaType===Oe.VIDEO&&(b=Qe(this,Oe.VIDEO,this.Oc,this.za))&&(this.eb={videoBitrate:b.bitrate,videoIndex:b.index,videoPendingIndex:b.qk,videoMaxIndex:b.jk,videoBufferLength:b.nj,videoDroppedFrames:b.droppedFrames});
a.mediaType===Oe.AUDIO&&(b=Qe(this,Oe.AUDIO,this.vc,this.za))&&(this.eb={audioBitrate:b.bitrate,audioIndex:b.index,audioPendingIndex:b.qk,audioMaxIndex:b.jk,audioBufferLength:b.nj,audioDroppedFrames:b.droppedFrames});this.Aa.D(a)}};
function Qe(a,b,d,e){if(null!==d&&null!==e){var h=a.Va.index,k,n,v,y,D,db;k=e.getCurrentRepresentationSwitch(d);null!==k&&(n=Math.round(e.getBandwidthForRepresentation(k.to,h)/1E3));if(isNaN(n)||void 0===n)n=0;b===Oe.VIDEO?(v=a.Na+1,y=a.Ea+1):b===Oe.AUDIO&&(v=a.hf+1,y=a.jf+1);if(isNaN(v)||void 0===v)v=0;if(isNaN(y)||void 0===y)y=0;a=e.getMaxIndexForBufferType(b,h);if(isNaN(a)||void 0===a)a=0;b=e.getCurrentBufferLevel(d);null!==b&&(D=b.toPrecision(5));if(isNaN(D)||void 0===D)D=0;d=e.getCurrentDroppedFrames(d);
null!==d&&(db=d.droppedFrames);return{bitrate:n,index:v,qk:y,jk:a,nj:D,droppedFrames:db}}return null}g.Km=function(a){this.log("onQualityChange [readyState: "+this.j.element.readyState+"]");a.mediaType===Oe.AUDIO?this.jf=this.hf=a.newQuality:a.mediaType===Oe.VIDEO&&(this.Ea=this.Na=a.newQuality,null!==this.na&&this.na.D(this.Ea))};
g.Lm=function(a){this.log("onQualityRequest [readyState: "+this.j.element.readyState+"]");a.mediaType===Oe.AUDIO?(this.hf=a.oldQuality,this.jf=a.newQuality):a.mediaType===Oe.VIDEO&&(this.Na=a.oldQuality,this.Ea=a.newQuality,null!==this.ra&&this.ra.D(this.Ea))};g.Bm=function(a){var b=this.j.element;this.log("onDurationChange [readyState: "+b.readyState+"]");null!==this.M&&b.readyState===HTMLMediaElement.HAVE_METADATA&&this.M.D(a)};
g.yl=function(a){this.log("onLoadedMetaData [readyState: "+this.j.element.readyState+"]");this.hi=!0;null!==this.aa&&this.aa.D(a)};g.Gm=function(a){this.log("onLoadedData [readyState: "+this.j.element.readyState+"]");null!==this.Z&&this.Z.D(a)};g.Jm=function(a){null!==this.ma&&this.ma.D(a)};g.Am=function(a){this.log("onCanPlay [readyState: "+this.j.element.readyState+"]");this.cb=!0;null!==this.F&&this.F.D(a)};
g.wl=function(a){this.log("onCanPlayThrough [readyState: "+this.j.element.readyState+"]");this.cb=!0;null!==this.I&&this.I.D(a)};g.Al=function(a){this.log("onPlay [readyState: "+this.j.element.readyState+"]");null!==this.ga&&this.ga.D(a)};g.zl=function(a){this.log("onPause [readyState: "+this.j.element.readyState+"]");this.Ca=!1;null!==this.ea&&this.ea.D(a)};g.Ym=function(a){null!==this.xa&&this.xa.D(a)};
g.cn=function(a){var b=this.j.element;this.log("onVolumeChange [readyState: "+b.readyState+"]");null!==this.ya&&b.readyState!==HTMLMediaElement.HAVE_NOTHING&&this.ya.D(a)};g.Vm=function(a){this.log("onSeeked [readyState: "+this.j.element.readyState+"]");this.cb=!1;null!==this.sa&&this.sa.D(a)};g.xl=function(a){this.log("onEnded [readyState: "+this.j.element.readyState+"]");this.Ca=!1;this.gi++;!0===this.Xc&&this.play();null!==this.P&&this.P.D(a)};
g.Cm=function(a){this.log("onError [readyState: "+this.j.element.readyState+"]");null!==this.S&&this.S.D(a)};g.Wm=function(a){this.log("onStalled [readyState: "+this.j.element.readyState+"]");null!==this.ta&&this.ta.D(a)};g.Im=function(a){this.log("onPlaying [readyState: "+this.j.element.readyState+"]");null!==this.ha&&this.ha.D(a)};g.Uh=function(){var a=this.j;null!==a&&null!==a.element&&!1===this.i.audio.enabled&&this.f.setVolume(0)};g.Vh=function(){Re(this)};
function Re(a){var b=a.j;null!==b&&null!==b.element&&!0===a.i.audio.enabled&&(a.f.setVolume(a.Ja*a.i.audio.volume),!0===a.Ba?a.f.setMute(!0):a.f.setMute(!1))}function Se(a,b){a.Ea=b;if(null!==a.Va&&null!==a.f&&!0===a.f.isReady()&&null!==a.za){var d=a.Va.index,e=a.za.getMaxIndexForBufferType(Oe.VIDEO,d),d=a.za.getMaxIndexForBufferType(Oe.AUDIO,d),h=b;h>=e&&(h=e-1);0>h&&(h=0);b>=d&&(b=d-1);0>b&&(b=0);a.f.setQualityFor(Oe.VIDEO,h);a.f.setQualityFor(Oe.AUDIO,b)}Re(a)}
function Te(a,b){a.Ma===b||b!==xe.Ib&&b!==xe.MANUAL||(a.Ma=b,null!==a.f&&!0===a.f.isReady()&&(b===xe.MANUAL?(a.f.setAutoSwitchQualityFor(Oe.VIDEO,!1),a.f.setAutoSwitchQualityFor(Oe.AUDIO,!1)):(a.f.setAutoSwitchQualityFor(Oe.VIDEO,!0),a.f.setAutoSwitchQualityFor(Oe.AUDIO,!0))),null!==a.qa&&a.qa.D(a.Ma))}
g.load=function(a){null!==a&&(!0===B.T(a,"string")?a=[a]:!0===B.T(a,"VideoQuality")&&(a=[a]),!0===B.Fa(a,"string")?this.Oa=a[0]:!0===B.Fa(a,"VideoQuality")&&(this.Oa=a[0].url));if(""===this.Oa)throw"$_VideoDash : Can't create video with no manifest!";this.j={index:0,element:null,buffer:null,played:null};a=document.createElement("video");a.setAttribute("webkit-playsinline","webkit-playsinline");a.setAttribute("width",this.pixelWidth);a.setAttribute("height",this.pixelHeight);a.volume=0;a.crossOrigin=
"anonymous";a.id="FORGE-VideoDash-"+this.N;var b=new He(a,"buffered"),d=new He(a,"played"),e=this.j;e.element=a;e.buffer=b;e.played=d;e.lastTimeStamp=0;this.f=dashjs.MediaPlayer().create();this.f.getDebug().setLogToBrowserConsole(!1);this.f.initialize();this.f.setAutoPlay(!1);this.f.attachView(this.j.element);this.f.attachSource(this.Oa);!0===this.f.isReady()&&(this.f.on(dashjs.MediaPlayer.events.CAN_PLAY,this.fb),this.f.on(dashjs.MediaPlayer.events.ERROR,this.Ka),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ENDED,
this.sb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.Ka),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.vb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Ab),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,this.bc),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.fc),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Eb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.sc),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,
this.cc),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.ec),this.f.on(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.tb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Fb),this.f.on(dashjs.MediaPlayer.events.BUFFER_EMPTY,this.rc),this.f.on(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.lf),this.f.on(dashjs.MediaPlayer.events.METRIC_CHANGED,this.zb),this.j.element.addEventListener("loadeddata",this.ub,!1),this.j.element.addEventListener("durationchange",this.nb,
!1),this.j.element.addEventListener("canplaythrough",this.rb,!1),this.j.element.addEventListener("volumechange",this.uc,!1),this.c.innerHTML="",this.c.appendChild(this.j.element));""===this.Ma&&Te(this,this.Ll)};g.play=function(a,b){this.currentTime=a;this.loop=b;null!==this.f&&!0===this.f.isReady()&&(this.f.play(),this.Ca=!0,this.li++)};g.pause=function(){null!==this.f&&!0===this.f.isReady()&&(this.f.pause(),this.Ca=!1)};
g.stop=function(){null!==this.f&&!0===this.f.isReady()&&(this.f.pause(),this.f.seek(0),this.j.element.currentTime=0,this.Ca=!1)};g.Cl=function(){!0===this.Ca||!1===this.i.audio.enabled?this.pause():this.play()};g.$a=function(){!0!==this.Ba&&!1!==this.i.audio.enabled&&(this.Ba=!0,this.ki=this.Ja,this.Ja=0,Re(this))};g.Wh=function(a){!1!==this.Ba&&(a="number"===typeof a?a:this.ki,this.Ba=!1,this.Ja=G.X(a,0,1),Re(this))};g.Bl=function(a){null!==this.f&&!0===this.f.isReady()&&this.f.enableBufferOccupancyABR(a)};
g.destroy=function(){this.log("_destroyVideo");null!==this.f&&!0===this.f.isReady()&&(this.f.off(dashjs.MediaPlayer.events.CAN_PLAY,this.fb),this.f.off(dashjs.MediaPlayer.events.ERROR,this.Ka),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ENDED,this.sb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.Ka),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.vb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Ab),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,
this.bc),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.fc),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Eb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.sc),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.cc),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.ec),this.f.off(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.tb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Fb),this.f.off(dashjs.MediaPlayer.events.BUFFER_EMPTY,
this.rc),this.f.off(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.lf),this.f.off(dashjs.MediaPlayer.events.METRIC_CHANGED,this.zb),this.j.element.removeEventListener("loadeddata",this.ub,!1),this.j.element.removeEventListener("durationchange",this.nb,!1),this.j.element.removeEventListener("canplaythrough",this.rb,!1),this.j.element.removeEventListener("volumechange",this.uc,!1),this.f.pause(),this.f.reset());var a=this.j,b=a.element;"undefined"!==typeof b&&null!==b&&b.parentNode===this.c&&
this.c.removeChild(b);a.element=null;null!==a.buffer&&(a.buffer.destroy(),a.buffer=null);null!==a.played&&(a.played.destroy(),a.played=null);null!==this.W&&(this.W.destroy(),this.W=null);null!==this.aa&&(this.aa.destroy(),this.aa=null);null!==this.Z&&(this.Z.destroy(),this.Z=null);null!==this.ma&&(this.ma.destroy(),this.ma=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.F&&(this.F.destroy(),this.F=null);null!==this.I&&(this.I.destroy(),this.I=null);null!==this.ga&&(this.ga.destroy(),
this.ga=null);null!==this.ea&&(this.ea.destroy(),this.ea=null);null!==this.xa&&(this.xa.destroy(),this.xa=null);null!==this.J&&(this.J.destroy(),this.J=null);null!==this.ya&&(this.ya.destroy(),this.ya=null);null!==this.sa&&(this.sa.destroy(),this.sa=null);null!==this.P&&(this.P.destroy(),this.P=null);null!==this.S&&(this.S.destroy(),this.S=null);null!==this.ta&&(this.ta.destroy(),this.ta=null);null!==this.ha&&(this.ha.destroy(),this.ha=null);null!==this.ra&&(this.ra.destroy(),this.ra=null);null!==
this.na&&(this.na.destroy(),this.na=null);null!==this.Ia&&(this.Ia.destroy(),this.Ia=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.qa&&(this.qa.destroy(),this.qa=null);null!==this.Aa&&(this.Aa.destroy(),this.Aa=null);this.zb=this.cc=this.ec=this.rc=this.Fb=this.Ka=this.sb=this.fc=this.uc=this.sc=this.Ab=this.Eb=this.rb=this.fb=this.nb=this.bc=this.ub=this.vb=this.tb=null;this.i.audio.onVolumeChange.remove(this.Vh,this);this.i.audio.onDisable.remove(this.Uh,this);this.j=this.Da=this.Wc=
this.Va=this.eb=this.za=this.vc=this.Oc=this.f=null;T.prototype.destroy.call(this)};Object.defineProperty(J.prototype,"monitoring",{get:function(){return this.eb}});
Object.defineProperty(J.prototype,"quality",{get:function(){return this.Da[this.Na]},set:function(a){if("number"===typeof a&&0<=a&&a<this.Da.length)Te(this,xe.MANUAL),Se(this,a);else if(!0===B.T(a,"VideoQuality")){a:{for(var b,d=0,e=this.Da.length;d<e;d++)if(b=this.Da[d],b===a){a=d;break a}a=-1}if(-1!==a)Te(this,xe.MANUAL),Se(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(J.prototype,"qualityMode",{get:function(){return this.Ma},set:function(a){a!==xe.Ib&&a!==xe.MANUAL||Te(this,a)}});Object.defineProperty(J.prototype,"qualities",{get:function(){return this.Da}});Object.defineProperty(J.prototype,"requestIndex",{get:function(){return this.Ea}});Object.defineProperty(J.prototype,"currentIndex",{get:function(){return this.Na}});Object.defineProperty(J.prototype,"video",{get:function(){return this.j}});
Object.defineProperty(J.prototype,"element",{get:function(){var a=this.j;return null!==a&&null!==a.element?a.element:null}});Object.defineProperty(J.prototype,"buffer",{get:function(){var a=this.j;return null!==a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(J.prototype,"played",{get:function(){var a=this.j;return null!==a&&null!==a.played?a.played:null}});Object.defineProperty(J.prototype,"originalWidth",{get:function(){return Pe(this,"videoWidth")}});
Object.defineProperty(J.prototype,"originalHeight",{get:function(){return Pe(this,"videoHeight")}});Object.defineProperty(J.prototype,"currentTime",{get:function(){return this.f.time()},set:function(a){"number"===typeof a&&(this.f.seek(a),null!==this.J&&this.J.D(a))}});Object.defineProperty(J.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});Object.defineProperty(J.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});
Object.defineProperty(J.prototype,"duration",{get:function(){return this.f.duration()}});Object.defineProperty(J.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(J.prototype,"playing",{get:function(){return this.Ca}});Object.defineProperty(J.prototype,"playCount",{get:function(){return this.li}});Object.defineProperty(J.prototype,"canPlay",{get:function(){return this.cb}});Object.defineProperty(J.prototype,"endCount",{get:function(){return this.gi}});
Object.defineProperty(J.prototype,"metaDataLoaded",{get:function(){return this.hi}});Object.defineProperty(J.prototype,"loop",{get:function(){return this.Xc},set:function(a){"boolean"===typeof a&&(this.Xc=a)}});Object.defineProperty(J.prototype,"volume",{get:function(){return this.Ja},set:function(a){"number"===typeof a&&(this.Ja=G.X(a,0,1),this.Ba=!1,Re(this))}});Object.defineProperty(J.prototype,"muted",{get:function(){return this.Ba},set:function(a){!0===!!a?this.$a():this.Wh()}});
Object.defineProperty(J.prototype,"onLoadStart",{get:function(){null===this.W&&(this.W=new q(this));return this.W}});Object.defineProperty(J.prototype,"onLoadedMetaData",{get:function(){null===this.aa&&(this.aa=new q(this));return this.aa}});Object.defineProperty(J.prototype,"onLoadedData",{get:function(){null===this.Z&&(this.Z=new q(this));return this.Z}});Object.defineProperty(J.prototype,"onProgress",{get:function(){null===this.ma&&(this.ma=new q(this));return this.ma}});
Object.defineProperty(J.prototype,"onDurationChange",{get:function(){null===this.M&&(this.M=new q(this));return this.M}});Object.defineProperty(J.prototype,"onCanPlay",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});Object.defineProperty(J.prototype,"onCanPlayThrough",{get:function(){null===this.I&&(this.I=new q(this));return this.I}});Object.defineProperty(J.prototype,"onPlay",{get:function(){null===this.ga&&(this.ga=new q(this));return this.ga}});
Object.defineProperty(J.prototype,"onPause",{get:function(){null===this.ea&&(this.ea=new q(this));return this.ea}});Object.defineProperty(J.prototype,"onTimeUpdate",{get:function(){null===this.xa&&(this.xa=new q(this));return this.xa}});Object.defineProperty(J.prototype,"onCurrentTimeChange",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});Object.defineProperty(J.prototype,"onVolumeChange",{get:function(){null===this.ya&&(this.ya=new q(this));return this.ya}});
Object.defineProperty(J.prototype,"onSeeked",{get:function(){null===this.sa&&(this.sa=new q(this));return this.sa}});Object.defineProperty(J.prototype,"onEnded",{get:function(){null===this.P&&(this.P=new q(this));return this.P}});Object.defineProperty(J.prototype,"onError",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(J.prototype,"onStalled",{get:function(){null===this.ta&&(this.ta=new q(this));return this.ta}});
Object.defineProperty(J.prototype,"onWaiting",{get:function(){return this.onStalled}});Object.defineProperty(J.prototype,"onPlaying",{get:function(){null===this.ha&&(this.ha=new q(this));return this.ha}});Object.defineProperty(J.prototype,"onQualityRequest",{get:function(){null===this.ra&&(this.ra=new q(this));return this.ra}});Object.defineProperty(J.prototype,"onQualityChange",{get:function(){null===this.na&&(this.na=new q(this));return this.na}});
Object.defineProperty(J.prototype,"onQualityAbort",{get:function(){null===this.Ia&&(this.Ia=new q(this));return this.Ia}});Object.defineProperty(J.prototype,"onMetricsChanged",{get:function(){null===this.Aa&&(this.Aa=new q(this));return this.Aa}});Object.defineProperty(J.prototype,"onQualitiesLoaded",{get:function(){null===this.C&&(this.C=new q(this,!0));return this.C}});Object.defineProperty(J.prototype,"onQualityModeChange",{get:function(){null===this.qa&&(this.qa=new q(this));return this.qa}});
function He(a,b){this.c=a;this.f=b;l.call(this,"VideoTimeRanges")}He.prototype=Object.create(l.prototype);He.prototype.constructor=He;
He.prototype.j=function(a){var b=this.c[this.f];if(!this.length)return this.warn("No available range for now"),null;if(a>this.length-1)return this.warn("Time range out of bounds, returning the last available range"),this.j(this.length-1);if(0>a)return this.warn("Time range out of bounds, returning the first available range"),this.j(0);var d=b.start(a);a=b.end(a);return{start:d,end:a}};
He.prototype.fk=function(a,b){"number"!==typeof b&&(b=0);for(var d=this.c[this.f],e,h,k=this.length;k--;)if(e=d.start(k),h=d.end(k),a>=e&&a+b<=h)return!0;return!1};Object.defineProperty(He.prototype,"length",{get:function(){return this.c[this.f].length}});function Ne(a){this.m="";this.j=a||"";this.o=this.c="";this.f=this.u=this.A=0;l.call(this,"VideoQuality")}Ne.prototype=Object.create(l.prototype);Ne.prototype.constructor=Ne;
function Ue(a){var b=["mp4","webm","ogg"];a=Da(a);if(""!==a.extension&&-1!==b.indexOf(a.extension))return"video/"+a.extension;b=["mpd"];return""!==a.extension&&-1!==b.indexOf(a.extension)?"application/dash+xml":""}Object.defineProperty(Ne.prototype,"id",{get:function(){return this.m},set:function(a){if("number"===typeof a||"string"===typeof a)this.m=a}});Object.defineProperty(Ne.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.j=a)}});
Object.defineProperty(Ne.prototype,"mimeType",{get:function(){""===this.c&&""!==this.j&&(this.c=Ue(this.j));return this.c}});Object.defineProperty(Ne.prototype,"name",{get:function(){return this.o},set:function(a){"string"===typeof a&&(this.o=a)}});Object.defineProperty(Ne.prototype,"framerate",{get:function(){return 0}});Object.defineProperty(Ne.prototype,"bitrate",{get:function(){return this.A},set:function(a){"number"===typeof a&&(this.A=a)}});
Object.defineProperty(Ne.prototype,"width",{get:function(){return this.u},set:function(a){"number"===typeof a&&(this.u=a)}});Object.defineProperty(Ne.prototype,"height",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(Ne.prototype,"speed",{get:function(){return 1}});var xe={Ib:"auto",MANUAL:"manual"},Na={df:"dash",Kl:"html5",Od:"unknown"};function va(a){this.i=a;this.N=new Ve;this.m=new Ve;this.f=new Ve;this.c=new Ve;this.j=0}
var A={JSON:"json",Ub:"xml",IMAGE:"image",qb:"sound"},We={Uc:["forge","forgejs","FORGE"]};We.JSON=["forge.story.config"].concat(We.Uc);We.Ub=[].concat(We.Uc);We.IMAGE=[].concat(We.Uc);We.qb=[].concat(We.Uc);function Xe(a,b){var d=null;switch(b){case A.JSON:d=a.N;break;case A.Ub:d=a.m;break;case A.IMAGE:d=a.f;break;case A.qb:d=a.c}return d}function Ye(a,b,d){var e=Xe(a,b),h=(d||"FORGE-cache")+"-"+a.j;a.j++;return!1===e.has(h)&&!1===Ze(b,h)?h:Ye(a,b,d)}
function Ze(a,b){var d=null;switch(a){case A.JSON:d=We.JSON;break;case A.Ub:d=We.Ub;break;case A.IMAGE:d=We.IMAGE;break;case A.qb:d=We.qb}a=d;return null!==a?-1!==a.indexOf(b.toLowerCase()):!1}g=va.prototype;g.has=function(a,b){a=Xe(this,a);return null!==a?a.has(b):!1};g.get=function(a,b){return!0===this.has(a,b)&&(a=Xe(this,a),null!==a)?a.get(b):null};
g.add=function(a,b,d){var e;(e="string"!==typeof b||""===b)||(e=Xe(this,a),e=!0===(!0===Ze(a,b)&&!0===e.has(b)));e&&(b=Ye(this,a,a+"-cache"));return!1===this.has(b,a)&&(a=Xe(this,a),null!==a)?(a.set(b,d),!0):!1};g.remove=function(a,b){return!0===this.has(a,b)&&(a=Xe(this,a),null!==a)?(a.Ue(b),!0):!1};g.destroy=function(){this.c=this.f=this.N=this.i=null};function $e(){}g=$e.prototype;g.key="";g.url="";g.type="";g.data=null;g.po=null;g.Bb=!1;g.Pk=!1;g.Ok="";g.constructor=$e;
function wa(a){this.i=a;l.call(this,"Loader")}wa.prototype=Object.create(l.prototype);g=wa.prototype;g.constructor=wa;g.json=function(a,b,d,e,h,k){var n=new $e;n.type="json";n.key=a;n.url=b;n.c=d;n.f=e;n.N=h;n.j=k;af(this,n,"text",this.om,this.pm)};
g.om=function(a,b){if(b.responseText){if(a.data=Object(JSON.parse(b.responseText)),!1===this.i.cache.has(A.JSON,a.key)?this.i.cache.add(A.JSON,a.key,a):this.log("$_Loader.json : JSON file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.N=null;a.j=null;b.call(d,a)}}else throw"$_Loader.json : JSON file empty ?";};
g.pm=function(a,b){if(b.responseText){if("function"===typeof a.N&&null!==a.j){b=a.N;var d=a.j;a.c=null;a.f=null;a.N=null;a.j=null;b.call(d,a)}}else throw"$_Loader.json : JSON file empty ?";};g.Vk=function(a,b,d,e,h,k){h=new $e;h.type="xml";h.key=a;h.url=b;h.c=d;h.f=e;h.N=d;h.j=k;af(this,h,"document",this.pn,this.qn)};
g.pn=function(a,b){if(b.responseXML){if(a.data=b.responseXML,!1===this.i.cache.has(A.Ub,a.key)?this.i.cache.add(A.Ub,a.key,a):this.log("$_Loader.xml : XML file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.N=null;a.j=null;b.call(d,a)}}else throw"$_Loader.xml : XML file empty ?";};
g.qn=function(a,b){if(b.responseXML){if("function"===typeof a.N&&null!==a.j){b=a.N;var d=a.j;a.c=null;a.f=null;a.N=null;a.j=null;b.call(d,a)}}else throw"$_Loader.xml : JSON file empty ?";};g.sound=function(a,b,d,e,h){var k=new $e;k.type="sound";k.key=a;k.url=b;k.c=d;k.f=e;!0===this.i.audio.useWebAudio&&!0!==h?af(this,k,"arraybuffer",this.Zi):!0!==this.i.audio.useAudioTag&&!0!==h||bf(k,this.Zi,this)};
g.Zi=function(a,b){!0===this.i.audio.useWebAudio&&"undefined"!==typeof b&&(a.data=b.response);this.i.cache.add(A.qb,a.key,a);"function"===typeof a.c&&null!==a.f&&a.c.call(a.f,a)};
function bf(a,b,d){function e(){this.removeEventListener("canplay",h);this.removeEventListener("error",e);throw"$_Loader : Could not load HTMLMediaElement "+a.url;}function h(){this.removeEventListener("canplay",h);this.removeEventListener("error",e);"function"===typeof b&&(a.data=this,b.call(d,a))}var k=new Audio;k.addEventListener("canplay",h);k.addEventListener("error",e);k.preload="auto";k.crossOrigin="anonymous";k.src=a.url;k.load()}
function af(a,b,d,e,h){b.Bb=!0;var k=new XMLHttpRequest;k.open("GET",b.url,!0);k.responseType=d;k.onreadystatechange=function(){if(k.readyState===XMLHttpRequest.DONE){if(200!==k.status&&k.status)throw"$_Loader._xhr : Could not load "+b.url;this.onreadystatechange=null;"function"===typeof e&&(b.loaded=!0,e.call(this,b,k))}}.bind(a);k.onerror=function(){"function"===typeof h&&h.call(this,b,k)}.bind(a);k.send()}
g.image=function(a,b,d,e){var h=new $e;h.type="image";h.key=a;h.url=b;h.data=new Image;h.data.crossOrigin="anonymous";h.data.onload=function(){h.data.onload=null;h.data.onerror=null;h.Bb=!1;h.loaded=!0;this.i.cache.add(A.IMAGE,h.key,h);d.call(e,h)}.bind(this);h.data.onerror=function(){h.data.onload=null;h.data.onerror=null;throw"ERROR : $_Loader.image, failed to load image key : "+a+" at url "+b;};h.data.src=h.url;h.Bb=!0};
g.Gg=function(a,b,d){for(var e=document.getElementsByTagName("head")[0],h=e.getElementsByTagName("script"),k=0,n=h.length;k<n;k++)if(h[k].src===a){this.warn("Attempt to load an already loaded script!");b.call(d);return}var v=document.createElement("script");v.type="text/javascript";v.onload=function(){v.onload=null;b.call(d)};v.src=a;e.appendChild(v)};
g.rj=function(a,b,d){var e=document.createElement("link");e.type="text/css";e.rel="stylesheet";"undefined"!==typeof b&&"undefined"!==typeof d&&(e.onload=function(){e.onload=null;b.call(d)});e.href=a;document.getElementsByTagName("head")[0].appendChild(e)};g.destroy=function(){this.i=null;l.prototype.destroy.call(this)};function ja(a){this.i=a;this.j=this.f=0;this.c=null;l.call(this,"DependencyManager")}ja.prototype=Object.create(l.prototype);ja.prototype.constructor=ja;
ja.prototype.add=function(a){"undefined"!==typeof a&&"string"===typeof a.url&&(this.f++,this.i.load.Gg(a.url,this.m,this))};ja.prototype.m=function(){this.j++;this.f-this.j||(console.log("DependencyManager : all scripts loaded"),null!==this.c&&this.c.D())};ja.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(ja.prototype,"dependencies",{get:function(){return this.f}});
Object.defineProperty(ja.prototype,"onAllScriptsLoaded",{get:function(){null===this.c&&(this.c=new q(this));return this.c}});function ka(a){this.i=a;this.f=0;this.c=null;l.call(this,"Clock");this.f=Date.now();this.c=[]}ka.prototype=Object.create(l.prototype);g=ka.prototype;g.constructor=ka;g.Zm=function(a){a:{if(null!==this.c)for(var b,d=0,e=this.c.length;d<e;d++)if(b=this.c[d],b===a.emitter){a=d;break a}a=-1}-1!==a&&this.c.splice(a,1)};g.create=function(a){return this.add(new X(this.i,a))};
g.add=function(a){this.c.push(a);a.onDestroy.add(this.Zm,this);return a};g.update=function(){this.f=Date.now();for(var a=0,b=this.c.length;a<b;a++)this.c[a].update(this.f)};g.destroy=function(){this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null};Object.defineProperty(ka.prototype,"time",{get:function(){return this.f}});
function X(a,b){this.i=a;this.J="undefined"!==typeof b?b:!0;this.C=0;this.j=!1;this.I=this.L=0;this.m=!1;this.f=0;this.F=!1;this.u=this.H=this.B=this.A=this.G=this.c=null;l.call(this,"Timer");this.c=[];this.f=Date.now()}X.prototype=Object.create(l.prototype);g=X.prototype;g.constructor=X;function cf(a,b){for(var d=0;d<a.c.length;d++){var e=a.c[d];if(!1===e.f){var h=e.c-b;0>h&&(h=0);e.c=a.f+h}}b=a.o-b;a.o=0>b?a.f:a.f+b}function df(a){0<a.c.length&&(a.c.sort(a.jn),a.o=a.c[0].c)}
g.jn=function(a,b){return a.c<b.c?-1:a.c>b.c?1:0};g.create=function(a,b,d,e,h,k){var n=a=Math.round(a);this.f?n+=this.f:n+=this.i.clock.time;a=new ef(0,a,n,d,b,e,h,k);this.c.push(a);df(this);this.F=!1;return a};g.add=function(a,b,d,e){return this.create(a,!1,0,b,d,Array.prototype.splice.call(arguments,3))};g.vl=function(a,b,d,e){return this.create(a,!1,b,d,e,Array.prototype.splice.call(arguments,4))};g.af=function(a,b,d){return this.create(a,!0,0,b,d,Array.prototype.splice.call(arguments,3))};
g.remove=function(a){for(var b=0;b<this.c.length;b++)if(this.c[b]===a)return this.c[b].f=!0;return!1};g.start=function(){if(!0!==this.j){this.C=this.i.clock.time;this.j=!0;for(var a,b=0;b<this.c.length;b++)a=this.c[b],a.c=a.delay+this.C;null!==this.G&&this.G.D()}};g.stop=function(a){this.j=!1;!1!==a&&(this.c.length=0);null!==this.H&&this.H.D()};g.pause=function(){!1!==this.j&&!0!==this.m&&(this.L=this.i.clock.time,this.m=!0,null!==this.A&&this.A.D())};
g.resume=function(){if(!1!==this.m){var a=this.i.clock.time;this.I+=a-this.f;this.f=a;cf(this,this.L);this.m=!1;null!==this.B&&this.B.D()}};
g.update=function(a){if(!0!==this.m){var b=a-this.f;this.f=a;1E3<b&&cf(this,a-b);for(a=this.c.length;a--;)!0===this.c[a].f&&this.c.splice(a,1);a=this.c.length;var d=b=0;if(!0===this.j&&this.f>=this.o&&0<a){for(var e;b<a&&!0===this.j;)if(e=this.c[b],this.f>=e.c&&!1===e.f){var h=this.f+e.delay-(this.f-e.c);0>h&&(h=this.f+e.delay);!0===e.loop?e.c=h:0<e.N?(e.N--,e.c=h):(d++,e.f=!0);e.yb();b++}else break;this.c.length>d?df(this):(this.F=!0,this.j=!1,null!==this.u&&this.u.D())}this.F&&this.J&&this.destroy()}};
g.destroy=function(){this.j=!1;this.c=[];l.prototype.destroy.call(this)};Object.defineProperty(X.prototype,"autoDestroy",{get:function(){return this.J}});Object.defineProperty(X.prototype,"running",{get:function(){return this.j}});Object.defineProperty(X.prototype,"paused",{get:function(){return this.m}});Object.defineProperty(X.prototype,"next",{get:function(){return this.o}});Object.defineProperty(X.prototype,"duration",{get:function(){return this.j&&this.o>this.f?this.o-this.f:0}});
Object.defineProperty(X.prototype,"length",{get:function(){return this.c.length}});Object.defineProperty(X.prototype,"ms",{get:function(){return this.j?this.f-this.C-this.I:0}});Object.defineProperty(X.prototype,"seconds",{get:function(){return this.j?.001*this.ms:0}});Object.defineProperty(X.prototype,"onStart",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(X.prototype,"onPause",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
Object.defineProperty(X.prototype,"onResume",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(X.prototype,"onStop",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(X.prototype,"onComplete",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});function ef(a,b,d,e,h,k,n,v){this.delay=b;this.c=d;this.N=e-1;this.loop=h;this.m=k;this.o=n;this.j=v;this.f=!1}ef.prototype.constructor=ef;
ef.prototype.yb=function(){this.m.apply(this.o,this.j)};function xa(a){this.i=a;this.c=[];l.call(this,"TweenManager")}xa.prototype=Object.create(l.prototype);g=xa.prototype;g.constructor=xa;g.mn=function(a){this.remove(a.emitter)};g.add=function(a){this.c.push(a);a.onDestroy.fa(this.mn,this)};g.remove=function(a){a:{for(var b=0,d=this.c.length;b<d;b++)if(a===this.c[b]){a=b;break a}a=-1}-1!==a&&this.c.splice(a,1)};g.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};
g.destroy=function(){for(var a=this.c.length;a--;)this.c[a].destroy();this.i=this.c=null;l.prototype.destroy.call(this)};function Fb(a,b){this.i=a;this.B=b;this.f=null;this.c=Kd.LINEAR;this.H=null;this.A=this.G=this.C=!1;this.u=this.j=this.m=this.o=null;l.call(this,"Tween")}Fb.prototype=Object.create(l.prototype);g=Fb.prototype;g.constructor=Fb;
g.bf=function(a,b,d){null===this.f&&(this.f={});for(var e in a)this.f[e]={name:e,min:null,max:a[e],duration:"number"===typeof b?b:0,easing:"function"===typeof d?d:null,started:!1,complete:!1,startTime:null};return this};g.start=function(){this.H=Date.now();this.C=!0;this.A=this.G=!1;var a,b;for(b in this.f)a=this.f[b],a.min=this.B[b],a.max="string"===typeof this.f[b].max?a.min+parseInt(this.f[b].max,10):a.max,a.started=!0,a.startTime=this.H;null!==this.o&&this.o.D();return this};
g.stop=function(){this.G=!0;null!==this.u&&this.u.D();return this};g.update=function(){if(!1!==this.C&&!0!==this.A&&!0!==this.G){var a,b=0,d;for(d in this.f){a=this.f[d];if(!1===a.complete){var e=a,h=Date.now()-e.startTime;e.complete=h>=e.duration;!1===e.complete?(h=(null!==e.easing?e.easing:this.c)(h/e.duration),this.B[e.name]=h*(e.max-e.min)+e.min):this.B[e.name]=e.max}!1===a.complete&&b++}null!==this.m&&this.m.D();b||(this.A=!0,null!==this.j&&this.j.D())}};
g.destroy=function(){this.stop();this.c=this.f=this.B=this.i=null;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.u&&(this.u.destroy(),this.u=null);l.prototype.destroy.call(this)};
Object.defineProperty(Fb.prototype,"easing",{get:function(){return this.c},set:function(a){if("string"===typeof a)switch(a){case Y.LINEAR:this.c=Kd.LINEAR;break;case Y.Ld:this.c=Kd.Ld;break;case Y.Md:this.c=Kd.Md;break;case Y.Nd:this.c=Kd.Nd;break;case Y.Hd:this.c=Kd.Hd;break;case Y.Id:this.c=Kd.Id;break;case Y.Jd:this.c=Kd.Jd;break;case Y.Bd:this.c=Kd.Bd;break;case Y.Cd:this.c=Kd.Cd;break;case Y.Dd:this.c=Kd.Dd;break;case Y.Tc:this.c=Kd.Tc;break;case Y.yd:this.c=Kd.yd;break;default:this.c=Kd.LINEAR}else"function"===
typeof a&&(this.c=a)}});Object.defineProperty(Fb.prototype,"complete",{get:function(){return this.A}});Object.defineProperty(Fb.prototype,"onStart",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(Fb.prototype,"onProgress",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});Object.defineProperty(Fb.prototype,"onComplete",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});
Object.defineProperty(Fb.prototype,"onStop",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});
var Kd={LINEAR:function(a){return G.X(a,0,1)},Ld:function(a){return G.X(1+Math.sin(Math.PI/2*(a-1)),0,1)},Md:function(a){return G.X(.5*(1+Math.sin(Math.PI/2*(2*a-1))),0,1)},Nd:function(a){return G.X(Math.sin(Math.PI/2*a),0,1)},Hd:function(a){return G.X(a*a,0,1)},Id:function(a){return G.X(.5>a?2*a*a:1-2*(a-1)*(a-1),0,1)},Jd:function(a){a=1-a;return G.X(1-a*a,0,1)},Bd:function(a){return G.X(a*a*a,0,1)},Cd:function(a){return G.X(.5>a?4*a*a*a:1+4*(a-1)*(a-1)*(a-1),0,1)},Dd:function(a){a=1-a;return G.X(1-
a*a*a,0,1)},Tc:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+.9375):(a-=2.625/2.75,a=7.5625*a*a+.984375);return G.X(a,0,1)},yd:function(a){return 1-Kd.Tc(1-a)}},Y={LINEAR:"linear",Ld:"easeInSine",Md:"easeInOutSine",Nd:"easeOutSine",Hd:"easeInQuad",Id:"easeInOutQuad",Jd:"easeOutQuad",Bd:"easeInCubic",Cd:"easeInOutCubic",Dd:"easeOutCubic",Tc:"easeOutBounce",yd:"easeInBounce"},B={Bg:function(a){var b={value:null,Mc:null};if("string"===
typeof a){var d=parseInt(a,10);!1===isNaN(d)&&(b.value=d);-1<a.indexOf("%")?b.Mc="%":-1<a.indexOf("px")&&(b.Mc="px")}return b},mb:function(a,b,d){var e={};a="undefined"!==typeof a?a:{};b="undefined"!==typeof b?b:{};for(var h in a)a.hasOwnProperty(h)&&(e[h]=a[h]);for(var k in b)b.hasOwnProperty(k)&&(e[k]=!1!==d&&null!==a&&null!==b[k]&&"undefined"!==typeof b[k]&&b[k].constructor===Object?B.mb(a[k],b[k],!0):b[k]);return e},Za:function(a){for(var b=arguments,d={},e=0,h=b.length;e<h;e++)d=B.mb(d,b[e],
!0);return d},clone:function(a){if(!(a instanceof Object))return a;var b=new a.constructor,d;for(d in a)b[d]=B.clone(a[d]);return b},Rn:function(a){return null!==a&&"object"===typeof a&&"string"===typeof a.className&&-1!==Qd.indexOf(a.className)?!0:!1},T:function(a,b){if("string"===typeof b&&(null!==a&&"object"===typeof a&&"string"===typeof a.className&&a.className.toLowerCase()===b.toLowerCase()||typeof a===b.toLowerCase()))return!0;if(!0===Array.isArray(b)&&!0===B.Fa(b,"string"))for(var d=0,e=b.length;d<
e;d++)if(!0===B.T(a,b[d]))return!0;return!1},Un:function(a,b,d){b=b.split(".");for(var e=0,h=b.length;e<h;e++){a=a[b[e]];if(e===h-1)return B.T(a,d);if("undefined"===typeof a)break}return!1},Fa:function(a,b){if("object"===typeof a&&!0===Array.isArray(a)){for(var d=0,e=a.length;d<e;d++)if(!1===B.T(a[d],b))return!1;return!0}return!1},le:function(a,b,d){b=b.split(".");for(var e=0,h=b.length;e<h;e++){a=a[b[e]];if("undefined"===typeof a)break;if(e===h-1)return a}return d},ud:function(a,b){var d=b.split("."),
e=d.length;a.sort(function(a,b){for(var h=0;h<e;)a=a[d[h]],b=b[d[h]],h++;return a<b?-1:a>b?1:0});return a},rd:function(a){a=a.slice();for(var b,d,e=a.length-1;0<e;e--)d=~~(Math.random()*(e+1)),b=a[e],a[e]=a[d],a[d]=b;return a},se:function(a,b,d){for(a=String(a);a.length<d;)a=b+a;return a},pk:function(a){a={input:a,hours:0,minutes:0,seconds:0};if("number"!==typeof a.input||isNaN(a.input))return a;a.On=parseInt(a.input/3600,10)%24;a.Wn=parseInt(a.input/60,10)%60;a.seconds=parseInt(a.input%60,10);return a},
An:function(a,b){a=B.pk(a);var d="string"===typeof b?b:"H:M:S";b=0;-1!==d.indexOf("H")?b=2:-1!==d.indexOf("h")&&(b=1);var e=0;-1!==d.indexOf("M")?e=2:-1!==d.indexOf("m")&&(e=1);var h=0;-1!==d.indexOf("S")?h=2:-1!==d.indexOf("s")&&(h=1);d=d.toLowerCase();0<b&&(d=d.replace("h",B.se(a.On,0,b)));0<e&&(d=d.replace("m",B.se(a.Wn,0,e)));0<h&&(d=d.replace("s",B.se(a.seconds,0,h)));return d},Fe:function(a,b,d){return new THREE.Spherical(a,Math.PI/2-d,b)},Dn:function(a){return{radius:a.radius,theta:a.theta,
phi:Math.PI/2-a.phi}},mj:function(a,b){return a.filter(function(a){return 0>b.indexOf(a)})},Zn:function(a,b){return b>=a.length?null:a.splice(b,1)},endsWith:function(a,b){return"function"!==typeof String.prototype.endsWith?-1!==a.indexOf(b,a.length-b.length):a.endsWith(b)},Tf:function(a){if(!Array.prototype.keys){var b,d={},e=0;b=a.length;d.array=[];for(d.length=a.length;0<b;)d.array[--b]=b;d.next=function(){return e<a.length?{value:e++,done:!1}:{done:!0}};return d}return a.keys()}},ha={md:function(a,
b){var d=window.getComputedStyle(a,null).getPropertyValue("display");a.style.display="none";b=window.getComputedStyle(a,null).getPropertyValue(b);a.style.display=d;return b},Rj:function(a){a=ha.md(a,"width");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b},Tj:function(a){a=parseInt(ha.md(a,"width"),10);return isNaN(a)?0:a},Qj:function(a){a=ha.md(a,"height");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b},Sj:function(a){a=parseInt(ha.md(a,"height"),
10);return isNaN(a)?0:a},has:function(a){return document.body.contains(a)},ng:function(a){return a instanceof HTMLElement},Gn:function(a){var b,d;d=["MouseEvent","PointerEvent","TouchEvent"];"object"===typeof a.srcEvent&&d.indexOf(a.srcEvent.constructor.toString())?(b=a.target.getBoundingClientRect(),d=a.srcEvent.clientX-b.left,a=a.srcEvent.clientY-b.top):(b=(a.currentTarget||a.target||a.srcElement).getBoundingClientRect(),d=a.clientX-b.left,a=a.clientY-b.top);return{x:d,y:a}}};
function Ve(){this.f=0;this.c={}}g=Ve.prototype;g.constructor=Ve;g.set=function(a,b){if("undefined"!==typeof a)return void 0===this.c[a]&&this.f++,this.c[a]=b,this.f};g.Ue=function(a){if("undefined"!==typeof a&&void 0!==this.c[a])return delete this.c[a],--this.f};g.get=function(a){return this.c[a]};g.Yk=function(){var a=new td,b;for(b in this.c)a.add(b);return a.De()};g.Zk=function(){var a=new td,b;for(b in this.c)a.add(this.c[b]);return a.De()};
g.Xk=function(){var a=new td,b;for(b in this.c){var d=[];d.push(b);d.push(this.c[b]);a.add(d)}return a.De()};g.Wk=function(){for(var a in this.c)this.Ue(a)};g.has=function(a){return 0<this.f&&void 0!==this.c[a]};Object.defineProperty(Ve.prototype,"size",{get:function(){return this.f}});function td(){this.c=[]}g=td.prototype;g.constructor=td;g.add=function(a){this.c.push(a);return this.c.length};g.remove=function(a){for(var b=0,d=this.c.length;b<d;b++)this.c[b]===a&&this.c.splice(b,1)};g.get=function(a){return this.c[a]};
g.De=function(){return this.c};Object.defineProperty(td.prototype,"size",{get:function(){return this.c.length}});function ff(a){this.j=a;this.c=this.G=this.f=this.A=this.u=this.B="";this.o=null;this.m="";l.call(this,"URL")}ff.prototype=Object.create(l.prototype);ff.prototype.constructor=ff;
function Da(a){var b=new ff;"string"!==typeof a&&(a=window.location.toString());b.j=a;a=document.createElement("a");a.href=b.j;b.B=a.protocol;b.u=a.hostname;b.A=a.port;b.f=a.pathname;b.G=a.search;b.c=a.hash;b.m=b.f.substr(b.f.lastIndexOf(".")+1);if(""!==b.c){a=b.c.replace("#","").split("&");var d={};d.slug=a[0];for(var e=1,h=a.length;e<h;e++){var k=a[e].split("=");d[k[0]]=decodeURIComponent(k[1])}b.o=d}return b}Object.defineProperty(ff.prototype,"url",{get:function(){return this.j}});
Object.defineProperty(ff.prototype,"protocol",{get:function(){return this.B}});Object.defineProperty(ff.prototype,"host",{get:function(){return this.u}});Object.defineProperty(ff.prototype,"port",{get:function(){return this.A}});Object.defineProperty(ff.prototype,"path",{get:function(){return this.f}});Object.defineProperty(ff.prototype,"query",{get:function(){return this.G}});Object.defineProperty(ff.prototype,"hash",{get:function(){return this.c}});
Object.defineProperty(ff.prototype,"hashParameters",{get:function(){return this.o}});Object.defineProperty(ff.prototype,"extension",{get:function(){return this.m}});
var Z={ao:function(a,b,d){a/=255;b/=255;d/=255;var e=Math.max(a,b,d),h=Math.min(a,b,d),k,n=(e+h)/2;if(e===h)k=h=0;else{var v=e-h,h=.5<n?v/(2-e-h):v/(e+h);switch(e){case a:k=(b-d)/v+(b<d?6:0);break;case b:k=(d-a)/v+2;break;case d:k=(a-b)/v+4}k/=6}return{h:k,s:h,l:n}},Pn:function(a,b,d){if(b){var e=.5>d?d*(1+b):d+b-d*b,h=2*d-e;d=Z.pe(h,e,a+1/3);b=Z.pe(h,e,a);a=Z.pe(h,e,a-1/3)}else d=b=a=d;return{r:255*d,g:255*b,b:255*a}},pe:function(a,b,d){if(!(0>d||1<d)){if(d<1/6)return a+6*(b-a)*d;if(.5>d)return b;
if(d<2/3)return a+(b-a)*(2/3-d)*6}return a},bo:function(a,b,d){a/=255;b/=255;d/=255;var e=Math.max(a,b,d),h=Math.min(a,b,d),k,n=e-h;if(e===h)k=0;else{switch(e){case a:k=(b-d)/n+(b<d?6:0);break;case b:k=(d-a)/n+2;break;case d:k=(a-b)/n+4}k/=6}return{h:k,s:e?n/e:0,v:e}},Qn:function(a,b,d){var e,h,k,n=Math.floor(6*a),v=6*a-n;a=d*(1-b);var y=d*(1-v*b);b=d*(1-(1-v)*b);switch(n%6){case 0:e=d;h=b;k=a;break;case 1:e=y;h=d;k=a;break;case 2:e=a;h=d;k=b;break;case 3:e=a;h=y;k=d;break;case 4:e=b;h=a;k=d;break;
case 5:e=d,h=a,k=y}return{r:255*e,g:255*h,b:255*k}},ce:function(a){a=a.toString(16);return 1===a.length?"0"+a:a},$n:function(a,b,d){return"#"+Z.ce(a)+Z.ce(b)+Z.ce(d)},Bn:function(a){a=a.split("(")[1].split(")")[0].split(",");var b={r:parseInt(a[0],10),g:parseInt(a[1],10),b:parseInt(a[2],10)};3<a.length&&(b.a=parseInt(a[3],10));return b},Nn:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,d,e,h){return d+d+e+e+h+h});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},co:function(a){a=new THREE.Vector3(a.r,a.g,a.b);var b=(new THREE.Matrix3).set(.299,.587,.114,-.169,-.331,.5,.5,-.419,-.081),d=new THREE.Vector3(0,128,128);a.applyMatrix3(b).add(d);return{Y:a.x,Cr:a.y,Cb:a.z}},ro:function(a){a=new THREE.Vector3(a.Y,a.Cr,a.Cb);var b=new THREE.Vector3(0,-128,-128),d=(new THREE.Matrix3).set(1,0,1.4,1,-.343,-.711,1,1.765,0);a.add(b).applyMatrix3(d);return{r:a.x,g:a.y,b:a.z}},qo:function(a,b){var d=G.da(b);
b=Math.cos(d);d=Math.sin(d);return{Y:a.Y,Cb:a.Cb*b-a.Cr*d,Cr:a.Cb*d+a.Cr*b}},distance:function(a,b){return Math.sqrt((a.Cb-b.Cb)*(a.Cb-b.Cb)+(a.Cr-b.Cr)*(a.Cr-b.Cr))}};function Ub(a,b,d,e){this.alpha=e}window.FORGE=window.FORGE||{};window.FORGE.BaseObject=l;window.FORGE.Viewer=r;window.FORGE.Tags=ca;window.FORGE.UID=p;window.FORGE.Story=w;window.FORGE.Group=E;window.FORGE.Scene=C;window.FORGE.SceneParser=F;window.FORGE.Rectangle=Ha;window.FORGE.Size=Ia;window.FORGE.Media=La;
window.FORGE.RenderManager=x;window.FORGE.RenderScene=bb;window.FORGE.RenderPipeline=Ta;window.FORGE.RenderDisplay=Ra;window.FORGE.RenderParams=sb;window.FORGE.BackgroundRenderer=tb;window.FORGE.BackgroundMeshRenderer=Za;window.FORGE.BackgroundShaderRenderer=Ya;window.FORGE.PostProcessing=ta;window.FORGE.EffectComposer=cb;window.FORGE.TexturePass=hb;window.FORGE.ShaderPass=jb;window.FORGE.AdditionPass=mb;window.FORGE.RenderPass=fb;window.FORGE.ViewBase=Ab;window.FORGE.ViewGoPro=ab;
window.FORGE.ViewRectilinear=$a;window.FORGE.Timeline=Cb;window.FORGE.Keyframe=Db;window.FORGE.Animation=Eb;window.FORGE.MetaAnimation=Ib;window.FORGE.Track=Lb;window.FORGE.Object3D=Mb;window.FORGE.ObjectRenderer=Sa;window.FORGE.Raycaster=Qb;window.FORGE.PickingDrawPass=Vb;window.FORGE.PickingManager=Qa;window.FORGE.HotspotManager=qa;window.FORGE.Hotspot3D=Zb;window.FORGE.HotspotSound=gc;window.FORGE.HotspotMaterial=dc;window.FORGE.HotspotTransform=ac;window.FORGE.HotspotAnimation=bc;
window.FORGE.HotspotAnimationTrack=$b;window.FORGE.HotspotStates=ec;window.FORGE.Camera=L;window.FORGE.CameraAnimation=Dc;window.FORGE.CameraGaze=rc;window.FORGE.ControllerManager=oa;window.FORGE.ControllerBase=Oc;window.FORGE.ControllerPointer=Mc;window.FORGE.ControllerKeyboard=Nc;window.FORGE.SoundManager=u;window.FORGE.Sound=M;window.FORGE.Playlist=P;window.FORGE.PlaylistManager=z;window.FORGE.PlaylistTrack=fd;window.FORGE.Director=sa;window.FORGE.DirectorTrack=Cc;
window.FORGE.ActionEventDispatcher=hc;window.FORGE.Action=hd;window.FORGE.ActionManager=ra;window.FORGE.Plugin=Q;window.FORGE.PluginEngine=md;window.FORGE.PluginManager=pa;window.FORGE.PluginObjectFactory=R;window.FORGE.Device=I;window.FORGE.RequestAnimationFrame=la;window.FORGE.History=na;window.FORGE.EventDispatcher=q;window.FORGE.Event=Bd;window.FORGE.Listener=zd;window.FORGE.LocaleManager=ma;window.FORGE.LocaleString=za;window.FORGE.Locale=Dd;window.FORGE.Keyboard=ua;window.FORGE.KeyBinding=O;
window.FORGE.Drag=Jd;window.FORGE.Pointer=U;window.FORGE.DisplayList=ga;window.FORGE.DisplayObject=T;window.FORGE.DisplayObjectContainer=t;window.FORGE.Iframe=Xd;window.FORGE.TextField=S;window.FORGE.Button=vd;window.FORGE.ButtonSkin=he;window.FORGE.Canvas=ia;window.FORGE.Image=Ma;window.FORGE.Sprite=ud;window.FORGE.SpriteAnimationManager=ve;window.FORGE.SpriteAnimation=W;window.FORGE.VideoHTML5=K;window.FORGE.VideoDash=J;window.FORGE.VideoTimeRanges=He;window.FORGE.VideoQuality=Ne;
window.FORGE.Cache=va;window.FORGE.File=$e;window.FORGE.Loader=wa;window.FORGE.DependencyManager=ja;window.FORGE.Clock=ka;window.FORGE.Timer=X;window.FORGE.TimerEvent=ef;window.FORGE.TweenManager=xa;window.FORGE.Tween=Fb;window.FORGE.Map=Ve;window.FORGE.Collection=td;window.FORGE.URL=ff;window.FORGE.ColorRGBA=Ub;l.prototype.log=l.prototype.log;l.prototype.warn=l.prototype.warn;l.prototype.destroy=l.prototype.destroy;r.prototype.update=r.prototype.update;r.prototype.pause=r.prototype.pause;
r.prototype.resume=r.prototype.resume;r.prototype.destroy=r.prototype.destroy;w.prototype.boot=w.prototype.boot;w.prototype.load=w.prototype.load;w.prototype.hasScenes=w.prototype.sl;w.prototype.hasGroups=w.prototype.oc;w.prototype.nextScene=w.prototype.tl;w.prototype.previousScene=w.prototype.ul;w.prototype.notifySceneConfigLoadComplete=w.prototype.mk;w.prototype.loadScene=w.prototype.Kc;w.prototype.loadGroup=w.prototype.tg;w.prototype.destroy=w.prototype.destroy;E.prototype.load=E.prototype.load;
E.prototype.hasChild=E.prototype.Oe;E.prototype.hasScene=E.prototype.Ic;E.prototype.hasGroup=E.prototype.nd;E.prototype.hasChildren=E.prototype.Jn;E.prototype.hasTypeOfChild=E.prototype.jg;E.prototype.hasScenes=E.prototype.Pe;E.prototype.hasGroups=E.prototype.oc;E.prototype.getChildrenUids=E.prototype.ld;E.prototype.getChildren=E.prototype.he;E.prototype.nextScene=E.prototype.Qk;E.prototype.previousScene=E.prototype.Rk;E.prototype.destroy=E.prototype.destroy;C.prototype.addConfig=C.prototype.ja;
C.prototype.load=C.prototype.load;C.prototype.unload=C.prototype.Ge;C.prototype.hasGroup=C.prototype.nd;C.prototype.hasGroups=C.prototype.oc;C.prototype.destroy=C.prototype.destroy;F.prototype.extendConfiguration=F.prototype.zj;F.prototype.hasSoundSource=F.prototype.Xj;F.prototype.hasSoundTarget=F.prototype.Yj;F.prototype.isAmbisonic=F.prototype.dk;F.prototype.destroy=F.prototype.destroy;La.prototype.destroy=La.prototype.destroy;x.prototype.update=x.prototype.update;x.prototype.render=x.prototype.render;
x.prototype.screenToWorld=x.prototype.screenToWorld;x.prototype.worldToScreen=x.prototype.worldToScreen;x.prototype.enableVR=x.prototype.Nh;x.prototype.toggleVR=x.prototype.lo;x.prototype.setView=x.prototype.qc;x.prototype.destroy=x.prototype.destroy;bb.prototype.setSize=bb.prototype.setSize;bb.prototype.destroy=bb.prototype.destroy;Ta.prototype.enablePicking=Ta.prototype.cg;Ta.prototype.addBackground=Ta.prototype.Rf;Ta.prototype.addRenderScenes=Ta.prototype.hj;Ta.prototype.addGlobalFx=Ta.prototype.gj;
Ta.prototype.getShaderPassByUID=Ta.prototype.Hn;Ta.prototype.setSize=Ta.prototype.setSize;Ta.prototype.render=Ta.prototype.render;Ta.prototype.clear=Ta.prototype.Ze;Ta.prototype.destroy=Ta.prototype.destroy;Ra.prototype.enableVR=Ra.prototype.Jh;Ra.prototype.getQuaternionFromPose=Ra.prototype.Lj;Ra.prototype.getRenderParams=Ra.prototype.Nj;Ra.prototype.setSize=Ra.prototype.setSize;Ra.prototype.submitFrame=Ra.prototype.Kh;Ra.prototype.destroy=Ra.prototype.destroy;
tb.prototype.updateAfterViewChange=tb.prototype.Nc;tb.prototype.setSize=tb.prototype.setSize;tb.prototype.render=tb.prototype.render;tb.prototype.update=tb.prototype.update;tb.prototype.destroy=tb.prototype.destroy;Za.prototype.updateAfterViewChange=Za.prototype.Nc;Za.prototype.render=Za.prototype.render;Za.prototype.destroy=Za.prototype.destroy;Ya.prototype.render=Ya.prototype.render;Ya.prototype.updateAfterViewChange=Ya.prototype.Nc;Ya.prototype.destroy=Ya.prototype.destroy;
ta.prototype.parseShaderPasses=ta.prototype.ze;ta.prototype.getFxSetByUID=ta.prototype.je;ta.prototype.addConfig=ta.prototype.ja;ta.prototype.destroy=ta.prototype.destroy;cb.prototype.destroy=cb.prototype.destroy;jb.prototype.render=jb.prototype.render;mb.prototype.destroy=mb.prototype.destroy;Ab.prototype.shaderSTW=Ab.prototype.Lc;Ab.prototype.shaderWTS=Ab.prototype.Gb;Ab.prototype.updateUniforms=Ab.prototype.tc;Ab.prototype.worldToScreen=Ab.prototype.worldToScreen;Ab.prototype.screenToWorld=Ab.prototype.screenToWorld;
Ab.prototype.getProjectionFov=Ab.prototype.me;Ab.prototype.destroy=Ab.prototype.destroy;ab.prototype.shaderSTW=ab.prototype.Lc;ab.prototype.shaderWTS=ab.prototype.Gb;ab.prototype.updateUniforms=ab.prototype.tc;ab.prototype.getProjectionFov=ab.prototype.me;ab.prototype.destroy=ab.prototype.destroy;$a.prototype.shaderSTW=$a.prototype.Lc;$a.prototype.shaderWTS=$a.prototype.Gb;$a.prototype.updateUniforms=$a.prototype.tc;$a.prototype.worldToScreen=$a.prototype.worldToScreen;
$a.prototype.screenToWorld=$a.prototype.screenToWorld;$a.prototype.destroy=$a.prototype.destroy;Cb.prototype.hasKeyframes=Cb.prototype.Kn;Cb.prototype.addKeyframe=Cb.prototype.kb;Cb.prototype.getKeyframes=Cb.prototype.Fn;Cb.prototype.getKeyframesIndexes=Cb.prototype.ke;Cb.prototype.getSideKeyframes=Cb.prototype.Oj;Cb.prototype.getSideKeyframesIndexes=Cb.prototype.Pj;Cb.prototype.emptyKeyframes=Cb.prototype.zn;Cb.prototype.destroy=Cb.prototype.destroy;Eb.prototype.play=Eb.prototype.play;
Eb.prototype.stop=Eb.prototype.stop;Eb.prototype.resume=Eb.prototype.resume;Eb.prototype.destroy=Eb.prototype.destroy;Ib.prototype.stop=Ib.prototype.stop;Ib.prototype.resume=Ib.prototype.resume;Ib.prototype.destroy=Ib.prototype.destroy;Lb.prototype.destroy=Lb.prototype.destroy;Mb.prototype.click=Mb.prototype.click;Mb.prototype.over=Mb.prototype.hc;Mb.prototype.out=Mb.prototype.wc;Mb.prototype.destroy=Mb.prototype.destroy;Sa.prototype.register=Sa.prototype.register;Sa.prototype.unregister=Sa.prototype.unregister;
Sa.prototype.createRenderScenes=Sa.prototype.qj;Sa.prototype.getRaycastable=Sa.prototype.Mj;Sa.prototype.getByMesh=Sa.prototype.Jj;Sa.prototype.clear=Sa.prototype.We;Sa.prototype.destroy=Sa.prototype.destroy;Qb.prototype.start=Qb.prototype.start;Qb.prototype.stop=Qb.prototype.stop;Qb.prototype.click=Qb.prototype.click;Qb.prototype.clear=Qb.prototype.Ih;Vb.prototype.start=Vb.prototype.start;Vb.prototype.stop=Vb.prototype.stop;Vb.prototype.click=Vb.prototype.click;Vb.prototype.setSize=Vb.prototype.setSize;
Vb.prototype.clear=Vb.prototype.sh;Vb.prototype.destroy=Vb.prototype.destroy;Qa.prototype.updateForViewType=Qa.prototype.Gk;Qa.prototype.clear=Qa.prototype.th;Qa.prototype.setSize=Qa.prototype.setSize;Qa.prototype.click=Qa.prototype.click;Qa.prototype.start=Qa.prototype.start;Qa.prototype.stop=Qa.prototype.stop;Qa.prototype.destroy=Qa.prototype.destroy;qa.prototype.boot=qa.prototype.boot;qa.prototype.getByType=qa.prototype.En;qa.prototype.addConfig=qa.prototype.ja;qa.prototype.addTracks=qa.prototype.ij;
qa.prototype.update=qa.prototype.update;qa.prototype.clear=qa.prototype.Re;qa.prototype.destroy=qa.prototype.destroy;Zb.prototype.over=Zb.prototype.hc;Zb.prototype.out=Zb.prototype.wc;Zb.prototype.update=Zb.prototype.update;Zb.prototype.destroy=Zb.prototype.destroy;gc.prototype.load=gc.prototype.load;gc.prototype.update=gc.prototype.update;gc.prototype.destroy=gc.prototype.destroy;dc.prototype.load=dc.prototype.load;dc.prototype.update=dc.prototype.update;dc.prototype.setTextureSource=dc.prototype.eo;
dc.prototype.setTextureFrame=dc.prototype.Ig;dc.prototype.destroy=dc.prototype.destroy;ac.prototype.load=ac.prototype.load;ac.prototype.destroy=ac.prototype.destroy;bc.prototype.load=bc.prototype.load;bc.prototype.play=bc.prototype.play;ec.prototype.addConfig=ec.prototype.ja;ec.prototype.load=ec.prototype.load;ec.prototype.toggle=ec.prototype.A;ec.prototype.destroy=ec.prototype.destroy;L.prototype.load=L.prototype.load;L.prototype.lookAt=L.prototype.ik;L.prototype.update=L.prototype.update;
L.prototype.destroy=L.prototype.destroy;Dc.prototype.play=Dc.prototype.play;Dc.prototype.destroy=Dc.prototype.destroy;rc.prototype.load=rc.prototype.load;rc.prototype.start=rc.prototype.start;rc.prototype.stop=rc.prototype.stop;rc.prototype.update=rc.prototype.update;rc.prototype.destroy=rc.prototype.destroy;oa.prototype.notifyControlStart=oa.prototype.we;oa.prototype.notifyControlEnd=oa.prototype.ve;oa.prototype.update=oa.prototype.update;oa.prototype.addConfig=oa.prototype.ja;
oa.prototype.destroy=oa.prototype.destroy;Oc.prototype.enable=Oc.prototype.enable;Oc.prototype.disable=Oc.prototype.Hb;Oc.prototype.destroy=Oc.prototype.destroy;Mc.prototype.enable=Mc.prototype.enable;Mc.prototype.disable=Mc.prototype.Hb;Mc.prototype.update=Mc.prototype.update;Mc.prototype.destroy=Mc.prototype.destroy;Nc.prototype.enable=Nc.prototype.enable;Nc.prototype.disable=Nc.prototype.Hb;Nc.prototype.update=Nc.prototype.update;Nc.prototype.destroy=Nc.prototype.destroy;u.prototype.boot=u.prototype.boot;
u.prototype.addConfig=u.prototype.ja;u.prototype.update=u.prototype.update;u.prototype.add=u.prototype.add;u.prototype.remove=u.prototype.remove;u.prototype.suspend=u.prototype.suspend;u.prototype.resume=u.prototype.resume;u.prototype.mute=u.prototype.$a;u.prototype.unmute=u.prototype.Ph;u.prototype.destroy=u.prototype.destroy;M.prototype.update=M.prototype.update;M.prototype.play=M.prototype.play;M.prototype.stop=M.prototype.stop;M.prototype.pause=M.prototype.pause;M.prototype.resume=M.prototype.resume;
M.prototype.mute=M.prototype.$a;M.prototype.unmute=M.prototype.Th;M.prototype.destroy=M.prototype.destroy;P.prototype.hasTracks=P.prototype.kl;P.prototype.play=P.prototype.play;P.prototype.stop=P.prototype.stop;P.prototype.pause=P.prototype.pause;P.prototype.resume=P.prototype.resume;P.prototype.nextTrack=P.prototype.qd;P.prototype.previousTrack=P.prototype.Ae;P.prototype.destroy=P.prototype.destroy;z.prototype.boot=z.prototype.boot;z.prototype.addConfig=z.prototype.ja;z.prototype.add=z.prototype.add;
z.prototype.addTrack=z.prototype.vh;z.prototype.hasPlaylists=z.prototype.Ln;z.prototype.hasTracks=z.prototype.el;z.prototype.play=z.prototype.play;z.prototype.stop=z.prototype.stop;z.prototype.pause=z.prototype.pause;z.prototype.resume=z.prototype.resume;z.prototype.nextTrack=z.prototype.qd;z.prototype.previousTrack=z.prototype.Ae;z.prototype.destroy=z.prototype.destroy;fd.prototype.play=fd.prototype.play;fd.prototype.stop=fd.prototype.stop;fd.prototype.pause=fd.prototype.pause;
fd.prototype.resume=fd.prototype.resume;fd.prototype.destroy=fd.prototype.destroy;sa.prototype.load=sa.prototype.load;sa.prototype.play=sa.prototype.play;sa.prototype.stop=sa.prototype.stop;sa.prototype.destroy=sa.prototype.destroy;hc.prototype.addActions=hc.prototype.c;hc.prototype.dispatch=hc.prototype.D;hc.prototype.destroy=hc.prototype.destroy;hd.prototype.execute=hd.prototype.yb;hd.prototype.destroy=hd.prototype.destroy;ra.prototype.get=ra.prototype.get;ra.prototype.addConfig=ra.prototype.ja;
ra.prototype.destroy=ra.prototype.destroy;Q.prototype.instantiate=Q.prototype.ck;Q.prototype.notifyInstanceReady=Q.prototype.Yn;Q.prototype.update=Q.prototype.update;Q.prototype.resetInstance=Q.prototype.uk;Q.prototype.destroy=Q.prototype.destroy;md.prototype.load=md.prototype.load;md.prototype.getNewInstance=md.prototype.Kj;md.prototype.destroy=md.prototype.destroy;pa.prototype.boot=pa.prototype.boot;pa.prototype.addConfig=pa.prototype.ja;pa.prototype.getById=pa.prototype.ge;
pa.prototype.getByIndex=pa.prototype.Ij;pa.prototype.get=pa.prototype.get;pa.prototype.remove=pa.prototype.remove;pa.prototype.update=pa.prototype.update;pa.prototype.render=pa.prototype.render;pa.prototype.destroy=pa.prototype.destroy;R.prototype.string=R.prototype.jo;R.prototype.textField=R.prototype.ko;R.prototype.sound=R.prototype.sound;R.prototype.displayObjectContainer=R.prototype.yn;R.prototype.displayObject=R.prototype.nl;R.prototype.image=R.prototype.image;R.prototype.sprite=R.prototype.ho;
R.prototype.button=R.prototype.ml;R.prototype.video=R.prototype.pl;R.prototype.canvas=R.prototype.canvas;R.prototype.tween=R.prototype.ol;R.prototype.destroyAllObjects=R.prototype.vj;R.prototype.destroy=R.prototype.destroy;la.prototype.boot=la.prototype.boot;la.prototype.start=la.prototype.start;la.prototype.stop=la.prototype.stop;la.prototype.destroy=la.prototype.destroy;na.prototype.addConfig=na.prototype.ja;na.prototype.destroy=na.prototype.destroy;q.prototype.add=q.prototype.add;
q.prototype.addOnce=q.prototype.fa;q.prototype.remove=q.prototype.remove;q.prototype.has=q.prototype.has;q.prototype.dispatch=q.prototype.D;q.prototype.destroy=q.prototype.destroy;zd.prototype.execute=zd.prototype.yb;zd.prototype.detach=zd.prototype.qh;zd.prototype.destroy=zd.prototype.destroy;ma.prototype.addConfig=ma.prototype.ja;ma.prototype.getValue=ma.prototype.Zb;ma.prototype.hasValue=ma.prototype.xb;ma.prototype.destroy=ma.prototype.destroy;za.prototype.destroy=za.prototype.destroy;
Dd.prototype.addConfig=Dd.prototype.ja;Dd.prototype.loadFiles=Dd.prototype.sg;Dd.prototype.getValue=Dd.prototype.Zb;Dd.prototype.hasValue=Dd.prototype.xb;Dd.prototype.getKey=Dd.prototype.rh;Dd.prototype.destroy=Dd.prototype.destroy;ua.prototype.update=ua.prototype.update;ua.prototype.isKeyPressed=ua.prototype.Sn;ua.prototype.isKeyOut=ua.prototype.pg;ua.prototype.addBinding=ua.prototype.Sf;ua.prototype.removeBinding=ua.prototype.Be;ua.prototype.hasBinding=ua.prototype.In;ua.prototype.getBindings=ua.prototype.fg;
ua.prototype.destroy=ua.prototype.destroy;O.prototype.hasKeyIn=O.prototype.ne;O.prototype.hasKeyOut=O.prototype.ig;O.prototype.down=O.prototype.ph;O.prototype.waitToHold=O.prototype.oo;O.prototype.up=O.prototype.Fk;O.prototype.hold=O.prototype.$j;O.prototype.destroy=O.prototype.destroy;Jd.prototype.enable=Jd.prototype.enable;Jd.prototype.disable=Jd.prototype.mh;Jd.prototype.destroy=Jd.prototype.destroy;U.prototype.enable=U.prototype.enable;U.prototype.disable=U.prototype.Xe;U.prototype.destroy=U.prototype.destroy;
ga.prototype.register=ga.prototype.register;ga.prototype.unregister=ga.prototype.unregister;ga.prototype.update=ga.prototype.update;ga.prototype.destroy=ga.prototype.destroy;T.prototype.show=T.prototype.ih;T.prototype.hide=T.prototype.Zj;T.prototype.toggleVisibility=T.prototype.mo;T.prototype.maximize=T.prototype.Db;T.prototype.isInDom=T.prototype.pd;T.prototype.resize=T.prototype.hh;T.prototype.fullscreenEnter=T.prototype.Dj;T.prototype.fullscreenExit=T.prototype.Ej;T.prototype.isFullscreen=T.prototype.od;
T.prototype.destroy=T.prototype.destroy;t.prototype.update=t.prototype.update;t.prototype.addChild=t.prototype.Yb;t.prototype.addChildAt=t.prototype.rn;t.prototype.fitToContent=t.prototype.Cj;t.prototype.removeChild=t.prototype.removeChild;t.prototype.removeChildAt=t.prototype.Cg;t.prototype.empty=t.prototype.gh;t.prototype.hasChild=t.prototype.Nk;t.prototype.destroy=t.prototype.destroy;Xd.prototype.load=Xd.prototype.load;Xd.prototype.destroy=Xd.prototype.destroy;S.prototype.load=S.prototype.load;
S.prototype.destroy=S.prototype.destroy;vd.prototype.load=vd.prototype.load;vd.prototype.addSkin=vd.prototype.mc;vd.prototype.setSkin=vd.prototype.yk;vd.prototype.hasSkin=vd.prototype.Wj;vd.prototype.updateSkin=vd.prototype.no;vd.prototype.destroy=vd.prototype.destroy;he.prototype.setDefaultFromState=he.prototype.Hg;he.prototype.getProperty=he.prototype.Pa;he.prototype.hasImage=he.prototype.Vj;he.prototype.hasLabel=he.prototype.m;Ma.prototype.load=Ma.prototype.load;Ma.prototype.unload=Ma.prototype.Ge;
Ma.prototype.destroy=Ma.prototype.destroy;ud.prototype.play=ud.prototype.play;ud.prototype.pause=ud.prototype.pause;ud.prototype.resume=ud.prototype.resume;ud.prototype.stop=ud.prototype.stop;ud.prototype.update=ud.prototype.update;ud.prototype.destroy=ud.prototype.destroy;ve.prototype.add=ve.prototype.add;ve.prototype.play=ve.prototype.play;ve.prototype.pause=ve.prototype.pause;ve.prototype.resume=ve.prototype.resume;ve.prototype.stop=ve.prototype.stop;ve.prototype.get=ve.prototype.get;
ve.prototype.update=ve.prototype.update;ve.prototype.destroy=ve.prototype.destroy;W.prototype.play=W.prototype.play;W.prototype.pause=W.prototype.pause;W.prototype.resume=W.prototype.resume;W.prototype.stop=W.prototype.stop;W.prototype.update=W.prototype.update;W.prototype.destroy=W.prototype.destroy;K.prototype.update=K.prototype.update;K.prototype.load=K.prototype.load;K.prototype.play=K.prototype.play;K.prototype.pause=K.prototype.pause;K.prototype.stop=K.prototype.stop;
K.prototype.togglePlayback=K.prototype.Dl;K.prototype.mute=K.prototype.$a;K.prototype.unmute=K.prototype.Zh;K.prototype.destroy=K.prototype.destroy;J.prototype.load=J.prototype.load;J.prototype.play=J.prototype.play;J.prototype.pause=J.prototype.pause;J.prototype.stop=J.prototype.stop;J.prototype.togglePlayback=J.prototype.Cl;J.prototype.mute=J.prototype.$a;J.prototype.unmute=J.prototype.Wh;J.prototype.enableBufferOccupancyABR=J.prototype.Bl;J.prototype.destroy=J.prototype.destroy;
He.prototype.getTimeRange=He.prototype.j;He.prototype.isInRanges=He.prototype.fk;va.prototype.has=va.prototype.has;va.prototype.get=va.prototype.get;va.prototype.add=va.prototype.add;va.prototype.remove=va.prototype.remove;va.prototype.destroy=va.prototype.destroy;$e.prototype.key=$e.prototype.key;$e.prototype.url=$e.prototype.url;$e.prototype.type=$e.prototype.type;$e.prototype.data=$e.prototype.data;$e.prototype.xhr=$e.prototype.po;$e.prototype.loading=$e.prototype.Bb;$e.prototype.loaded=$e.prototype.Pk;
$e.prototype.error=$e.prototype.Ok;wa.prototype.json=wa.prototype.json;wa.prototype.xml=wa.prototype.Vk;wa.prototype.sound=wa.prototype.sound;wa.prototype.image=wa.prototype.image;wa.prototype.script=wa.prototype.Gg;wa.prototype.css=wa.prototype.rj;wa.prototype.destroy=wa.prototype.destroy;ja.prototype.add=ja.prototype.add;ja.prototype.destroy=ja.prototype.destroy;ka.prototype.create=ka.prototype.create;ka.prototype.add=ka.prototype.add;ka.prototype.update=ka.prototype.update;
ka.prototype.destroy=ka.prototype.destroy;X.prototype.create=X.prototype.create;X.prototype.add=X.prototype.add;X.prototype.repeat=X.prototype.vl;X.prototype.loop=X.prototype.af;X.prototype.remove=X.prototype.remove;X.prototype.start=X.prototype.start;X.prototype.stop=X.prototype.stop;X.prototype.pause=X.prototype.pause;X.prototype.resume=X.prototype.resume;X.prototype.update=X.prototype.update;X.prototype.destroy=X.prototype.destroy;ef.prototype.execute=ef.prototype.yb;xa.prototype.add=xa.prototype.add;
xa.prototype.remove=xa.prototype.remove;xa.prototype.update=xa.prototype.update;xa.prototype.destroy=xa.prototype.destroy;Fb.prototype.to=Fb.prototype.bf;Fb.prototype.start=Fb.prototype.start;Fb.prototype.stop=Fb.prototype.stop;Fb.prototype.update=Fb.prototype.update;Fb.prototype.destroy=Fb.prototype.destroy;Ve.prototype.set=Ve.prototype.set;Ve.prototype["delete"]=Ve.prototype.Ue;Ve.prototype.get=Ve.prototype.get;Ve.prototype.keys=Ve.prototype.Yk;Ve.prototype.values=Ve.prototype.Zk;
Ve.prototype.entries=Ve.prototype.Xk;Ve.prototype.clear=Ve.prototype.Wk;Ve.prototype.has=Ve.prototype.has;td.prototype.add=td.prototype.add;td.prototype.remove=td.prototype.remove;td.prototype.get=td.prototype.get;td.prototype.toArray=td.prototype.De;window.FORGE.Math=G;G.degToRad=G.da;G.radToDeg=G.dc;G.round10=G.sd;G.clamp=G.X;G.wrap=G.Ta;G.mix=G.Xn;G.smoothStep=G.fo;G.rotationMatrixToEuler=G.Dg;G.eulerToRotationMatrix=G.de;window.FORGE.Quaternion=H;H.toEuler=H.Ee;H.fromEuler=H.nc;
H.toRotationMatrix=H.Bk;H.fromRotationMatrix=H.Cn;H.cancelRoll=H.cancelRoll;H.diffBetweenQuaternions=H.xn;H.angularDistance=H.lj;H.multiplyScalar=H.multiplyScalar;H.add=H.add;H.log=H.log;H.exp=H.exp;H.slerp=H.slerp;H.squad=H.io;H.nlerpNoInvert=H.lk;H.slerpNoInvert=H.Ce;H.squadNoInvert=H.zk;H.spline=H.Kg;cb.getUniqueName=yb;wb.parseIncludes=wb.bb;Vb.colorFrom3DObject=Wb;he.isValid=function(a){return a?!0:!1};Ne.mimeTypeFromURL=Ue;window.FORGE.Utils=B;B.parseSizeString=B.Bg;B.extendSimpleObject=B.mb;
B.extendMultipleObjects=B.Za;B.clone=B.clone;B.isDisplayObject=B.Rn;B.isTypeOf=B.T;B.isTypeOfRecursive=B.Un;B.isArrayOf=B.Fa;B.getObjectProperty=B.le;B.sortArrayByProperty=B.ud;B.randomize=B.rd;B.leftFill=B.se;B.parseTime=B.pk;B.formatTime=B.An;B.toTHREESpherical=B.Fe;B.fromTHREESpherical=B.Dn;B.arrayByDifference=B.mj;B.removeItemFromArrayAtIndex=B.Zn;B.endsWith=B.endsWith;B.arrayKeys=B.Tf;window.FORGE.Dom=ha;ha.getCssProperty=ha.md;ha.getUnitWidth=ha.Rj;ha.getValueWidth=ha.Tj;ha.getUnitHeight=ha.Qj;
ha.getValueHeight=ha.Sj;ha.has=ha.has;ha.isHtmlElement=ha.ng;ha.getMouseEventOffset=ha.Gn;ff.parse=Da;ff.exists=function(a,b,d,e){var h=new XMLHttpRequest,k=null;h.onreadystatechange=function(){this.readyState===XMLHttpRequest.DONE&&200===this.status&&(clearTimeout(k),"function"===typeof b&&b.call(e))};h.onerror=function(a){console.log(a)};h.open("HEAD",a);h.send();k=window.setTimeout(function(){"function"===typeof d&&d.call(e)},500)};
ff.isValid=function(a){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/.test(a)?!0:!1};window.FORGE.Color=Z;Z.rgbToHsl=Z.ao;Z.hslToRgb=Z.Pn;Z.hueToRgb=Z.pe;Z.rgbToHsv=Z.bo;Z.hsvToRgb=Z.Qn;Z.componentToHex=Z.ce;Z.rgbToHex=Z.$n;Z.fromRgbaString=Z.Bn;Z.hexToRgb=Z.Nn;Z.rgbToYcbcr=Z.co;Z.ycbcrToRgb=Z.ro;Z.ycbcrRotate=Z.qo;Z.distance=Z.distance;I.canPlayAudio=I.vn;
I.canPlayVideo=I.wn;I.isLowBattery=I.Tn;I.check=I.check;I.os=I.ab;I.vita=I.Og;I.xbox=I.Yg;I.kindle=I.qg;I.windowsPhone=I.Ie;I.osVersion=I.ac;I.android=I.jj;I.chromeOS=I.Wf;I.iOS=I.Jc;I.linux=I.rg;I.macOS=I.vg;I.windows=I.Wg;I.ie=I.$b;I.edge=I.wb;I.firefox=I.dg;I.opera=I.opera;I.safari=I.td;I.chrome=I.chrome;I.browser=I.lb;I.browserVersion=I.Ya;I.edgeVersion=I.xj;I.chromeVersion=I.Xf;I.firefoxVersion=I.Bj;I.silk=I.Jg;I.ieVersion=I.mg;I.operaVersion=I.xe;I.safariVersion=I.wk;
I.isAndroidStockBrowser=I.ek;I.androidStockBrowserVersion=I.kj;I.webApp=I.Ik;I.quirksMode=I.sk;I.pixelRatio=I.pc;I.iPhone=I.ak;I.iPod=I.bk;I.iPad=I.lg;I.retina=I.vk;I.desktop=I.Hc;I.mobile=I.te;I.tablet=I.Lg;I.other=I.nk;I.oggVideo=I.Ag;I.h264Video=I.hg;I.mp4Video=I.yg;I.webmVideo=I.Vg;I.vp9Video=I.Pg;I.hlsVideo=I.kg;I.audioTag=I.Uf;I.webAudio=I.Rg;I.ogg=I.zg;I.mp3=I.wg;I.opus=I.ye;I.wav=I.Qg;I.aac=I.Qf;I.m4a=I.ug;I.mp4=I.xg;I.webm=I.Ug;I.weba=I.Tg;I.vibrate=I.Mg;I.battery=I.Vf;I.canvas=I.canvas;
I.canvasText=I.oj;I.canvasWinding=I.pj;I.localStorage=I.localStorage;I.mediaSource=I.kk;I.encryptedMedia=I.yj;I.applicationCache=I.applicationCache;I.addEventListener=I.addEventListener;I.raf=I.wo;I.webGL=I.Sg;I.webVR=I.He;I.geolocation=I.geolocation;I.history=I.history;I.svg=I.Ak;I.contextMenu=I.contextMenu;I.isSecure=I.gk;I.isIframe=I.og;I.touch=I.Ck;I.touchForce=I.Dk;I.gamepad=I.Hj;I.requestFullscreen=I.requestFullscreen;I.exitFullscreen=I.exitFullscreen;I.fullscreenKeyboard=I.Fj;
I.fullscreenElement=I.fullscreenElement;I.fullscreenEnabled=I.fullscreenEnabled;I.visibilityState=I.visibilityState;I.visibilityChange=I.Ng;I.orientation=I.orientation;I.screenOrientation=I.xk;I.lockOrientation=I.hk;I.unlockOrientation=I.Ek;I.file=I.file;I.fileSystem=I.Aj;I.pointerLock=I.rk;I.cssPointerEvents=I.jd;I.cssRgba=I.uj;I.cssAnimation=I.tj;I.css3D=I.sj;I.deviceMotionRotationRate=I.$f;I.deviceMotionAcceleration=I.Zf;I.deviceOrientationMagnetometer=I.bg;I.deviceMotion=I.Yf;
I.deviceOrientation=I.ag;I.dpi=I.wj;I.screenWidth=I.Fg;I.screenHeight=I.Eg;I.ua=I.ca;I.language=I.language;I.gyroscope=I.Uj;I.ready=I.ready;p.generate=p.eg;p.validate=p.Hk;p.register=p.register;p.unregister=p.unregister;p.getUids=p.gg;p.filterType=p.ee;p.get=p.get;p.isTypeOf=p.T;p.exists=p.Sa;ca.register=ca.register;ca.getUids=ca.gg;ca.get=ca.get;ca.hasTypeOf=ca.Mn;ca.exists=ca.Sa;window.FORGE.VIEWERS=aa;window.FORGE.VERSION="0.9.1";window.FORGE.DEBUG=!1;window.FORGE.WARNING=!1;r.DEFAULT_CONFIG=fa;
window.FORGE.Math=G;G.DEGREES=G.La;G.RADIANS=G.ob;G.DEG2RAD=G.di;G.RAD2DEG=G.oi;G.TWOPI=G.ui;window.FORGE.MediaType=Ja;Ja.IMAGE=Ja.IMAGE;Ja.VIDEO=Ja.VIDEO;Ja.GRID=Ja.jc;window.FORGE.MediaFormat=Ka;Ka.EQUIRECTANGULAR=Ka.Vc;Ka.CUBE=Ka.Ad;Ka.FLAT=Ka.fi;Ka.HOTSPOT=Ka.Jl;window.FORGE.BackgroundType=Pa;Pa.UNDEFINED=Pa.Yc;Pa.SHADER=Pa.Kd;Pa.MESH=Pa.Gd;window.FORGE.EffectComposerType=eb;eb.MAIN=eb.ii;eb.RENDER=eb.Tb;eb.PICKING=eb.tf;window.FORGE.PassPosition=gb;gb.UNKNOWN=gb.Od;gb.BACKGROUND=gb.xd;
gb.RENDER=gb.Tb;gb.GLOBAL=gb.gf;window.FORGE.ViewType=Oa;Oa.UNDEFINED=Oa.Yc;Oa.RECTILINEAR=Oa.pb;Oa.GOPRO=Oa.ic;window.FORGE.PickingManager.modes=Xa;Xa.POINTER=Xa.Xa;Xa.GAZE=Xa.yc;window.FORGE.HotspotMaterial.types=ic;ic.IMAGE=ic.IMAGE;ic.PLUGIN=ic.ni;ic.GRAPHICS=ic.Fd;window.FORGE.HotspotMaterial.presets=fc;fc.TRANSPARENT=fc.ti;fc.DEBUG=fc.ci;window.FORGE.HotspotGeometryType=jc;jc.PLANE=jc.mi;jc.BOX=jc.ai;jc.SPHERE=jc.pi;jc.CYLINDER=jc.bi;window.FORGE.HotspotType=Yb;Yb.THREE_DIMENSIONAL=Yb.Ff;
L.RADIUS=50;L.DEFAULT_CONFIG=sc;window.FORGE.ControllerType=Kc;Kc.POINTER=Kc.Xa;Kc.KEYBOARD=Kc.mf;oa.DEFAULT_CONFIG=Lc;window.FORGE.SoundType=Ga;Ga.STEREO=Ga.Ol;Ga.SPATIAL=Ga.Nl;Ga.AMBISONIC=Ga.cf;window.FORGE.Action.operation=id;id.SET=id.Cf;id.ADD=id.$h;id.SUBSTRACT=id.ri;id.MULTIPLY=id.ji;id.DIVIDE=id.ei;id.TOGGLE=id.si;na.DEFAULT_CONFIG=wd;window.FORGE.Pointer.listenerTypes=V;V.NATIVE=V.Qa;V.HAMMER=V.oa;window.FORGE.Pointer.events=U.events;U.events.TAP=U.events.Ef;U.events.DOUBLE_TAP=U.events.Ed;
U.events.PRESS_START=U.events.yf;U.events.PRESS_END=U.events.xf;U.events.PAN_START=U.events.sf;U.events.PAN_MOVE=U.events.rf;U.events.PAN_END=U.events.qf;U.events.PINCH_START=U.events.wf;U.events.PINCH_MOVE=U.events.vf;U.events.PINCH_END=U.events.uf;U.events.ROTATE_START=U.events.Bf;U.events.ROTATE_MOVE=U.events.Af;U.events.ROTATE_END=U.events.zf;U.events.SWIPE=U.events.Df;U.events.ENTER=U.events.ff;U.events.LEAVE=U.events.nf;U.events.OVER=U.events.zc;U.events.OUT=U.events.Sb;U.events.MOVE=U.events.pf;
U.events.WHEEL=U.events.Gf;window.FORGE.Pointer.cursors=Md;Md.DEFAULT=Md.DEFAULT;Md.POINTER=Md.Xa;Md.GRAB=Md.Hl;Md.GRABBING=Md.Il;he.EMPTY_STATE_IMAGE=je;he.EMPTY_STATE_LABEL=ke;he.EMPTY_STATE=le;he.DEFAULT_STATE_IMAGE=me;he.DEFAULT_STATE_LABEL=ne;he.DEFAULT_STATE=ie;window.FORGE.Image.renderModes=oc;oc.CSS=oc.CSS;oc.CANVAS=oc.Lb;window.FORGE.VideoDash.mediaType=Oe;Oe.VIDEO=Oe.VIDEO;Oe.AUDIO=Oe.AUDIO;window.FORGE.VideoQualityMode=xe;xe.AUTO=xe.Ib;xe.MANUAL=xe.MANUAL;window.FORGE.VideoFormat=Na;
Na.DASH=Na.df;Na.HTML5=Na.Kl;Na.UNKNOWN=Na.Od;A.JSON=A.JSON;A.XML=A.Ub;A.IMAGE=A.IMAGE;A.SOUND=A.qb;window.FORGE.Cache.reserved=We;We.COMMON=We.Uc;We.JSON=We.JSON;We.XML=We.Ub;We.IMAGE=We.IMAGE;We.SOUND=We.qb;window.FORGE.EasingType=Y;Y.LINEAR=Y.LINEAR;Y.SINE_IN=Y.Ld;Y.SINE_IN_OUT=Y.Md;Y.SINE_OUT=Y.Nd;Y.QUAD_IN=Y.Hd;Y.QUAD_IN_OUT=Y.Id;Y.QUAD_OUT=Y.Jd;Y.CUBIC_IN=Y.Bd;Y.CUBIC_IN_OUT=Y.Cd;Y.CUBIC_OUT=Y.Dd;Y.BOUNCE_OUT=Y.Tc;Y.BOUNCE_IN=Y.yd;
  root.FORGE = window.FORGE;
}).call(this);

